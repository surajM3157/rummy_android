var __reflect=this&&this.__reflect||function(t,e,i){t.__class__=e,i?i.push(e):i=[e],t.__types__=t.__types__?i.concat(t.__types__):i},__extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype,t.prototype=new i},__awaiter=this&&this.__awaiter||function(t,e,i,n){return new(i||(i=Promise))(function(a,s){function o(t){try{h(n.next(t))}catch(e){s(e)}}function r(t){try{h(n["throw"](t))}catch(e){s(e)}}function h(t){t.done?a(t.value):new i(function(e){e(t.value)}).then(o,r)}h((n=n.apply(t,e||[])).next())})},__generator=this&&this.__generator||function(t,e){function i(t){return function(e){return n([t,e])}}function n(i){if(a)throw new TypeError("Generator is already executing.");for(;h;)try{if(a=1,s&&(o=s[2&i[0]?"return":i[0]?"throw":"next"])&&!(o=o.call(s,i[1])).done)return o;switch(s=0,o&&(i=[0,o.value]),i[0]){case 0:case 1:o=i;break;case 4:return h.label++,{value:i[1],done:!1};case 5:h.label++,s=i[1],i=[0];continue;case 7:i=h.ops.pop(),h.trys.pop();continue;default:if(o=h.trys,!(o=o.length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){h=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){h.label=i[1];break}if(6===i[0]&&h.label<o[1]){h.label=o[1],o=i;break}if(o&&h.label<o[2]){h.label=o[2],h.ops.push(i);break}o[2]&&h.ops.pop(),h.trys.pop();continue}i=e.call(t,h)}catch(n){i=[6,n],s=0}finally{a=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}var a,s,o,r,h={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:i(0),"throw":i(1),"return":i(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r},BattleViewCE=function(t){function e(){return t.call(this)||this}return __extends(e,t),Object.defineProperty(e.prototype,"moduleName",{get:function(){return"BattleViewSkin"},enumerable:!0,configurable:!0}),e}(lz.BaseView);__reflect(BattleViewCE.prototype,"BattleViewCE");var BattleGuildView=function(t){function e(){var e=t.call(this)||this;return e._tick=0,e.ptMaskCard=null,e.ptOutCard=null,e.ptFinishCard=null,e._stepIndex=-1,e._text="",e.ptHeadAry=[[578,595],[1118,155],[848,57],[578,57],[308,57],[38,155]],e.jokerData=[123,6,3],e.openCardData1=[153,0,1,0,0,0],e.openCardData2=[121,6,1,0,0,0],e.opponentCardData=[138,10,2,0,0,0],e.cardData1=[[101,1,1,0,0,0],[129,8,1,0,0,0],[149,13,1,0,0,0],[110,3,2,0,0,0],[114,4,2,0,0,0],[118,5,2,0,0,0],[119,5,3,0,0,0],[131,8,3,0,0,0],[147,12,3,0,0,0],[104,1,4,0,0,0],[108,2,4,0,0,0],[116,4,4,0,0,0],[132,8,4,0,0,0]],e.cardData2='{"data":[{"score":28,"state":0,"type":0,"list":[[101,1,1],[129,8,1],[149,13,1]]},{"score":0,"state":1,"type":1,"list":[[110,3,2],[114,4,2],[118,5,2]]},{"score":23,"state":0,"type":0,"list":[[119,5,3],[131,8,3],[147,12,3]]},{"score":24,"state":0,"type":0,"list":[[104,1,4],[108,2,4],[116,4,4],[132,8,4]]}]}',e.cardData3='{"data":[{"score":28,"state":0,"type":0,"list":[[101,1,1],[129,8,1],[149,13,1]]},{"score":0,"state":1,"type":1,"list":[[110,3,2],[114,4,2],[118,5,2]]},{"score":23,"state":0,"type":0,"list":[[119,5,3],[131,8,3],[147,12,3]]},{"score":24,"state":0,"type":0,"list":[[104,1,4],[108,2,4],[116,4,4],[132,8,4]]},{"score":0,"state":1,"type":4,"list":[[153,0,1]]}]}',e.cardData4='{"data":[{"score":28,"state":0,"type":0,"list":[[101,1,1],[129,8,1],[149,13,1]]},{"score":0,"state":1,"type":1,"list":[[110,3,2],[114,4,2],[118,5,2]]},{"score":18,"state":0,"type":0,"list":[[131,8,3],[147,12,3]]},{"score":24,"state":0,"type":0,"list":[[104,1,4],[108,2,4],[116,4,4],[132,8,4]]},{"score":0,"state":1,"type":4,"list":[[153,0,1]]}]}',e.cardData5='{"data":[{"score":28,"state":0,"type":0,"list":[[101,1,1],[129,8,1],[149,13,1]]},{"score":0,"state":1,"type":1,"list":[[110,3,2],[114,4,2],[118,5,2]]},{"score":18,"state":0,"type":0,"list":[[131,8,3],[147,12,3]]},{"score":8,"state":0,"type":0,"list":[[132,8,4]]},{"score":0,"state":1,"type":2,"list":[[104,1,4],[108,2,4],[116,4,4],[153,0,1]]}]}',e.cardData6='{"data":[{"score":20,"state":0,"type":0,"list":[[101,1,1],[149,13,1]]},{"score":0,"state":1,"type":1,"list":[[110,3,2],[114,4,2],[118,5,2]]},{"score":10,"state":0,"type":0,"list":[[147,12,3]]},{"score":0,"state":1,"type":2,"list":[[104,1,4],[108,2,4],[116,4,4],[153,0,1]]},{"score":0,"state":1,"type":3,"list":[[129,8,1],[131,8,3],[132,8,4]]}]}',e.cardData7='{"data":[{"score":20,"state":0,"type":0,"list":[[101,1,1],[149,13,1]]},{"score":0,"state":1,"type":1,"list":[[110,3,2],[114,4,2],[118,5,2]]},{"score":10,"state":0,"type":0,"list":[[147,12,3]]},{"score":0,"state":1,"type":2,"list":[[104,1,4],[108,2,4],[116,4,4],[153,0,1]]},{"score":0,"state":1,"type":3,"list":[[129,8,1],[131,8,3],[132,8,4]]},{"score":0,"state":0,"type":4,"list":[[121,6,1]]}]}',e.cardData8='{"data":[{"score":0,"state":1,"type":1,"list":[[110,3,2],[114,4,2],[118,5,2]]},{"score":10,"state":0,"type":0,"list":[[147,12,3]]},{"score":0,"state":1,"type":2,"list":[[104,1,4],[108,2,4],[116,4,4],[153,0,1]]},{"score":0,"state":1,"type":3,"list":[[129,8,1],[131,8,3],[132,8,4]]},{"score":0,"state":1,"type":2,"list":[[101,1,1],[149,13,1],[121,6,1]]}]}',e.cardData9='{"data":[{"score":0,"state":1,"type":1,"list":[[110,3,2],[114,4,2],[118,5,2]]},{"score":0,"state":1,"type":2,"list":[[104,1,4],[108,2,4],[116,4,4],[153,0,1]]},{"score":0,"state":1,"type":3,"list":[[129,8,1],[131,8,3],[132,8,4]]},{"score":0,"state":1,"type":2,"list":[[101,1,1],[149,13,1],[121,6,1]]}]}',e.cardData10='{"data":[{"score":12,"state":1,"type":1,"list":[[0,2,1],[0,4,1],[0,6,1]]},{"score":21,"state":1,"type":2,"list":[[0,9,2],[0,11,2],[0,13,2]]},{"score":22,"state":1,"type":3,"list":[[0,1,3],[0,4,3],[0,7,3],[0,13,3]]},{"score":29,"state":1,"type":2,"list":[[0,9,4],[0,11,4],[0,12,4]]}]}',e._cardList=[],e._groupList=[],e._cpuGroupList=[],e._cardViewList=[],e.pokerTipAry=[],e.guildEventList=[],e._currentGuildEvent=0,e}return __extends(e,t),e.prototype.loadComplete=function(){t.prototype.loadComplete.call(this),this._player=DataCenter.getInstance().player,this.stage.orientation=egret.OrientationMode.LANDSCAPE,this.stage.setContentSize(1280,720),lz.GameGlobal.screenWidth=this.stage.stageWidth,lz.GameGlobal.screenHeight=this.stage.stageHeight,this._data=LanguageConfig.getLanData("Guild1"),this.guildGroup.visible=!0,this.pMask.visible=!1,this.grpBattleTip.visible=!1,this.btnBack.visible=!1,this.btnBattleTip.visible=!1,this.btnRecord.visible=!1,this.btnSetting.source="game_json.common_close",this.btnSetting.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onCilckClose,this),this.jokerCard.visible=!1,this.maskCard.visible=!1,this.outCard.visible=!1,this.finishCard.visible=!1,this.btnGroup.visible=!1,this.pDropGroup.visible=!1,this.btnFinish.visible=!1,this.btnDisCard.visible=!1,this.battleNoticeGroup.visible=!1,this.ptGroup.visible=!1,this.showCardGroup.visible=!1,this.guildGroup.visible=!1,this.tossCard.visible=!1,this.userHead=new BattleUserHeadView,this.cpuHead=new BattleUserHeadView,this.pMask.visible=!0,this.labWatiTime.text="Game ready to start....",this.btnContinue.visible=!1,this.nextStep()},e.prototype.onRemoved=function(e){t.prototype.onRemoved.call(this,e),this.stage.orientation=egret.OrientationMode.PORTRAIT,this.stage.setContentSize(720,1280),lz.GameGlobal.screenWidth=this.stage.stageWidth,lz.GameGlobal.screenHeight=this.stage.stageHeight,this.btnSetting.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onCilckClose,this)},e.prototype.doNoviceUiEffect=function(){this.noviceEffect||(this.noviceEffect=new lz.UIEffect,this.noviceEffect.includeInLayout=!1,this.noviceEffect.scaleX=this.noviceEffect.scaleY=.5,this.addChild(this.noviceEffect),this.noviceEffect.setEffectInfo("dianJiAnim","dianJiAnim"),this.noviceEffect.x=this.btnContinue.x+this.btnContinue.width/2,this.noviceEffect.y=this.btnContinue.y+this.btnContinue.height/2,this.noviceEffect.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onNextStep,this)),this.btnContinue.visible=!0,this.noviceEffect.visible=!0,this.btnContinue.label="Continue"},e.prototype.onNextStep=function(){this.btnContinue.visible=!1,this.noviceEffect.visible=!1,this.nextStep()},e.prototype.continueGuild=function(){this.doNoviceUiEffect()},e.prototype.initUserHead=function(){var t=new PlayerInfo,e={userid:this._player.info.id,username:"You",roomindex:0,gold:this._player.info.gold,cash:this._player.info.cash,avatar:"1",playerstate:1};t.init(e),this.userHead.setUserInfo(t),this.userHead.showGuildMode(),this.userHead.x=this.ptHeadAry[0][0],this.userHead.y=this.ptHeadAry[0][1],this.addChild(this.userHead);var i=new PlayerInfo,n={userid:this._player.info.id,username:"Player",roomindex:0,gold:this._player.info.gold,cash:this._player.info.cash,avatar:"2",playerstate:1};i.init(n),this.cpuHead.setUserInfo(i),this.cpuHead.showGuildMode(),this.cpuHead.x=this.ptHeadAry[3][0],this.cpuHead.y=this.ptHeadAry[3][1],this.addChild(this.cpuHead)},e.prototype.nextStep=function(){this._stepIndex++,this.showTextBegin=!0,4==this._stepIndex&&(this.showTextBegin=!1),this.showText()},e.prototype.handleStep=function(){if(0==this._stepIndex&&this.doNoviceUiEffect(),1==this._stepIndex&&(this.pMask.visible=!1,this.initUserHead(),this.doNoviceUiEffect()),2==this._stepIndex&&(this.initCardList(this.cardData1),this.playCardTw()),3==this._stepIndex&&this.doNoviceUiEffect(),4==this._stepIndex&&(this.btnDisCard.visible=!1,this.updateCardList(this.cardData2),this.showPureHighlight()),5==this._stepIndex&&(this.hideCardHighLight(),this.doNoviceUiEffect()),6==this._stepIndex){this.guildEventList=[],this.outCard.showTipsHighLight();var t=new GuildEvent(this.playMyDrawTw,this.outCard,this.outCard);this.guildEventList.push(t),this._currentGuildEvent=0,this.startGuildEvent()}if(7==this._stepIndex){this.guildEventList=[];var t=new GuildEvent(this.cardSelect,this._cardViewList[6],this._cardViewList[6]),e=new GuildEvent(this.discardCard,this.btnDisCard,this._cardViewList[6]);this.guildEventList.push(t),this.guildEventList.push(e),this._currentGuildEvent=0,this.startGuildEvent()}if(8==this._stepIndex){this.guildEventList=[];var t=new GuildEvent(this.cardSelect,this._cardViewList[8],this._cardViewList[8]),e=new GuildEvent(this.cardSelect,this._cardViewList[9],this._cardViewList[9]),i=new GuildEvent(this.cardSelect,this._cardViewList[10],this._cardViewList[10]),n=new GuildEvent(this.cardSelect,this._cardViewList[12],this._cardViewList[12]),a=new GuildEvent(this.groupCard,this.btnDisCard,null);this.guildEventList.push(t),this.guildEventList.push(e),this.guildEventList.push(i),this.guildEventList.push(n),this.guildEventList.push(a),this._currentGuildEvent=0,this.startGuildEvent()}if(9==this._stepIndex&&this.doNoviceUiEffect(),10==this._stepIndex&&this.playOtherDrawTw(),11==this._stepIndex){this.guildEventList=[];var t=new GuildEvent(this.cardSelect,this._cardViewList[1],this._cardViewList[1]),e=new GuildEvent(this.cardSelect,this._cardViewList[6],this._cardViewList[6]),i=new GuildEvent(this.cardSelect,this._cardViewList[8],this._cardViewList[8]),n=new GuildEvent(this.groupCard,this.btnDisCard,null);this.guildEventList.push(t),this.guildEventList.push(e),this.guildEventList.push(i),this.guildEventList.push(n),this._currentGuildEvent=0,this.startGuildEvent()}if(12==this._stepIndex&&this.doNoviceUiEffect(),13==this._stepIndex){this.guildEventList=[],this.maskCard.showTipsHighLight();var t=new GuildEvent(this.playMyDrawTw,this.maskCard,this.maskCard);this.guildEventList.push(t),this._currentGuildEvent=0,this.startGuildEvent()}if(14==this._stepIndex&&this.doNoviceUiEffect(),15==this._stepIndex){this.guildEventList=[];var t=new GuildEvent(this.cardSelect,this._cardViewList[0],this._cardViewList[0]),e=new GuildEvent(this.cardSelect,this._cardViewList[1],this._cardViewList[1]),i=new GuildEvent(this.cardSelect,this._cardViewList[13],this._cardViewList[13]),n=new GuildEvent(this.groupCard,this.btnDisCard,null);this.guildEventList.push(t),this.guildEventList.push(e),this.guildEventList.push(i),this.guildEventList.push(n),this._currentGuildEvent=0,this.startGuildEvent()}if(16==this._stepIndex&&this.doNoviceUiEffect(),17==this._stepIndex&&this.doNoviceUiEffect(),18==this._stepIndex){this.guildEventList=[];var t=new GuildEvent(this.cardSelect,this._cardViewList[3],this._cardViewList[3]),e=new GuildEvent(this.finishCardTw,this.btnFinish,this._cardViewList[3]);this.guildEventList.push(t),this.guildEventList.push(e),this._currentGuildEvent=0,this.startGuildEvent()}if(19==this._stepIndex){this.battleNoticeGroup.visible=!0,this.labNoticeTip.text="Please group your cards and Declare",this.guildEventList=[];var t=new GuildEvent(this.showResult,this.btnNotice,null);this.guildEventList.push(t),this._currentGuildEvent=0,this.startGuildEvent()}},e.prototype.startGuildEvent=function(){if(0!=this.guildEventList.length){if(this._currentGuildEvent==this.guildEventList.length)return this.guildEventList=[],void this.nextStep();var t=this.guildEventList[this._currentGuildEvent],e=new lz.UIEffect;e.includeInLayout=!1,e.scaleX=e.scaleY=.5,this.addChild(e),e.setEffectInfo("dianJiAnim","dianJiAnim"),e.x=t.xpos,e.y=t.ypos,e.addEventListener(egret.TouchEvent.TOUCH_TAP,t.func,this)}},e.prototype.cardSelect=function(t){this.removeChild(t.currentTarget);var e=this.guildEventList[this._currentGuildEvent];e.eventObj.y-=30,this._currentGuildEvent==this.guildEventList.length-2&&(7==this._stepIndex?this.btnDisCard.visible=!0:18==this._stepIndex?this.btnFinish.visible=!0:this.btnGroup.visible=!0),this._currentGuildEvent++,this.startGuildEvent()},e.prototype.playMyDrawTw=function(t){var e=this;this.removeChild(t.currentTarget);var i=this.guildEventList[this._currentGuildEvent];if(6==this._stepIndex){var n=i.eventObj;n.visible=!1;var a=this.getCardListViewWidth(),s=(this.cardGroup.width-a)/2,o=new ImageTwClass,r=this.outCard.parent.localToGlobal(this.outCard.x,this.outCard.y);o.x=r.x,o.y=r.y,o.setCardSource(n.cardData.num,n.cardData.type),this.addChild(o);var h=s+a-95,l=this.rectCard.y;o.createTw(new egret.Point(h,l),10,500,function(){o.visible=!1,e.updateCardList(e.cardData3),e._currentGuildEvent++,e.startGuildEvent()})}if(13==this._stepIndex){this.maskCard.hideTipsHighLight();var a=this.getCardListViewWidth(),s=(this.cardGroup.width-a)/2,c=new ImageTwClass,r=this.maskCard.parent.localToGlobal(this.maskCard.x,this.maskCard.y);c.x=r.x,c.y=r.y,c.setCardSource(this.openCardData2[1],this.openCardData2[2]),this.addChild(c);var h=s+a-95,l=this.rectCard.y;c.createTw(new egret.Point(h,l),10,500,function(){c.visible=!1,e.updateCardList(e.cardData7),e._currentGuildEvent++,e.startGuildEvent()})}},e.prototype.discardCard=function(t){var e=this;this.removeChild(t.currentTarget);var i=this.guildEventList[this._currentGuildEvent],n=i.eventObj,a=n.cardData,s=new ImageTwClass;s.x=n.x,s.y=n.y+this.cardGroup.y,s.setCardSource(n.cardData.num,n.cardData.type),this.addChild(s),this.doCreateCard();var o=this.outCard.parent.localToGlobal(this.outCard.x,this.outCard.y);s.createTw(new egret.Point(o.x,o.y),10,200,function(){s.visible=!1,e.outCard.doUpdateCard(a,cardTypes.CARD_FOLD),e.outCard.visible=!0}),7==this._stepIndex&&(this.btnDisCard.visible=!1,this.updateCardList(this.cardData4)),this._currentGuildEvent++,this.startGuildEvent()},e.prototype.finishCardTw=function(t){var e=this;this.removeChild(t.currentTarget);var i=this.guildEventList[this._currentGuildEvent],n=i.eventObj,a=n.cardData,s=new ImageTwClass;s.x=n.x,s.y=n.y+this.cardGroup.y,s.setCardSource(n.cardData.num,n.cardData.type),this.addChild(s),this.doCreateCard();var o=this.finishCard.parent.localToGlobal(this.finishCard.x,this.finishCard.y);s.createTw(new egret.Point(o.x,o.y),10,200,function(){s.visible=!1,e.finishCard.doUpdateCard(a,cardTypes.CARD_FOLD),e.finishCard.visible=!0}),this.btnFinish.visible=!1,this.updateCardList(this.cardData9),this._currentGuildEvent++,this.startGuildEvent()},e.prototype.groupCard=function(t){this.removeChild(t.currentTarget),8==this._stepIndex&&(this.btnDisCard.visible=!1,this.updateCardList(this.cardData5)),11==this._stepIndex&&(this.btnDisCard.visible=!1,this.updateCardList(this.cardData6)),15==this._stepIndex&&(this.btnDisCard.visible=!1,this.updateCardList(this.cardData8)),this.btnGroup.visible=!1,this._currentGuildEvent++,this.startGuildEvent()},e.prototype.playOtherDrawTw=function(){var t=this,e=new ImageTwClass,i=this.outCard.parent.localToGlobal(this.outCard.x,this.outCard.y);e.x=i.x,e.y=i.y,e.setCardSource(this.outCard.cardData.num,this.outCard.cardData.type),this.addChild(e);var n=this.cpuHead.x,a=this.cpuHead.y;e.createTw(new egret.Point(n,a),10,200,function(){e.visible=!1,egret.setTimeout(t.playOtherDiscard,t,2e3)})},e.prototype.playOtherDiscard=function(){var t=this,e=new CardData;e.init(this.opponentCardData,6);var i=new ImageTwClass,n=this.outCard.parent.localToGlobal(this.outCard.x,this.outCard.y);i.x=this.cpuHead.x,i.y=this.cpuHead.y,i.setCardSource(e.num,e.type),this.addChild(i);this.cpuHead.x,this.cpuHead.y;i.createTw(new egret.Point(n.x,n.y),10,200,function(){i.visible=!1,t.outCard.doUpdateCard(e,cardTypes.CARD_FOLD),t.doNoviceUiEffect()})},e.prototype.updateCardList=function(t){this._groupList=[];for(var e=JSON.parse(t),i=e.data,n=0;n<i.length;n++){var a=i[n],s=new GroupData;s.initGroupData(n,a,this.jokerData[1]),this._groupList.push(s)}this.doCreateCard()},e.prototype.updateCpuCardList=function(t){this._cpuGroupList=[];for(var e=JSON.parse(t),i=e.data,n=0;n<i.length;n++){var a=i[n],s=new GroupData;s.initGroupData(n,a,this.jokerData[1]),this._cpuGroupList.push(s)}},e.prototype.doCreateCard=function(){for(var t=null,e=0;e<this._cardViewList.length;++e)t=this._cardViewList[e],t.visible=!1;for(var i=null,e=0;e<this.pokerTipAry.length;++e)i=this.pokerTipAry[e],i.visible=!1;for(var n=0,a=(this.cardGroup.width-this.getCardListViewWidth())/2,s=null,o=this._groupList,r=0;r<o.length;r++){var h=o[r],l=h.cardList,c=this.pokerTipAry[r];c||(c=new PokerTip,this.pokerTipAry.push(c),this.cardGroup.addChild(c)),c.visible=!0,c.showPokerTip(h),l.length>1?c.x=a+(65*l.length+30-c.width)/2:c.x=a,c.y=this.rectCard.y-40;for(var d=0;d<l.length;d++){l[d];s=this._cardViewList[n],s||(this.cardGroup.addChild(s=new CardView),this._cardViewList.push(s)),s.cardIndex=n,s.visible=!0,s.doUpdateCard(l[d],cardTypes.CARD_ME),s.x=a,s.y=this.rectCard.y,s.xpos=s.x,s.ypos=s.y,n++,a+=65}a+=10,a+=30}},e.prototype.getCardListViewWidth=function(){for(var t=0,e=this._groupList,i=0;i<e.length;i++){var n=e[i];t+=65*n.cardList.length+30}return t+10*(e.length-1)},e.prototype.playCardTw=function(){var t=new CardData,e=new CardData;t.init(this.jokerData,this.jokerData[1]),e.init(this.openCardData1,this.jokerData[1]),this.jokerCard.doUpdateCard(t,cardTypes.CARD_DESKTOP_JOKER),this.outCard.doUpdateCard(e,cardTypes.CARD_FOLD),this.maskCard.doUpdateCard(null,cardTypes.CARD_DESKTOP),this.showCardGroup.visible=!0,this.jokerCard.visible=!0,this.outCard.visible=!0,this.maskCard.visible=!0,this.playTweenFunc()},e.prototype.playTweenFunc=function(){this._num=0,this._cardViewList=[],this.cardGroup.removeChildren(),this.timer=new egret.Timer(100,this._cardList.length),this.timer.addEventListener(egret.TimerEvent.TIMER,this.dealCardTw,this),this.timer.start()},e.prototype.dealCardTw=function(){var t=this,e=this.showCardGroup.localToGlobal(this.maskRect.x,this.maskRect.y);this.currentX=(this.cardGroup.width-this.getCardListLength())/2+65*this._num;var i=this.cardGroup.localToGlobal(this.currentX,this.rectCard.y),n=new ImageTwClass;n.x=e.x,n.y=e.y,n.setCardData(this._cardList[this._num]),this.addChild(n),n.createTw(i,10,200,function(){var e=new CardView;e.doUpdateCard(n.getCardData(),cardTypes.CARD_ME);var i=t.cardGroup.globalToLocal(n.x,n.y);e.x=i.x,e.y=t.rectCard.y,t._cardViewList.push(e),t.cardGroup.addChild(e),t._num==t._cardList.length&&t.nextStep(),t.removeChild(n)}),this._num+=1},e.prototype.showResult=function(){this.updateCpuCardList(this.cardData10);var t={};t.name="You",t.result="Won",t.point="0",t.score="4",t.cardlist=this._groupList;var e={};e.name="CPU",e.result="Lose",e.point="80",e.score="-4",e.cardlist=this._cpuGroupList;var i=[];i.push(t),i.push(e);var n=new GuildResult;n.initView(i),n.x=151,n.y=14,this.addChild(n)},e.prototype.showPureHighlight=function(){for(var t=0;t<this._cardViewList.length;t++){var e=this._cardViewList[t];2==e.cardData.type&&e.showTipsHighLight()}egret.setTimeout(this.doNoviceUiEffect,this,3e3)},e.prototype.hideCardHighLight=function(){for(var t=0;t<this._cardViewList.length;t++){var e=this._cardViewList[t];e.hideTipsHighLight()}},e.prototype.showText=function(){this.labGuildText.text="",this.guildGroup.visible=!0;var t=this._data[this._stepIndex];this._text=t,this._num=0,this.timer=new egret.Timer(50,t.length),this.timer.addEventListener(egret.TimerEvent.TIMER,this.timerFunc,this),this.timer.addEventListener(egret.TimerEvent.TIMER_COMPLETE,this.timerComFunc,this),this.timer.start(),0==this.showTextBegin&&this.handleStep()},e.prototype.timerFunc=function(){var t=this._text[this._num];this.labGuildText.text+=t,this._num+=1},e.prototype.timerComFunc=function(){1==this.showTextBegin&&this.handleStep()},e.prototype.getCardListLength=function(t){void 0===t&&(t=0);if(0==t){var e=65*this._cardList.length+30;return e}},e.prototype.initCardList=function(t){this._cardList=[];for(var e=0;e<t.length;e++){var i=new CardData;i.init(t[e],this.jokerData[1]),this._cardList.push(i)}},e.prototype.onCilckClose=function(t){lz.Facade.sendNotification(lz.GameFrameEvent.OPEN_VIEW,GameViewType.AppHome,"open")},e}(BattleViewCE);__reflect(BattleGuildView.prototype,"BattleGuildView");var GuildEvent=function(){function t(t,e,i){this.func=t,this.showObj=e,this.eventObj=i;var n=e.parent.localToGlobal(e.x,e.y);this.xpos=n.x+e.width/2,this.ypos=n.y+e.height/2}return t}();__reflect(GuildEvent.prototype,"GuildEvent");var GuildResult=function(t){function e(){var e=t.call(this)||this;return e.cardViewAry=[],e._imgBack=new eui.Image,e._imgBack.source="battle_json.scoreboard3",e.addChild(e._imgBack),e._leaveBtn=new eui.Image,e._leaveBtn.source="battle_json.BacktoLobby",e._leaveBtn.x=387,e._leaveBtn.y=608,e._leaveBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,e.onCloseGuild,e),e.addChild(e._leaveBtn),e}return __extends(e,t),e.prototype.initView=function(t){for(var e=0;e<t.length;e++){var i=t[e],n=new eui.Label;n.text=i.name,n.x=40,n.y=170+75*e,this.addChild(n);var a=new eui.Label;a.text=i.result,a.x=200,a.y=170+75*e,this.addChild(a);var s=new eui.Label;s.text=i.point,s.x=790,s.y=170+75*e,this.addChild(s);var o=new eui.Label;o.text=i.score,o.x=900,o.y=170+75*e,this.addChild(o),this.doCreateResultCard(i.cardlist,e)}},e.prototype.onCloseGuild=function(t){lz.Facade.sendNotification(lz.GameFrameEvent.OPEN_VIEW,GameViewType.AppHome,"open")},e.prototype.doCreateResultCard=function(t,e){for(var i=0,n=285,a=null,s=0;s<t.length;s++){for(var o=t[s],r=o.cardList,h=0;h<r.length;h++){r[h];a=new CardView,this.addChild(a),a.cardIndex=i,a.visible=!0,a.doUpdateCard(r[h],cardTypes.CARD_ME),a.x=n,a.y=155+75*e,a.xpos=a.x,a.ypos=a.y,a.scaleX=a.scaleY=.45,i++,n+=30}n+=5,n+=15}},e}(eui.Component);__reflect(GuildResult.prototype,"GuildResult");var ThemeAdapter=function(){function t(){}return t.prototype.getTheme=function(t,e,i,n){function a(t){e.call(n,t)}function s(e){e.resItem.url==t&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,s,null),i.call(n))}var o=this;"undefined"!=typeof generateEUI?egret.callLater(function(){e.call(n,generateEUI)},this):"undefined"!=typeof generateEUI2?RES.getResByUrl("resource/gameEui.json",function(t,i){window.JSONParseClass.setData(t),a(t),egret.callLater(function(){e.call(n,generateEUI2)},o)},this,RES.ResourceItem.TYPE_JSON):(RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,s,null),RES.getResByUrl(t,a,this,RES.ResourceItem.TYPE_TEXT))},t}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]);var BattleConfig=function(){function t(){}return t.have_Count=13,t}();__reflect(BattleConfig.prototype,"BattleConfig");var HttpConfig=function(){function t(){}return t.TEST_AIRPAY="user/testAirpay",t.SEND_SMS="user/sendSms",t.TOKEN_LOGIN="user/login",t.REFRESH_TOKEN="user/refreshToken",t.USER_LOGIN="user/userLogin",t.GAME_VERSION="user/getVersion",t.ERROR_REPORT="user/errorReport",t.DELETE_FACEBOOK="user/deleteFacebook",t}();__reflect(HttpConfig.prototype,"HttpConfig");var LanguageConfig=function(){function t(){}return t.init=function(e){for(var i=[{nTag:1001,langZH:"退出按失败处理，确定退出吗？",langCN:"Quit now will be processed as lost, \n are you sure you want to quit?"},{nTag:1002,langZH:"The pay method is integrating.... \n Please wait!",langCN:"The pay method is integrating.... \n Please wait!"},{nTag:1003,langZH:"Please try again later",langCN:"Please try again later"},{nTag:1004,langZH:"It is not yet available",langCN:"It is not yet available"},{nTag:1005,langZH:"User data updated!",langCN:"User data updated!"},{nTag:2001,langZH:"Invalid phone number!",langCN:"Invalid phone number!"},{nTag:2002,langZH:"Invalid OTP!",langCN:"Invalid OTP"},{nTag:2003,langZH:"文字长度在6-12以内!",langCN:"Text length is within 6-12"},{nTag:2004,langZH:"文字不能为空!",langCN:"Text cannot be empty"},{nTag:2005,langZH:"手机号码必须为11位!",langCN:"Mobile number length must 11"},{nTag:3e3,langZH:"网络重新连接",langCN:"Network Reconnecting..."},{nTag:3001,langZH:"登陆成功!",langCN:"Login Successful"},{nTag:3002,langZH:"连接服务器失败Socket!",langCN:"Failed to connect the server."},{nTag:3003,langZH:"服务器连接失败，请稍后再试!",langCN:"Game server connect failed \n please try again later."},{nTag:3004,langZH:"网络错误，验证失败!",langCN:"Network error, verification failed."},{nTag:3005,langZH:"OTP has been sent successfully.",langCN:"OTP has been sent successfully."},{nTag:3006,langZH:"网络连接不稳定，请重新连接!",langCN:"Network unstable,please reconnect."},{nTag:3007,langZH:"您的账号已在别的设备登陆，请重新登录!",langCN:"Your account is logged in elsewhere, \n please check."},{nTag:3008,langZH:"JaldiRummy is not available in your state/union \n territory at this time",langCN:"JaldiRummy is not available in your state/union \n territory at this time"},{nTag:3009,langZH:"Cannot be sent in a short time",langCN:"Cannot be sent in a short time"},{nTag:3010,langZH:"手机号已经绑定",langCN:"Mobile number binded"},{nTag:4e3,langZH:"Drop Game将会失去点数",langCN:"Drop Game Will lose points."},{nTag:4001,langZH:"您已经Drop Game,请问是不是要换个桌子",langCN:"You have dropped game, do you want to change a table?"},{nTag:5e3,langZH:"不能发送空消息",langCN:"Can not send empty message"},{nTag:6001,langZH:"Reload Gold Success",langCN:"Reload Gold Success!"},{nTag:6002,langZH:"Add Cash Success",langCN:"Add Cash Success!"},{nTag:6003,langZH:"Facebook info delete success!",langCN:"Facebook info delete success!"},{nTag:6004,langZH:"Collect bonus success!",langCN:"Collect bonus success!"},{nTag:6005,langZH:"You have not login the game with FACEBOOK",langCN:"You have not login the game with FACEBOOK"},{nTag:7e3,langZH:"Payment Success!",langCN:"Payment Success!"},{nTag:7001,langZH:"Paymnet Failed!",langCN:"Payment Failed!"},{nTag:7002,langZH:"Payment Error! Please connect service",langCN:"Payment Error! Please connect service"},{nTag:7003,langZH:"Payment Cancel!",langCN:"Payment Cancel!"},{nTag:7004,langZH:"Payment Pending! Please wait later",langCN:"Payment Pending! Please wait later"},{nTag:7005,langZH:"You have exist payment. continue?",langCN:"You have exist payment. continue?"},{nTag:7010,langZH:"The amount is must in 100 - 10000",langCN:"The amount is must in 100 - 10000"},{nTag:7011,langZH:"Please select pey type!",langCN:"Please select pey type!"},{nTag:7012,langZH:"Please select UPI APP!",langCN:"Please select UPI APP!"},{nTag:7013,langZH:"Please enter and verify UPI ID!",langCN:"Please enter and verify UPI ID!"},{nTag:7014,langZH:"Please enter valid card info!",langCN:"Please enter valid card info!"}],n=null,a=0;a<i.length;++a)n=i[a],t._languageAny[+n.nTag]=n.langCN;this._lan=e},t.getLanData=function(t){return this._lan[t]},t.getTxtByTag=function(e){return t._languageAny[e]},t._languageAny={},t._lan={},t.TAG_TITLE_TIPS=101,t.TAG_NOT_OPEN=102,t.TAG_BATTLE_OUT=1001,t.TAG_PAY_INTEGRATING=1002,t.TAG_TRY_LATER=1003,t.TAG_NOT_AVAILABLE=1004,t.TAG_USER_DATA_UPDATE=1005,t.TAG_PHONE_ERROR=2001,t.TAG_CODE_ERROR=2002,t.TEXT_LENGTH_WITH_12=2003,t.TEXT_LENGTH_NOT_EMPTY=2004,t.MOBILE_LENGTH_MUST_11=2005,t.TAG_SOCKET_RECONNECT=3e3,t.TAG_CONTRO_LOGIN=3001,t.TAG_CONTRO_ERROR_SOCKET=3002,t.TAG_CONTRO_ERROR=3003,t.TAG_CONTRO_ERROR_VERIFY=3004,t.TAG_CONTRO_SEND=3005,t.SOCKET_DISCONNECT=3006,t.LOGIN_OTHER_PLACE=3007,t.REJECT_LOCATION=3008,t.SMS_COUNTDOWN=3009,t.MOBILE_BINDED=3010,t.DROP_GAME_NOTICE=4e3,t.DROP_GAME_CHANGE=4001,t.CAN_NOT_SEND_NULL=5e3,t.RELOAD_GOLD_SUCCESS=6001,t.ADD_CASH_SUCCESS=6002,t.FB_DELETE_SUCCESS=6003,t.COLLECT_BONUS_SUCCESS=6004,t.FACEBOOK_NOT_LOGIN=6005,t.PAY_SUCCESS=7e3,t.PAY_FAILED=7001,t.PAY_ERROR=7002,t.PAY_CANCEL=7003,t.PAY_PENDING=7004,t.PAY_EXIST=7005,t.PAY_AMOUNT_ERROR=7010,t.SELECT_PAY_TYPE=7011,t.SELECT_UPI_APP=7012,t.VERIFY_UPI_ID=7013,t.ENTER_VALID_CARD_INFO=7014,t}();__reflect(LanguageConfig.prototype,"LanguageConfig");var BattleController=function(){function t(){this.gamedispatch=lz.GameDispatcher.getInstance(),this._battle=DataCenter.getInstance().battle,this._player=DataCenter.getInstance().player,this._game=DataCenter.getInstance().game,this.ding=null,this.initListener()}return t.getInstance=function(){return null==t.instance&&(t.instance=new t),t.instance},t.prototype.initListener=function(){this.gamedispatch.addEventListener(String(EventManager.SCMD_3000),this.gameStartHandle,this),this.gamedispatch.addEventListener(String(EventManager.SCMD_3002),this.startCountDownHandler,this),this.gamedispatch.addEventListener(String(EventManager.SCMD_3004),this.startDealHandler,this),this.gamedispatch.addEventListener(String(EventManager.SCMD_3016),this.turnSomeBodyDrawPoker,this),this.gamedispatch.addEventListener(String(EventManager.SCMD_3034),this.declarePokerNotification,this),this.gamedispatch.addEventListener(String(EventManager.SCMD_3038),this.completeDeclareNotification,this),this.gamedispatch.addEventListener(String(EventManager.SCMD_3010),this.gameOverHandler,this),this.gamedispatch.addEventListener(String(EventManager.SCMD_3040),this.updateBattleHandle,this),this.gamedispatch.addEventListener(String(EventManager.SCMD_3012),this.movePokerResult,this),this.gamedispatch.addEventListener(String(EventManager.SCMD_3006),this.drawPokerResult,this),this.gamedispatch.addEventListener(String(EventManager.SCMD_3008),this.playPokerResult,this),this.gamedispatch.addEventListener(String(EventManager.SCMD_3022),this.groupPokerResult,this),this.gamedispatch.addEventListener(String(EventManager.SCMD_3024),this.finishPokerResult,this),this.gamedispatch.addEventListener(String(EventManager.SCMD_3026),this.declarePokerResult,this),this.gamedispatch.addEventListener(String(EventManager.SCMD_3028),this.dropGameResult,this),this.gamedispatch.addEventListener(String(EventManager.SCMD_3030),this.leaveGameResult,this),this.gamedispatch.addEventListener(String(EventManager.SCMD_3018),this.drawPokerNotification,this),this.gamedispatch.addEventListener(String(EventManager.SCMD_3020),this.playPokerNotification,this),this.gamedispatch.addEventListener(String(EventManager.SCMD_3032),this.finishPokerNotification,this),this.gamedispatch.addEventListener(String(EventManager.SCMD_3036),this.errorDeclareNotification,this),this.gamedispatch.addEventListener(String(EventManager.SCMD_3050),this.onUpdateBattle,this),this.gamedispatch.addEventListener(String(EventManager.SCMD_3052),this.onKickFromBattle,this)},t.prototype.updateBattle=function(){var t={};t.userid=this._player.info.id,GameSocket.getInstance().send(EventManager.CCMD_3049,t)},t.prototype.onUpdateBattle=function(t){var e=t.data?t.data.data:null;if(e&&0==t.data.code){this._player.updateUserData(e.playerdata);var i=e.battledata,n=e.roomdata;i&&n?lz.Facade.sendNotification(GameEvent.UPDATE_BATTLE,{battleData:i,roomData:n}):lz.Facade.sendNotification(GameEvent.CLOSE_BATTLE,{battleData:i,roomData:n})}else t.data&&t.data.message?Utils.showMessageBox2(t.data.message):lz.Facade.sendNotification(GameEvent.CLOSE_BATTLE)},t.prototype.onKickFromBattle=function(t){var e=t.data?t.data.data:null;
e&&0==t.data.code?(this._player.updatePlayerGoldCash(e.gold,e.cash,e.cash_reward),lz.Facade.sendNotification(GameEvent.KICK_FROM_BATTLE,{reason:e.reason})):t.data&&t.data.message&&Utils.showMessageBox2(t.data.message)},t.prototype.movePoker=function(t,e,i){var n={};n.pokerid=t.id,n.groupIndex=t.groupIndex,n.pokerIndex=t.cardIndex,n.targetGroup=e,n.targetIndex=i,n.userid=this._player.info.id,GameSocket.getInstance().send(EventManager.CCMD_3011,n)},t.prototype.finishPoker=function(t){var e={};e.roomid=this._game.currentRoom.roomId,e.pokerid=t.id,e.groupIndex=t.groupIndex,e.pokerIndex=t.cardIndex,e.userid=this._player.info.id,GameSocket.getInstance().send(EventManager.CCMD_3023,e)},t.prototype.playPoker=function(t){var e={};e.roomid=this._game.currentRoom.roomId,e.pokerid=t.id,e.groupIndex=t.groupIndex,e.pokerIndex=t.cardIndex,e.userid=this._player.info.id,GameSocket.getInstance().send(EventManager.CCMD_3007,e)},t.prototype.drawPoker=function(t){var e={};e.roomid=this._game.currentRoom.roomId,e.type=t,e.userid=this._player.info.id,GameSocket.getInstance().send(EventManager.CCMD_3005,e)},t.prototype.groupPoker=function(t){var e={};e.roomid=this._game.currentRoom.roomId,e.grouppokerlist=t,e.userid=this._player.info.id,GameSocket.getInstance().send(EventManager.CCMD_3021,e)},t.prototype.declarePoker=function(){var t={};t.roomid=this._game.currentRoom.roomId,t.userid=this._player.info.id,GameSocket.getInstance().send(EventManager.CCMD_3025,t)},t.prototype.dropGame=function(){AndroidManager.getInstance().trackEvent("battle_other","other_event","DROP");var t={};t.roomid=this._game.currentRoom.roomId,t.userid=this._player.info.id,GameSocket.getInstance().send(EventManager.CCMD_3027,t)},t.prototype.leaveGame=function(){AndroidManager.getInstance().trackEvent("battle_other","other_event","LEAVE");var t={userid:this._player.info.id};GameSocket.getInstance().send(EventManager.CCMD_3029,t)},t.prototype.startDealHandler=function(t){var e=t.data?t.data.data:null;e&&0==t.data.code&&(this._battle.battleState=BATTLE_STATE.RUNNING,this._game.updatePlayerState(-1,PLAYER_STATE.GAME_WAITING,1),this._game.updatePlayerScore(e.scoredata),this._battle.isPlayed=0,this._battle.closeCardCount=e.pokercount,this._battle.tossTime=e.tosstime,this._battle.tossUserId=e.tossuserid,this._battle.initJokerCard(e.wildjokerdata),this._battle.initFoldList(e.droppokerlist),this._battle.initTossList(e.tossdata,e.pokerdata),this._battle.initRecordList(e.recordlist))},t.prototype.gameOverHandler=function(t){var e=t.data?t.data.data:null;e&&0==t.data.code&&(this._player.updatePlayerGoldCash(e.gold,e.cash,e.cash_reward),this._battle.initResultList(e),lz.Facade.sendNotification(GameEvent.GAME_OVER,{result:e}))},t.prototype.updateBattleHandle=function(t){var e=t.data?t.data.data:null;if(e&&0==t.data.code){this._game.updateRoomInfo(e.roomdata);var i=e.updatetype;i==GAME_UPDATE_TYPE.ROOM_PLAYER&&lz.Facade.sendNotification(GameEvent.UPDATA_ROOMINFO),i==GAME_UPDATE_TYPE.PLAYER_STATE&&lz.Facade.sendNotification(GameEvent.UPDATA_PLAYER_STATE)}else Utils.showMessageBox2(t.data.message)},t.prototype.gameStartHandle=function(t){var e=t.data?t.data.data:null;e&&0==t.data.code&&(this._player.updatePlayerGoldCash(e.gold,e.cash,e.cash_reward),this._battle.battleState=e.battlestate,this._game.updateRoomInfo(e.roomdata),lz.Facade.sendNotification(GameEvent.UPDATA_ROOMINFO),lz.Facade.sendNotification(GameEvent.RENEW_GAME))},t.prototype.startCountDownHandler=function(t){var e=t.data?t.data.data:null;e&&0==t.data.code&&(this._battle.battleState=BATTLE_STATE.READY,this._battle.startTime=e.starttime,lz.Facade.sendNotification(GameEvent.START_COUNT_DOWN))},t.prototype.turnSomeBodyDrawPoker=function(t){var e=t.data?t.data.data:null;e&&0==t.data.code&&lz.Facade.sendNotification(GameEvent.GAME_TURN,{turnData:e})},t.prototype.movePokerResult=function(t){var e=t.data?t.data.data:null;e&&0==t.data.code?e.pokerlist&&this._battle.initCardList(e.pokerlist,!1,!0):t.data&&t.data.message&&Utils.showMessageBox2(t.data.message)},t.prototype.drawPokerResult=function(t){var e=t.data?t.data.data:null;if(e&&0==t.data.code){if(e.pokerdata){this._battle.isPlayed=1,this._game.updatePlayerState(this._player.userId,PLAYER_STATE.DISCARDING,1);var i=e.drawtype,n=new CardData;n.init(e.drawpoker,this._battle.wildJokerData.num),this._battle.initCardList(e.pokerdata,!1,!1),this._battle.initFoldList(e.droppokerlist),lz.Facade.sendNotification(GameEvent.DRAW_POKER,{card:n,drawType:i})}}else t.data&&t.data.message&&Utils.showMessageBox2(t.data.message)},t.prototype.playPokerResult=function(t){var e=t.data?t.data.data:null;if(e&&0==t.data.code){var i=e.playerstate;this._game.updatePlayerState(this._player.userId,i,1);var n=e.pokerdata;this._battle.initCardList(e.pokerlist,!1,!1);var a=e.droppokerlist;lz.Facade.sendNotification(GameEvent.PLAY_POKER,{card:n,droplist:a})}else t.data&&t.data.message&&Utils.showMessageBox2(t.data.message)},t.prototype.drawPokerNotification=function(t){var e=t.data?t.data.data:null;if(e&&0==t.data.code){var i=e.userid,n=e.drawtype,a=e.pokerdata;this._battle.closeCardCount=e.pokercount,this._battle.initFoldList(e.droppokerlist),lz.Facade.sendNotification(GameEvent.DRAW_POKER_NOTIFICATION,{id:i,drawtype:n,card:a})}},t.prototype.playPokerNotification=function(t){var e=t.data?t.data.data:null;if(e&&0==t.data.code){var i=e.userid,n=e.pokerdata,a=e.droppokerlist;lz.Facade.sendNotification(GameEvent.PLAY_POKER_NOTIFICATION,{id:i,card:n,droplist:a})}},t.prototype.finishPokerNotification=function(t){var e=t.data?t.data.data:null;if(e&&0==t.data.code){var i=e.userid;this._battle.battleState=BATTLE_STATE.FINISH;var n=this._game.currentRoom.getPlayerById(i);n&&(this._battle.overTime=e.finishtime,n.dp_EndTime=e.finishtime,this._game.updatePlayerState(i,PLAYER_STATE.DECLARING,1),lz.Facade.sendNotification(GameEvent.FINISH_POKER_NOTIFICATION,{id:i}))}},t.prototype.declarePokerNotification=function(t){var e=t.data?t.data.data:null;e&&0==t.data.code&&this._battle.initResultList(e.battleresult)},t.prototype.completeDeclareNotification=function(t){var e=t.data?t.data.data:null;if(e&&0==t.data.code){var i=e.userid,n=e.pokerdata,a=e.playerstate;this._battle.overTime=e.overtime,this._game.updatePlayerState(i,a,1),this._battle.initFoldList(e.droppokerlist),lz.Facade.sendNotification(GameEvent.FINISH_DECLARE_NOTIFICATION,{id:i,card:n})}},t.prototype.errorDeclareNotification=function(t){var e=t.data?t.data.data:null;if(e&&0==t.data.code){var i=e.userid;lz.Facade.sendNotification(GameEvent.ERROR_DECLARE_NOTIFICATION,{id:i})}},t.prototype.finishPokerResult=function(t){var e=t.data?t.data.data:null;if(e&&0==t.data.code){this._battle.battleState=BATTLE_STATE.FINISH;var i=this._game.currentRoom.getPlayerById(this._player.userId);if(i){this._battle.overTime=e.finishtime,i.dp_EndTime=e.finishtime,this._game.updatePlayerState(this._player.userId,PLAYER_STATE.DECLARING,1);var n=e.pokerdata;this._battle.initCardList(e.pokerlist,!1,!1),lz.Facade.sendNotification(GameEvent.FINISH_POKER,{card:n})}}else t.data&&t.data.message&&Utils.showMessageBox2(t.data.message)},t.prototype.declarePokerResult=function(t){var e=t.data?t.data.data:null;if(e&&0==t.data.code){var i=e.declareresult;if(0==i){this._game.updatePlayerState(this._player.userId,PLAYER_STATE.DROP_GAME,1);var n=e.finishpoker;lz.Facade.sendNotification(GameEvent.ERROR_DECLARE,{card:n})}}else t.data&&t.data.message&&Utils.showMessageBox2(t.data.message)},t.prototype.dropGameResult=function(t){var e=t.data?t.data.data:null;e&&0==t.data.code?lz.Facade.sendNotification(GameEvent.ME_DROP_GAME):t.data&&t.data.message&&Utils.showMessageBox2(t.data.message)},t.prototype.leaveGameResult=function(t){var e=t.data?t.data.data:null;e&&0==t.data.code?(this._player.updatePlayerGoldCash(e.gold,e.cash,e.cash_reward),lz.Facade.sendNotification(lz.GameFrameEvent.OPEN_VIEW,GameViewType.AppHome,"open")):t.data&&t.data.message&&Utils.showMessageBox2(t.data.message)},t.prototype.groupPokerResult=function(t){var e=t.data?t.data.data:null;e&&0==t.data.code?e.pokerlist&&this._battle.initCardList(e.pokerlist):t.data&&t.data.message&&Utils.showMessageBox2(t.data.message)},t}();__reflect(BattleController.prototype,"BattleController");var PHONEPE_CODE;!function(t){t[t.PAYMENT_SUCCESS=0]="PAYMENT_SUCCESS",t[t.BAD_REQUEST=1]="BAD_REQUEST",t[t.AUTHORIZATION_FAILED=2]="AUTHORIZATION_FAILED",t[t.INTERNAL_SERVER_ERROR=3]="INTERNAL_SERVER_ERROR",t[t.TRANSACTION_NOT_FOUND=4]="TRANSACTION_NOT_FOUND",t[t.PAYMENT_ERROR=5]="PAYMENT_ERROR",t[t.PAYMENT_PENDING=6]="PAYMENT_PENDING",t[t.PAYMENT_DECLINED=7]="PAYMENT_DECLINED",t[t.TIMED_OUT=8]="TIMED_OUT"}(PHONEPE_CODE||(PHONEPE_CODE={}));var CHAT_ACTION;!function(t){t[t.INIT_CHAT=0]="INIT_CHAT",t[t.UPDATE_CHAT=1]="UPDATE_CHAT",t[t.DROP_DOWN=2]="DROP_DOWN"}(CHAT_ACTION||(CHAT_ACTION={}));var GameController=function(){function t(){this.gamedispatch=lz.GameDispatcher.getInstance(),this._propsStoreTowerId=0,this._app=DataCenter.getInstance().app,this._game=DataCenter.getInstance().game,this._battle=DataCenter.getInstance().battle,this._player=DataCenter.getInstance().player,this.addListener()}return t.getInstance=function(){return null==t.instance&&(t.instance=new t),t.instance},t.prototype.addListener=function(){this.gamedispatch.addEventListener(String(EventManager.SC_MODIFY_USER_DATA),this.onPlayerDataHandler,this),this.gamedispatch.addEventListener(String(EventManager.SC_CHAT_LIST),this.onChatList,this),this.gamedispatch.addEventListener(String(EventManager.SC_USER_ADD_CHAT),this.onUserAddChat,this),this.gamedispatch.addEventListener(String(EventManager.SC_ADMIN_ADD_CHAT),this.onAdminAddChat,this),this.gamedispatch.addEventListener(String(EventManager.SC_BONUS_LIST),this.onBonusList,this),this.gamedispatch.addEventListener(String(EventManager.SC_COLLECT_BONUS),this.onCollectBonus,this),this.gamedispatch.addEventListener(String(EventManager.SC_COLLECT_LOGIN_BONUS),this.onCollectLoginBonus,this),this.gamedispatch.addEventListener(String(EventManager.SC_TRANSACTION_LIST),this.onTransactionList,this),this.gamedispatch.addEventListener(String(EventManager.SC_ORDER_LIST),this.onOrderList,this),this.gamedispatch.addEventListener(String(EventManager.SC_ADD_ROOM),this.onEnnterRoomHandler,this),this.gamedispatch.addEventListener(String(EventManager.SC_QUIT_QUEUE),this.onLeaveHandler,this),this.gamedispatch.addEventListener(String(EventManager.SC_UPDATE_ROOM),this.upDateRoomInfo,this),this.gamedispatch.addEventListener(String(EventManager.SC_RELOAD_GOLD),this.onReloadGold,this),this.gamedispatch.addEventListener(String(EventManager.SC_ADD_PHONEPE_PAYMENT),this.onAddPhonePEPayment,this),this.gamedispatch.addEventListener(String(EventManager.SC_CHECK_PHONEPE_PAYMENT),this.onCheckPhonePEPayment,this),this.gamedispatch.addEventListener(String(EventManager.SC_CANCEL_PHONEPE_PAYMENT),this.onCancelPhonePEPayment,this),this.gamedispatch.addEventListener(String(EventManager.SC_ADD_AIRPAY_PAYMENT),this.onAddAirpayPayment,this),this.gamedispatch.addEventListener(String(EventManager.SC_CHECK_AIRPAY_PAYMENT),this.onCheckAirpayPayment,this),this.gamedispatch.addEventListener(String(EventManager.SC_CANCEL_AIRPAY_PAYMENT),this.onCancelAirpayPayment,this)},t.prototype.modifyUserData=function(t){var e={userid:this._player.info.id,mobile:t.mobile,code:t.code,email:t.email,nickname:t.nickname,avatar:t.avatar,fb_id:t.fb_id,google_id:t.google_id};GameSocket.getInstance().send(EventManager.CS_MODIFY_USER_DATA,e)},t.prototype.onPlayerDataHandler=function(t){var e=t.data?t.data.data:null;e&&0==t.data.code?(this._player.updateUserData(e),lz.Facade.sendNotification(GameEvent.UPDATA_PLAYERDATA),Utils.showMessageBox(LanguageConfig.TAG_USER_DATA_UPDATE)):Utils.showMessageBox2(t.data.message)},t.prototype.chatList=function(t,e){return __awaiter(this,void 0,void 0,function(){var i;return __generator(this,function(n){return i={userid:this._player.info.id,action:t,index:e},GameSocket.getInstance().send(EventManager.CS_CHAT_LIST,i),[2]})})},t.prototype.onChatList=function(t){var e=t.data?t.data.data:null;if(e&&0==t.data.code){var i=e.action;i==CHAT_ACTION.INIT_CHAT&&this._game.initChatList(e.list),i==CHAT_ACTION.UPDATE_CHAT&&this._game.addChatList(e.list),lz.Facade.sendNotification(GameEvent.UPDATE_USER_CHAT)}else t.data.message?Utils.showMessageBox2(t.data.message):Utils.showMessageBox(LanguageConfig.TAG_CONTRO_ERROR)},t.prototype.addChat=function(t){return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(i){return e={userid:this._player.info.id,text:t},GameSocket.getInstance().send(EventManager.CS_USER_ADD_CHAT,e),[2]})})},t.prototype.onUserAddChat=function(t){var e=t.data?t.data.data:null;e&&0==t.data.code?(this._game.addChat(e.chat),lz.Facade.sendNotification(GameEvent.UPDATE_USER_CHAT)):t.data.message?Utils.showMessageBox2(t.data.message):Utils.showMessageBox(LanguageConfig.TAG_CONTRO_ERROR)},t.prototype.onAdminAddChat=function(t){var e=t.data?t.data.data:null;e&&0==t.data.code&&(this._game.addChatList(e.list),lz.Facade.sendNotification(GameEvent.UPDATE_USER_CHAT))},t.prototype.getBonusList=function(t){return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(i){return e={userid:this._player.info.id,page:t,size:20},GameSocket.getInstance().send(EventManager.CS_BONUS_LIST,e),[2]})})},t.prototype.onBonusList=function(t){var e=t.data?t.data.data:null;if(e&&0==t.data.code){var i=e.list,n=e.page;this._game.updateBonusList(i,n),lz.Facade.sendNotification(GameEvent.UPDATE_BONUS)}else t.data.message?Utils.showMessageBox2(t.data.message):Utils.showMessageBox(LanguageConfig.TAG_CONTRO_ERROR)},t.prototype.collectBonus=function(t){return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(i){return e={userid:this._player.info.id,bonus_id:t},GameSocket.getInstance().send(EventManager.CS_COLLECT_BONUS,e),[2]})})},t.prototype.onCollectBonus=function(t){var e=t.data?t.data.data:null;if(e&&0==t.data.code){var i=e.bonus,n=e.user;this._game.updateBonusItem(i),this._player.updatePlayerGoldCash(n.gold,n.cash,n.cash_reward),lz.Facade.sendNotification(GameEvent.UPDATE_BONUS),lz.Facade.sendNotification(GameEvent.UPDATA_PLAYERDATA),Utils.showMessageBox(LanguageConfig.COLLECT_BONUS_SUCCESS)}else t.data.message?Utils.showMessageBox2(t.data.message):Utils.showMessageBox(LanguageConfig.TAG_CONTRO_ERROR)},t.prototype.collectLoginBonus=function(){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){return t={userid:this._player.info.id},GameSocket.getInstance().send(EventManager.CS_COLLECT_LOGIN_BONUS,t),[2]})})},t.prototype.onCollectLoginBonus=function(t){var e=t.data?t.data.data:null;e&&0==t.data.code?(this._game.loginBonusDay=e.login_bonus_day,this._game.loginBonusTime=e.login_bonus_time,this._player.updatePlayerGoldCash(e.gold,e.cash,e.cash_reward),lz.Facade.sendNotification(GameEvent.UPDATA_LOGIN_BONUS),lz.Facade.sendNotification(GameEvent.UPDATA_PLAYERDATA),Utils.showMessageBox(LanguageConfig.COLLECT_BONUS_SUCCESS)):t.data.message?Utils.showMessageBox2(t.data.message):Utils.showMessageBox(LanguageConfig.TAG_CONTRO_ERROR)},t.prototype.transactionList=function(t){return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(i){return e={userid:this._player.info.id,page:t,size:20},GameSocket.getInstance().send(EventManager.CS_TRANSACTION_LIST,e),[2]})})},t.prototype.onTransactionList=function(t){var e=t.data?t.data.data:null;if(e&&0==t.data.code){var i=e.list,n=e.page;this._game.updateTransactionList(i,n),lz.Facade.sendNotification(GameEvent.UPDATE_TRANSACTION)}else t.data.message?Utils.showMessageBox2(t.data.message):Utils.showMessageBox(LanguageConfig.TAG_CONTRO_ERROR)},t.prototype.orderList=function(t){return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(i){return e={userid:this._player.info.id,page:t,size:20},GameSocket.getInstance().send(EventManager.CS_ORDER_LIST,e),[2]})})},t.prototype.onOrderList=function(t){var e=t.data?t.data.data:null;if(e&&0==t.data.code){var i=e.list,n=e.page;this._game.updateOrderList(i,n),lz.Facade.sendNotification(GameEvent.UPDATE_ORDER)}else t.data.message?Utils.showMessageBox2(t.data.message):Utils.showMessageBox(LanguageConfig.TAG_CONTRO_ERROR)},t.prototype.fastGame=function(t,e,i,n,a){var s={userid:this._player.info.id,mode:t,type:e,level:i,value:n,seats:a};GameSocket.getInstance().send(EventManager.CS_ADD_ROOM,s)},t.prototype.onEnnterRoomHandler=function(t){var e=t.data?t.data.data:null;e&&0==t.data.code?(this._game.currentRoom||this._game.updateRoomInfo(e.roomdata),DataCenter.getInstance().battle.newGame(),lz.Facade.sendNotification(lz.GameFrameEvent.OPEN_VIEW,GameViewType.Battle,"open")):t.data.message?Utils.showMessageBox2(t.data.message):Utils.showMessageBox(LanguageConfig.TAG_CONTRO_ERROR)},t.prototype.leaveRoom=function(){var t={userid:this._player.info.id};GameSocket.getInstance().send(EventManager.SC_QUIT_QUEUE,t)},t.prototype.onLeaveHandler=function(t){var e=t.data?t.data.data:null;e&&0==t.data.code?lz.Facade.sendNotification(lz.GameFrameEvent.OPEN_VIEW,GameViewType.AppHome,"open"):t.data.message?Utils.showMessageBox2(t.data.message):Utils.showMessageBox(LanguageConfig.TAG_CONTRO_ERROR)},t.prototype.upDateRoomInfo=function(t){var e=t.data?t.data.data:null;e&&0==t.data.code?(this._battle.battleState=e.battlestate,this._game.updateRoomInfo(e.roomdata),lz.Facade.sendNotification(GameEvent.UPDATA_ROOMINFO)):Utils.showMessageBox2(t.data.message)},t.prototype.reloadGold=function(){var t={userid:this._player.info.id};GameSocket.getInstance().send(EventManager.CS_RELOAD_GOLD,t)},t.prototype.onReloadGold=function(t){var e=t.data?t.data.data:null;e&&0==t.data.code?this._player.info&&(this._player.info.gold=e.gold,lz.Facade.sendNotification(GameEvent.UPDATA_PLAYERDATA),Utils.showMessageBox(LanguageConfig.RELOAD_GOLD_SUCCESS)):t.data.message?Utils.showMessageBox2(t.data.message):Utils.showMessageBox(LanguageConfig.TAG_CONTRO_ERROR)},t.prototype.addPhonePEPayment=function(t,e,i){var n={userid:this._player.info.id,amount:e,pay_type:t,pay_data:i};GameSocket.getInstance().send(EventManager.CS_ADD_PHONEPE_PAYMENT,n)},t.prototype.onAddPhonePEPayment=function(t){var e=this,i=t.data?t.data.data:null;if(i&&0==t.data.code){var n=i.exist,a=i.merchant_transaction_id,s=i.amount,o="https://game.jaldirummy.com/api/pay/PhonePECallBack",r=i.pay_type,h=i.pay_data;1==n?lz.Alert.show("You have an order under payment with an amount of "+s/100+". Do you want to continue paying?","Paymen",function(){AndroidManager.getInstance().payWithPhonePe(String(e._player.userId),a,s,o,r,h)},lz.AlertType.YesNo,function(){e.cancelPhonePEPayment(a)}):AndroidManager.getInstance().payWithPhonePe(String(this._player.userId),a,s,o,r,h)}else t.data.message?Utils.showMessageBox2(t.data.message):Utils.showMessageBox(LanguageConfig.TAG_CONTRO_ERROR)},t.prototype.checkPhonePEPayment=function(t){var e={userid:this._player.info.id,merchant_transaction_id:t,isUAT:0};GameSocket.getInstance().send(EventManager.CS_CHECK_PHONEPE_PAYMENT,e)},t.prototype.onCheckPhonePEPayment=function(t){var e=t.data?t.data.data:null;if(e&&0==t.data.code){var i=e.amount,n=e.code;("BAD_REQUEST"==n||"AUTHORIZATION_FAILED"==n||"INTERNAL_SERVER_ERROR"==n||"TRANSACTION_NOT_FOUND"==n)&&Utils.showMessageBox(LanguageConfig.PAY_ERROR),("PAYMENT_PENDING"==n||"TIMED_OUT"==n)&&Utils.showMessageBox(LanguageConfig.PAY_PENDING),("PAYMENT_DECLINED"==n||"PAYMENT_ERROR"==n)&&Utils.showMessageBox(LanguageConfig.PAY_FAILED),"PAYMENT_SUCCESS"==n&&1==e.result&&(Utils.showMessageBox2("Payment sucess! Added ₹"+i/100),this._player.info&&(this._player.info.cash=e.cash,this._player.info.gold=e.gold,lz.Facade.sendNotification(GameEvent.UPDATA_PLAYERDATA)))}else t.data.message?Utils.showMessageBox2(t.data.message):Utils.showMessageBox(LanguageConfig.TAG_CONTRO_ERROR)},t.prototype.cancelPhonePEPayment=function(t){var e={userid:this._player.info.id,merchant_transaction_id:t};GameSocket.getInstance().send(EventManager.CS_CANCEL_PHONEPE_PAYMENT,e)},t.prototype.onCancelPhonePEPayment=function(t){var e=t.data?t.data.data:null;e&&0==t.data.code?Utils.showMessageBox(LanguageConfig.PAY_CANCEL):t.data.message?Utils.showMessageBox2(t.data.message):Utils.showMessageBox(LanguageConfig.TAG_CONTRO_ERROR)},t.prototype.addAirpayPayment=function(t){var e={userid:this._player.info.id,amount:t};console.log("发送"),GameSocket.getInstance().send(EventManager.CS_ADD_AIRPAY_PAYMENT,e)},t.prototype.onAddAirpayPayment=function(t){var e=this,i=t.data?t.data.data:null;if(i&&0==t.data.code){var n=i.exist,a=i.merchant_transaction_id,s=i.amount,o="https://game.jaldirummy.com/api/pay/airpaysuccesscall",r="https://game.jaldirummy.com/api/pay/airpaycancelcall";1==n?lz.Alert.show("You have an order under payment with an amount of "+s/100+". Do you want to continue paying?","Paymen",function(){AndroidManager.getInstance().payWithAirpay(String(e._player.userId),a,s,o,r)},lz.AlertType.YesNo,function(){e.cancelAirpayPayment(a)}):AndroidManager.getInstance().payWithAirpay(String(this._player.userId),a,s,o,r)}else t.data.message?Utils.showMessageBox2(t.data.message):Utils.showMessageBox(LanguageConfig.TAG_CONTRO_ERROR)},t.prototype.checkAirpayPayment=function(t){var e={userid:this._player.info.id,merchant_transaction_id:t};GameSocket.getInstance().send(EventManager.CS_CHECK_AIRPAY_PAYMENT,e)},t.prototype.onCheckAirpayPayment=function(t){var e=t.data?t.data.data:null;if(e&&0==t.data.code){var i=e.amount,n=e.code;(400==n||403==n||405==n)&&Utils.showMessageBox(LanguageConfig.PAY_ERROR),(401==n||402==n)&&Utils.showMessageBox(LanguageConfig.PAY_CANCEL),(211==n||450==n)&&Utils.showMessageBox(LanguageConfig.PAY_PENDING),503==n&&Utils.showMessageBox(LanguageConfig.PAY_FAILED),200==n&&1==e.result&&(Utils.showMessageBox2("Payment sucess! Added ₹"+i/100),this._player.info&&(this._player.info.cash=e.cash,this._player.info.gold=e.gold,lz.Facade.sendNotification(GameEvent.UPDATA_PLAYERDATA)))}else Utils.showMessageBox2(t.data.message)},t.prototype.cancelAirpayPayment=function(t){var e={userid:this._player.info.id,merchant_transaction_id:t};GameSocket.getInstance().send(EventManager.CS_CANCEL_AIRPAY_PAYMENT,e)},t.prototype.onCancelAirpayPayment=function(t){var e=t.data?t.data.data:null;e&&0==t.data.code?Utils.showMessageBox(LanguageConfig.PAY_CANCEL):Utils.showMessageBox2(t.data.message)},t}();__reflect(GameController.prototype,"GameController");var TOKEN_TYPE;!function(t){t[t.TOURIST=0]="TOURIST",t[t.FACEBOOK=1]="FACEBOOK",t[t.PHONE=2]="PHONE"}(TOKEN_TYPE||(TOKEN_TYPE={}));var LoginController=function(){function t(){this.uuid="",this.isOffLine=!1,this.init()}return t.prototype.init=function(){this._player=DataCenter.getInstance().player,this._battle=DataCenter.getInstance().battle,this._game=DataCenter.getInstance().game,this._app=DataCenter.getInstance().app,lz.GameDispatcher.getInstance().addEventListener(GameEvent.REFRESH_TOKEN,this.tokenLogin,this),lz.GameDispatcher.getInstance().addEventListener(String(EventManager.SC_LOGIN),this.onSocketLogin,this),lz.GameDispatcher.getInstance().addEventListener(String(EventManager.SCMD_6000),this.loginOtherPlace,this),lz.GameDispatcher.getInstance().addEventListener(lz.SocketEvent.SOCKET_STATE_CHANGE,this.onSocketStateChange,this)},t.getInstance=function(){return null==t.instance&&(t.instance=new t),t.instance},t.prototype.startLogin=function(){return __awaiter(this,void 0,void 0,function(){var t,e,i;return __generator(this,function(n){switch(n.label){case 0:return lz.GameConfig.channel!=CHANNEL.ANDROID?[3,2]:[4,AndroidManager.getInstance().init()];case 1:return n.sent(),[3,4];case 2:return t=lz.LocalDataManager.getValue("deviceId"),t&&t.length||(t=DataCenter.getInstance().app.uuid(),lz.LocalDataManager.setValue("deviceId",t)),e=["com.phonepe.app","com.phonepe.app.preprod","com.google.android.apps.nbu.paisa.user","net.one97.paytm","in.org.npci.upiapp"],i={reffer:"",channel_code:lz.GameConfig.channel,game_version:lz.GameConfig.version,device_id:t,upi_list:e},DataCenter.getInstance().app.appInit(i),[4,this.autoLogin()];case 3:n.sent(),n.label=4;case 4:return[2]}})})},t.prototype.socketReconnect=function(){GameSocket.getInstance().netState==lz.NET_STATE.DISCONNECT&&(Utils.showMessageBox(LanguageConfig.TAG_SOCKET_RECONNECT),this.socketConnect())},t.prototype.onSocketStateChange=function(t){console.log("GameSocket.getInstance().netState Change---",GameSocket.getInstance().netState),GameSocket.getInstance().netState==lz.NET_STATE.CONNECTED?this.socketLogin():GameSocket.getInstance().netState==lz.NET_STATE.DISCONNECT&&lz.GameGlobal.gameType!=GameViewType.AppLogin&&(lz.PopupManager.delAllPop(),this.socketReconnect())},t.prototype.loginError=function(){lz.Facade.sendNotification(lz.GameFrameEvent.OPEN_VIEW,GameViewType.AppLogin,"open")},t.prototype.loginSuccess=function(t,e){void 0===e&&(e=""),Utils.showMessageBox(LanguageConfig.TAG_CONTRO_LOGIN);var i=t.authorization;i&&(lz.LocalDataManager.setValue("access_token",i.access_token),lz.LocalDataManager.setValue("refresh_token",i.refresh_token),this._game.access_token=i.access_token,this._game.refresh_token=i.refresh_token),this._player.info.id=t.user.id,this._player.mobile=t.user.mobile,console.log("websocket_host="+t.server.host),this._game.paymentCount=t.paycount,this._game.loginBonusDay=t.login_bonus_day,this._game.loginBonusTime=t.login_bonus_time,this._app.serverInit(t),GameSocket.getInstance().netState!=lz.NET_STATE.CONNECTED?(GameSocket.getInstance().init(t.server.socket,0,{userid:t.user.userid}),this.socketConnect()):(lz.Wait.hide(),this.socketLogin())},t.prototype.socketLogin=function(){this.isOffLine=!1;var t={};t.userid=this._player.info.id,t.deviceId=this._app.deviceId,GameSocket.getInstance().send(EventManager.CS_LOGIN,t)},t.prototype.socketConnect=function(){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return t=!0,lz.Wait.show(WaitEvent.WAIT_SOCKET_CONNECT),GameSocket.getInstance().netState==lz.NET_STATE.CONNECTED||GameSocket.getInstance().netState==lz.NET_STATE.CONNECTING?[3,2]:(console.log("开始连接socket"),[4,GameSocket.getInstance().connect()]);case 1:t=e.sent(),e.label=2;case 2:return t||(Utils.showMessageBox(LanguageConfig.TAG_CONTRO_ERROR_SOCKET),this.loginError()),(GameSocket.getInstance().netState==lz.NET_STATE.CONNECTED||GameSocket.getInstance().netState==lz.NET_STATE.DISCONNECT||GameSocket.getInstance().netState==lz.NET_STATE.ERROR)&&lz.Wait.hide(),[2]}})})},t.prototype.loginOtherPlace=function(t){var e=this;this.isOffLine=!0,lz.PopupManager.delAllPop(),Utils.showAlert(LanguageConfig.LOGIN_OTHER_PLACE,LanguageConfig.TAG_TITLE_TIPS,function(){e.resetToken(),e.loginError()},lz.AlertType.Ok)},t.prototype.onSocketLogin=function(t){var e=t.data?t.data.data:null;if(e&&0==t.data.code){ServerController.getInstance().starHeartBeat(),this._player.updateUserData(e.playerdata),this._game.initRoomConfig(e.roomconfig),this._game.initLocalData();var i=e.battledata,n=e.roomdata;i&&n?lz.Facade.sendNotification(lz.GameFrameEvent.OPEN_VIEW,GameViewType.Battle,{type:"open",battleData:i,roomData:n}):this._game.socketFirst?lz.Facade.sendNotification(lz.GameFrameEvent.OPEN_VIEW,GameViewType.AppHome,"open"):lz.GameGlobal.gameType==GameViewType.Battle&&lz.Facade.sendNotification(lz.GameFrameEvent.OPEN_VIEW,GameViewType.AppHome,"open"),this._game.socketFirst=!1}else this.loginError()},t.prototype.sendSMS=function(t){return __awaiter(this,void 0,void 0,function(){var e,i;return __generator(this,function(n){switch(n.label){case 0:return AndroidManager.getInstance().trackEvent("send_sms","mobile_number",t),e={mobile:t},[4,HttpRequest.getInstance().post(SERVER.LOGIN_SERVER,HttpConfig.SEND_SMS,e)];case 1:return i=n.sent(),i&&0===i.code?(Utils.showMessageBox(LanguageConfig.TAG_CONTRO_SEND),lz.Facade.sendNotification(GameEvent.START_COUNT_DOWN)):i.message?Utils.showMessageBox2(i.message):Utils.showMessageBox(LanguageConfig.TAG_CONTRO_ERROR),[2]}})})},t.prototype.mobileLogin=function(t,e){return __awaiter(this,void 0,void 0,function(){var i,n,a;return __generator(this,function(s){switch(s.label){case 0:return AndroidManager.getInstance().trackEvent("login","login_type","MOBILE_LOGIN"),i=this._app.deviceId,lz.Wait.show(WaitEvent.WAIT_MOBILE_LOGIN),n={type:1,device_id:i,mobile:t,code:e,user_id:this._player.info.id,channel_code:this._app.channelCode,referrer:this._app.referrer},[4,HttpRequest.getInstance().post(SERVER.LOGIN_SERVER,HttpConfig.USER_LOGIN,n)];case 1:return a=s.sent(),a&&0===a.code?this.loginSuccess(a.data):a.message?(Utils.showMessageBox2(a.message),lz.Wait.hide()):(Utils.showMessageBox(LanguageConfig.TAG_CONTRO_ERROR),lz.Wait.hide()),[2]}})})},t.prototype.refreshToken=function(t){return __awaiter(this,void 0,void 0,function(){var e,i,n;return __generator(this,function(a){switch(a.label){case 0:return e={refreshToken:this._game.refresh_token},[4,HttpRequest.getInstance().post(SERVER.LOGIN_SERVER,HttpConfig.REFRESH_TOKEN,e)];case 1:return i=a.sent(),i&&0===i.code?(n=i.data,n?(lz.LocalDataManager.setValue("access_token",n.access_token),lz.LocalDataManager.setValue("refresh_token",n.refresh_token),this._game.access_token=n.access_token,this._game.refresh_token=n.refresh_token,t&&lz.GameDispatcher.getInstance().dispatchEventWith(GameEvent.REFRESH_TOKEN)):this.loginError()):this.loginError(),[2]}})})},t.prototype.tokenLogin=function(){return __awaiter(this,void 0,void 0,function(){var t,e,i;return __generator(this,function(n){switch(n.label){case 0:return console.log("请求登录：this._app.channelCode="+this._app.channelCode),t=this._app.deviceId,e={device_id:t,channel_code:this._app.channelCode,token:this._game.access_token,referrer:this._app.referrer},[4,HttpRequest.getInstance().post(SERVER.LOGIN_SERVER,HttpConfig.TOKEN_LOGIN,e,this._game.access_token)];case 1:return i=n.sent(),i&&0===i.code?this.loginSuccess(i.data):i&&1005===i.code?this.refreshToken(!0):this.loginError(),[2]}})})},t.prototype.touristLogin=function(){return __awaiter(this,void 0,void 0,function(){var t,e,i;return __generator(this,function(n){switch(n.label){case 0:return AndroidManager.getInstance().trackEvent("login","login_type","TOURIST_LOGIN"),lz.Wait.show(WaitEvent.WAIT_TOURIST_LOGIN),t=this._app.deviceId,console.log("deviceId="+t),e={type:0,device_id:t,user_id:this._player.info.id,channel_code:this._app.channelCode,referrer:this._app.referrer},[4,HttpRequest.getInstance().post(SERVER.LOGIN_SERVER,HttpConfig.USER_LOGIN,e)];case 1:return i=n.sent(),i&&0===i.code?this.loginSuccess(i.data):i.message?(Utils.showMessageBox2(i.message),lz.Wait.hide()):(Utils.showMessageBox(LanguageConfig.TAG_CONTRO_ERROR),lz.Wait.hide()),[2]}})})},t.prototype.faceBookLogin=function(t){return __awaiter(this,void 0,void 0,function(){var e,i,n;return __generator(this,function(a){switch(a.label){case 0:return AndroidManager.getInstance().trackEvent("login","login_type","FACEBOOK_LOGIN"),console.log("gameLog   fb登录   data == ",t),e=this._app.deviceId,lz.Wait.show(WaitEvent.WAIT_FACEBOOK_LOGIN),i={type:2,device_id:e,fb_id:t,user_id:this._player.info.id,channel_code:this._app.channelCode,referrer:this._app.referrer},[4,HttpRequest.getInstance().post(SERVER.LOGIN_SERVER,HttpConfig.USER_LOGIN,i)];case 1:return n=a.sent(),n&&0===n.code?this.loginSuccess(n.data):n.message?(Utils.showMessageBox2(n.message),lz.Wait.hide()):(Utils.showMessageBox(LanguageConfig.TAG_CONTRO_ERROR),lz.Wait.hide()),[2]}})})},t.prototype.googleLogin=function(t){return __awaiter(this,void 0,void 0,function(){var e,i,n;return __generator(this,function(a){switch(a.label){case 0:return AndroidManager.getInstance().trackEvent("login","login_type","GOOGLE_LOGIN"),lz.Wait.show(WaitEvent.WAIT_GOOGLE_LOGIN),console.log("gameLog   Google登录   data == ",t),e=this._app.deviceId,i={type:3,device_id:e,google_id:t,user_id:this._player.info.id,channel_code:this._app.channelCode,referrer:this._app.referrer},[4,HttpRequest.getInstance().post(SERVER.LOGIN_SERVER,HttpConfig.USER_LOGIN,i)];case 1:return n=a.sent(),n&&0===n.code?this.loginSuccess(n.data):n.message?(Utils.showMessageBox2(n.message),lz.Wait.hide()):(Utils.showMessageBox(LanguageConfig.TAG_CONTRO_ERROR),lz.Wait.hide()),[2]
}})})},t.prototype.autoLogin=function(){return __awaiter(this,void 0,void 0,function(){var t,e;return __generator(this,function(i){switch(i.label){case 0:return t=lz.LocalDataManager.getValue("access_token"),e=lz.LocalDataManager.getValue("refresh_token"),t&&t.length&&e&&e.length?(this._game.access_token=t,this._game.refresh_token=e,[4,this.tokenLogin()]):[3,2];case 1:return i.sent(),[3,3];case 2:this.loginError(),i.label=3;case 3:return[2]}})})},t.prototype.resetToken=function(){lz.LocalDataManager.setValue("access_token",""),lz.LocalDataManager.setValue("refresh_token","")},t.prototype.deleteFacebook=function(){return __awaiter(this,void 0,void 0,function(){var t,e;return __generator(this,function(i){switch(i.label){case 0:return lz.Wait.show(WaitEvent.WAIT_DELETE_FACEBOOK),t={user_id:this._player.info.id},[4,HttpRequest.getInstance().post(SERVER.LOGIN_SERVER,HttpConfig.DELETE_FACEBOOK,t)];case 1:return e=i.sent(),e&&0===e.code?(this._player.fb_id="",lz.Facade.sendNotification(GameEvent.UPDATA_PLAYERDATA),Utils.showMessageBox(LanguageConfig.FB_DELETE_SUCCESS)):e.message?Utils.showMessageBox2(e.message):Utils.showMessageBox(LanguageConfig.TAG_CONTRO_ERROR),lz.Wait.hide(),[2]}})})},t.prototype.bindFacebook=function(t){return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(i){return e={},e.nickname=null,e.mobile=null,e.code=null,e.avatar=null,e.fb_id=t,e.google_id=null,GameController.getInstance().modifyUserData(e),[2]})})},t.prototype.bindGoogle=function(t){return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(i){return e={},e.nickname=null,e.mobile=null,e.code=null,e.avatar=null,e.fb_id=null,e.google_id=t,GameController.getInstance().modifyUserData(e),[2]})})},t.prototype.getGameVersion=function(){return __awaiter(this,void 0,void 0,function(){var t,e,i;return __generator(this,function(n){switch(n.label){case 0:return t={channel_code:lz.GameConfig.channel},[4,HttpRequest.getInstance().post(SERVER.LOGIN_SERVER,HttpConfig.GAME_VERSION,t)];case 1:return e=n.sent(),e&&0===e.code?(i=e.data,lz.Facade.sendNotification(GameEvent.GAME_VERSION,{state:0,version_data:i})):e.message?(Utils.showMessageBox2(e.message),lz.Facade.sendNotification(GameEvent.GAME_VERSION,{state:1})):(Utils.showMessageBox(LanguageConfig.TAG_CONTRO_ERROR),lz.Facade.sendNotification(GameEvent.GAME_VERSION,{state:2})),[2]}})})},t.prototype.errorReport=function(t){return __awaiter(this,void 0,void 0,function(){var e,i;return __generator(this,function(n){switch(n.label){case 0:return e={error:t},[4,HttpRequest.getInstance().post(SERVER.LOGIN_SERVER,HttpConfig.ERROR_REPORT,e)];case 1:return i=n.sent(),[2]}})})},t}();__reflect(LoginController.prototype,"LoginController");var ServerController=function(){function t(){this._timerKey=0,this.addListener()}return t.getInstance=function(){return null==t.instance&&(t.instance=new t),t.instance},t.prototype.addListener=function(){lz.GameDispatcher.getInstance().addEventListener(String(EventManager.SC_HEART),this.updateServerTimer,this)},t.prototype.starHeartBeat=function(){this._timerKey=lz.TimerManager.getInstance().registerTimer(this.sendHertBeatHandler,this,3e4)},t.prototype.sendHertBeatHandler=function(){var t={};GameSocket.getInstance().send(EventManager.CS_HEART,t,!1)},t.prototype.updateServerTimer=function(t){0==t.data.code&&(lz.ServerTime.time=Math.ceil(t.data.servertime/1e3)),lz.Facade.sendNotification(GameEvent.NET_DELAY_CHANGE)},t.prototype.closeHeartBeat=function(){lz.TimerManager.getInstance().removeTimer(this._timerKey)},t}();__reflect(ServerController.prototype,"ServerController");var EventManager=function(){function t(){}return t.getInstance=function(){return null==t.instance&&(t.instance=new t),t.instance},t.CS_HEART=100,t.SC_HEART=101,t.CS_LOGIN=1001,t.SC_LOGIN=1002,t.CS_MODIFY_USER_DATA=1005,t.SC_MODIFY_USER_DATA=1006,t.CS_CHAT_LIST=2011,t.SC_CHAT_LIST=2012,t.CS_USER_ADD_CHAT=2013,t.SC_USER_ADD_CHAT=2014,t.SC_ADMIN_ADD_CHAT=2016,t.CS_BONUS_LIST=2021,t.SC_BONUS_LIST=2022,t.CS_COLLECT_BONUS=2023,t.SC_COLLECT_BONUS=2024,t.CS_COLLECT_LOGIN_BONUS=2031,t.SC_COLLECT_LOGIN_BONUS=2032,t.CS_TRANSACTION_LIST=2041,t.SC_TRANSACTION_LIST=2042,t.CS_ORDER_LIST=2051,t.SC_ORDER_LIST=2052,t.CS_ADD_ROOM=4003,t.SC_ADD_ROOM=4004,t.CS_QUIT_QUEUE=4005,t.SC_QUIT_QUEUE=4006,t.SC_UPDATE_ROOM=4008,t.SCMD_3000=3e3,t.SCMD_3002=3002,t.SCMD_3004=3004,t.CCMD_3005=3005,t.SCMD_3006=3006,t.CCMD_3007=3007,t.SCMD_3008=3008,t.CCMD_3011=3011,t.SCMD_3012=3012,t.CCMD_3021=3021,t.SCMD_3022=3022,t.CCMD_3023=3023,t.SCMD_3024=3024,t.CCMD_3025=3025,t.SCMD_3026=3026,t.CCMD_3027=3027,t.SCMD_3028=3028,t.CCMD_3029=3029,t.SCMD_3030=3030,t.SCMD_3010=3010,t.CCMD_3013=3013,t.SCMD_3014=3014,t.SCMD_3016=3016,t.SCMD_3018=3018,t.SCMD_3020=3020,t.SCMD_3032=3032,t.SCMD_3034=3034,t.SCMD_3036=3036,t.SCMD_3038=3038,t.SCMD_3040=3040,t.CCMD_3049=3049,t.SCMD_3050=3050,t.SCMD_3052=3052,t.CS_RELOAD_GOLD=5001,t.SC_RELOAD_GOLD=5002,t.CS_ADD_PHONEPE_PAYMENT=5011,t.SC_ADD_PHONEPE_PAYMENT=5012,t.CS_CHECK_PHONEPE_PAYMENT=5013,t.SC_CHECK_PHONEPE_PAYMENT=5014,t.CS_CANCEL_PHONEPE_PAYMENT=5015,t.SC_CANCEL_PHONEPE_PAYMENT=5016,t.CS_ADD_AIRPAY_PAYMENT=5021,t.SC_ADD_AIRPAY_PAYMENT=5022,t.CS_CHECK_AIRPAY_PAYMENT=5023,t.SC_CHECK_AIRPAY_PAYMENT=5024,t.CS_CANCEL_AIRPAY_PAYMENT=5025,t.SC_CANCEL_AIRPAY_PAYMENT=5026,t.SCMD_6000=6e3,t}();__reflect(EventManager.prototype,"EventManager");var GameFactory=function(t){function e(){return t.call(this)||this}return __extends(e,t),e}(lz.BaseFactory);__reflect(GameFactory.prototype,"GameFactory");var Global=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.start=function(e,i,n,a){void 0===i&&(i=egret.OrientationMode.PORTRAIT),void 0===n&&(n=0),void 0===a&&(a=!1),t.start.call(this,e,i,n,a),GameController.getInstance(),BattleController.getInstance(),ServerController.getInstance(),LoginController.getInstance(),lz.Alert.setSkin("AlertSkin"),lz.Wait.setSkin("LoadingSkin")},e}(lz.GameGlobal);__reflect(Global.prototype,"Global");var PoolGlobal=function(){function t(){this.imgPool=new lz.ObjPool,this.uiLabelPool=new lz.ObjPool}return t.getInstance=function(){return null==t.instance&&(t.instance=new t),t.instance},t}();__reflect(PoolGlobal.prototype,"PoolGlobal");var Log=function(){function t(){}return t.out=function(t,e){lz.GameConfig.debug&&console.warn("["+egret.getQualifiedClassName(t)+"] "+e)},t}();__reflect(Log.prototype,"Log");var Utils=function(){function t(){}return t.timestampToDate=function(t){var e=new Date(t),i=e.getFullYear(),n=e.getMonth()+1<10?"0"+(e.getMonth()+1):e.getMonth()+1,a=e.getDate()<10?"0"+e.getDate():e.getDate(),s=e.getHours()<10?"0"+e.getHours():e.getHours(),o=e.getMinutes()<10?"0"+e.getMinutes():e.getMinutes(),r=e.getSeconds()<10?"0"+e.getSeconds():e.getSeconds(),h=i+"-"+n+"-"+a+"   "+s+":"+o+":"+r;return h},t.getCash=function(t){var e="";return e=t>=1e8?(t/1e8).toFixed(1)+"L":t>=1e5?(t/1e4).toFixed(1)+"W":t+"","₹ "+e},t.getMoney=function(t){var e="";return e=t>=1e8?(t/1e8).toFixed(1)+"L":t>=1e5?(t/1e4).toFixed(1)+"W":t+""},t.spliteName=function(t,e){return void 0===e&&(e=10),t.length<=e?t:t.slice(0,e)+".."},t.showAlert=function(t,e,i,n){void 0===i&&(i=null),void 0===n&&(n=lz.AlertType.Ok);var a=LanguageConfig.getTxtByTag(t),s=LanguageConfig.getTxtByTag(e);lz.Alert.show(a,s,i,n)},t.showTextAlert=function(t,e,i,n){void 0===i&&(i=null),void 0===n&&(n=lz.AlertType.Ok),lz.Alert.show(t,e,i,n)},t.showMessageBox=function(t){var e=LanguageConfig.getTxtByTag(t);lz.MessageBox.show(e,0,3e3,30)},t.showMessageBox2=function(t){lz.MessageBox.show(t,0,3e3,30)},t}();__reflect(Utils.prototype,"Utils");var GameEvent=function(){function t(){}return t.NET_DELAY_CHANGE="GameEvent_Delay_Change",t.GAME_VERSION="GameEvent_Game_Version",t.REFRESH_TOKEN="GameEvent_Refresh_Token",t.UPDATA_ROOMINFO="GameEvent_Update_Room_Info",t.UPDATA_PLAYER_STATE="GameEvent_Update_Player_State",t.UPDATA_LOGIN_BONUS="GameEvent_Update_Login_Bonus",t.START_COUNT_DOWN="GameEvent_Start_Count_Down",t.UPDATA_CARDLIST="GameEvent_Updata_Card_list",t.UPDATA_SHOW_TOSS="GameEvent_Show_Toss",t.ME_DROP_GAME="GameEvent_Me_Drop_Game",t.OPEN_RESULT="GameEvent_Open_Result",t.UPDATE_BATTLE="GameEvent_Update_Battle",t.KICK_FROM_BATTLE="GameEvent_Kick_From_Battle",t.CLOSE_BATTLE="GameEvent_Close_Battle",t.GAME_TURN="GameEvent_Game_Turn",t.DRAW_POKER="GameEvent_Draw_Poker",t.PLAY_POKER="GameEvent_Play_Poker",t.FINISH_POKER="GameEvent_Finish_Poker",t.ERROR_DECLARE="GameEvent_Error_Declare",t.FINISH_DECLARE="GameEvent_Finish_Declare",t.DRAW_POKER_NOTIFICATION="GameEvent_DRAW_POKER_NOTIFICATION",t.PLAY_POKER_NOTIFICATION="GameEvent_PLAY_POKER_NOTIFICATION",t.FINISH_POKER_NOTIFICATION="GameEvent_FINISH_POKER_NOTIFICATION",t.ERROR_DECLARE_NOTIFICATION="GameEvent_ERROR_DECLARE_NOTIFICATION",t.FINISH_DECLARE_NOTIFICATION="GameEvent_FINISH_DECLARE_NOTIFICATION",t.LEAVE_ROOM="GameEvent_Leave_Room",t.UPDATE_PLAYER_MONEY="GameEvent_UPDATE_PLAYER_GOLD",t.UPDATA_PLAYERDATA="GameEvent_UPDATA_PLAYERDATA",t.UPDATE_USER_CHAT="GameEvent_Update_User_Chat",t.UPDATE_USER_DATA="GameEvent_Update_User_Data",t.UPDATE_TRANSACTION="GameEvent_Transaction",t.OPEN_MENU="GameEvent_Open_Menu",t.OPEN_SHARE="GameEvent_Open_Share",t.OPEN_BONUS="GameEvent_Open_Bonus",t.OPEN_CONTACT="GameEvent_Open_Contact",t.GAME_OVER="GameEvent_Game_Over",t.UPDATE_ORDER="GameEvent_Order",t.UPDATE_BONUS="GameEvent_Bonus",t.UPDATE_CONTACT="GameEvent_Contact",t.ANDROID_TEST="GameEvent_Android_Test",t.RENEW_GAME="RENEW_GAME",t}();__reflect(GameEvent.prototype,"GameEvent");var WaitEvent=function(){function t(){}return t.WAIT_SOCKET_CONNECT="SOCKET_CONNECT",t.WAIT_MOBILE_LOGIN="MOBILE_LOGIN",t.WAIT_TOURIST_LOGIN="TOURIST_LOGIN",t.WAIT_FACEBOOK_LOGIN="FACEBOOK_LOGIN",t.WAIT_GOOGLE_LOGIN="GOOGLE_LOGIN",t.WAIT_DELETE_FACEBOOK="DELETE_FACEBOOK",t.WAIT_BIND_FACEBOOK="BIND_FACEBOOK",t.WAIT_BIND_GOOGLE="BIND_GOOGLE",t.WAIT_GAME_VERSION="GAME_VERSION",t.WAIT_ANDROID_FACEBOOK_LOGIN="ANDROID_FACEBOOK_LOGIN",t.WAIT_ANDROID_GOOGLE_LOGIN="ANDROID_GOOGLE_LOGIN",t.WAIT_ANDROID_SHARE_APP="ANDROID_SHARE_APP",t.WAIT_ANDROID_CONTACT_LIST="ANDROID_CONTACT_LIST",t}();__reflect(WaitEvent.prototype,"WaitEvent");var DataCenter=function(){function t(){}return t.prototype.init=function(){this.player=new PlayerModel,this.game=new GameModel,this.battle=new BattleModel,this.app=new AppModel},t.getInstance=function(){return null==t._instance&&(t._instance=new t,t._instance.init()),t._instance},t}();__reflect(DataCenter.prototype,"DataCenter");var AppModel=function(){function t(){this.referrer="",this.channelCode=0,this.deviceId="",this.gameVersion=""}return t.prototype.serverInit=function(t){this.socketInfo=t.server,this.socketInfo.host&&lz.GameConfig.modifyConfig("httpGameUrl",this.socketInfo.host)},t.prototype.appInit=function(t){this.referrer=t.referrer,this.channelCode=t.channel_code,this.deviceId=t.device_id,this.upiList=t.upi_list,this.gameVersion=t.game_version,console.log("deviceId="+this.deviceId),console.log("channelCode="+this.channelCode)},t.prototype.uuid=function(){var t=Date.parse((new Date).toString())/1e3,e=String(t),i=Math.random().toString(36).replace(/[^a-z]+/g,"").toUpperCase().substr(0,4);return i+=e.substr(1,e.length)},t}();__reflect(AppModel.prototype,"AppModel");var BATTLE_STATE;!function(t){t[t.WAITING=0]="WAITING",t[t.READY=1]="READY",t[t.RUNNING=2]="RUNNING",t[t.FINISH=3]="FINISH",t[t.DECLARE=4]="DECLARE"}(BATTLE_STATE||(BATTLE_STATE={}));var BattleModel=function(){function t(){this.battleData=null,this.round=0,this.newCardId=-1,this.closeCardCount=0,this.startTime=0,this.tossTime=0,this.tossUserId=-1,this.overTime=0,this.resultData=null,this.curInfo=null,this._listChange=!1,this._battleState=-1,this.declareList={},this.recordData={},this.isTossPlayOver=!1,this.isDealPlayOver=!1,this.isWinPlayOver=!1,this.isLastGame=0,this.isPlayed=0}return t.prototype.newGame=function(){this.foldList=[],this._tossDic={},this.declareList={},this.isTossPlayOver=!1,this.isDealPlayOver=!1,this.isWinPlayOver=!1,this.isLastGame=0},t.prototype.changeLastGame=function(){0==this.isLastGame?this.isLastGame=1:this.isLastGame=0},t.prototype.initJokerCard=function(t){this.wildJokerData=new CardData,this.wildJokerData.init(t,t[1])},t.prototype.initTossList=function(t,e){this._tossDic={};for(var i=0;i<t.length;i++){var n=t[i],a=new CardData;a.init(n.tossdata,-1),this._tossDic[n.userid]=a}lz.Facade.sendNotification(GameEvent.UPDATA_SHOW_TOSS,{cardList:e})},t.prototype.getCardGroupList=function(){return this._cardData},t.prototype.initRecordList=function(t){this.recordData=t.recorddata},t.prototype.getDropLosePoint=function(t){return this.round<=t?20:40},t.prototype.initCardList=function(t,e,i){if(void 0===e&&(e=!1),void 0===i&&(i=!0),this._cardData=[],this._cardDic={},this.cardList=[],t){for(var n=0;n<t.length;n++){var a=new GroupData;a.initGroupData(n,t[n],this.wildJokerData.num),this._cardData.push(a);for(var s=0;s<a.cardList.length;s++)this.cardList.push(a.cardList[s])}this._listChange=!0,this.newCardId=-1,i&&lz.Facade.sendNotification(GameEvent.UPDATA_CARDLIST,{isShowAni:e})}},t.prototype.addFoldCard=function(t){if(t){var e=new CardData;e.init(t,this.wildJokerData.num),this.foldList.push(e)}},t.prototype.initFoldList=function(t){if(t){this.foldList=[];for(var e=0;e<t.length;e++)this.addFoldCard(t[e])}},t.prototype.initResultList=function(t){if(t){var e=t.round,i=t.mode,n=t.type,a=t.userid,s=t.battleinfo;a&&(this.declareList[a]=1),this.resultData||(this.resultData=new ResultData),this.resultData.initResultData(i,n,s,e),lz.Facade.sendNotification(GameEvent.OPEN_RESULT,{userid:a})}},Object.defineProperty(t.prototype,"battleState",{get:function(){return this._battleState},set:function(t){this._battleState!=t&&(this._battleState=t)},enumerable:!0,configurable:!0}),t}();__reflect(BattleModel.prototype,"BattleModel");var CARD_TYPE;!function(t){t[t.HEART=1]="HEART",t[t.SPADES=2]="SPADES",t[t.CLUB=3]="CLUB",t[t.DIAMOND=4]="DIAMOND",t[t.JOKER=5]="JOKER"}(CARD_TYPE||(CARD_TYPE={}));var CardData=function(){function t(){this.pos=0,this.groupIndex=-1,this.cardIndex=-1}return t.prototype.init=function(t,e){t&&(this.id=t[0],this.num=t[1],this.type=t[2],this.isJoker=this.num>13||this.num==e||0==e&&1==this.num)},t.prototype.updateGroupInfo=function(t,e){this.groupIndex=t,this.cardIndex=e},t}();__reflect(CardData.prototype,"CardData");var GROUP_TYPE;!function(t){t[t.NONE=0]="NONE",t[t.PURE=1]="PURE",t[t.SEQUENCE=2]="SEQUENCE",t[t.SET=3]="SET",t[t.JOKER=4]="JOKER"}(GROUP_TYPE||(GROUP_TYPE={}));var GroupData=function(){function t(){}return t.prototype.initGroupData=function(t,e,i){this.cardList=[],this.groupType=e.type,this.groupState=e.state,this.groupScore=e.score;for(var n=e.list,a=0;a<n.length;a++){var s=new CardData;s.init(n[a],i),s.updateGroupInfo(t,a),this.cardList.push(s)}},t.prototype.getCardViewWidth=function(){return 1==this.cardList.length?95:65*this.cardList.length+30},t}();__reflect(GroupData.prototype,"GroupData");var ResultData=function(){function t(){this.infoAry=[];for(var t=0;6>t;t++)this.infoAry.push(null)}return t.prototype.initResultData=function(t,e,i,n){this.round=n,this.mode=t,this.type=e;for(var a=0;a<this.infoAry.length;++a)this.infoAry[a]=null;for(var a=0;a<i.length;++a)this.infoAry[a]?this.infoAry[a].updateData(i[a]):(this.infoAry[a]=new ResultPlayer,this.infoAry[a].updateData(i[a]))},t}();__reflect(ResultData.prototype,"ResultData");var ResultPlayer=function(){function t(){this.userId=0,this.avatar="",this.name="",this.win=0,this.score=0,this.winvalue=0,this.playerState=PLAYER_STATE.NONE,this.groupAry=[],this.currentscore=0,this.disconnect=!1}return t.prototype.updateData=function(t){if(this.userId=t.userid,this.avatar=t.avatar,this.name=t.name,this.win=t.win,this.score=t.score,this.winvalue=t.winvalue,this.playerState=t.playerstate,this.currentscore=t.currentscore,t.pokerdata){this.groupAry=[];for(var e=t.pokerdata,i=0;i<e.length;i++){var n=new GroupData;n.initGroupData(i,e[i],-1),this.groupAry.push(n)}}else this.groupAry=[]},t}();__reflect(ResultPlayer.prototype,"ResultPlayer");var ROOM_TYPE;!function(t){t[t.POINT_RUMMY=1]="POINT_RUMMY",t[t.POOL_RUMMY=2]="POOL_RUMMY",t[t.DEAL_RUMMY=3]="DEAL_RUMMY"}(ROOM_TYPE||(ROOM_TYPE={}));var ROOM_MODE;!function(t){t[t.GOLD_MODE=1]="GOLD_MODE",t[t.CASH_MODE=2]="CASH_MODE",t[t.TOURNAMENTS_MODE=3]="TOURNAMENTS_MODE"}(ROOM_MODE||(ROOM_MODE={}));var TRANSACTION_TYPE;!function(t){t[t.TRANSACTION_TYPE_NONE=0]="TRANSACTION_TYPE_NONE",t[t.TRANSACTION_TYPE_GAME=1]="TRANSACTION_TYPE_GAME",t[t.TRANSACTION_TYPE_PAY_PHONEPE=10]="TRANSACTION_TYPE_PAY_PHONEPE",t[t.TRANSACTION_TYPE_PAY_AIRPAY=11]="TRANSACTION_TYPE_PAY_AIRPAY",t[t.TRANSACTION_TYPE_WITHDRAW=20]="TRANSACTION_TYPE_WITHDRAW",t[t.TRANSACTION_TYPE_INVITE_BONUS=30]="TRANSACTION_TYPE_INVITE_BONUS",t[t.TRANSACTION_TYPE_LOGIN_BONUS=31]="TRANSACTION_TYPE_LOGIN_BONUS"}(TRANSACTION_TYPE||(TRANSACTION_TYPE={}));var GAME_UPDATE_TYPE;!function(t){t[t.ROOM_PLAYER=0]="ROOM_PLAYER",t[t.PLAYER_STATE=1]="PLAYER_STATE"}(GAME_UPDATE_TYPE||(GAME_UPDATE_TYPE={}));var GameModel=function(){function t(){this.isResumeTime=!1,this._lock=!1,this.socketFirst=!0,this._player=DataCenter.getInstance().player,this._game=DataCenter.getInstance().game,this.access_token="",this.refresh_token="",this.isBattle=!1,this.goldRummyConfig=[],this.pointRummyConfig=[],this.poolRummyConfig=[],this.dealRummyConfig=[],this.chatList=[],this.transactionList=[],this.transactionPage=0,this.orderList=[],this.orderPage=0,this.bonusList=[],this.bonusPage=0,this.smsTime=0,this.contactList=[],this.paymentCount=0,this.loginBonusDay=0,this.loginBonusTime=0,this.type=ROOM_TYPE.POINT_RUMMY,this.mode=ROOM_MODE.CASH_MODE}return t.prototype.resumeStartTime=function(){var t=this;this.isResumeTime=!0,clearTimeout(this.resumeTimeout),this.resumeTimeout=setTimeout(function(){t.isResumeTime=!1},5)},t.prototype.btnLock=function(t){var e=this;return void 0===t&&(t=1e3),this._lock?(Utils.showMessageBox2("Too fast"),!0):(this._lock=!0,setTimeout(function(){e._lock=!1},t),!1)},t.prototype.initLocalData=function(){void 0==lz.LocalDataManager.getValue("soundOpen")||null==lz.LocalDataManager.getValue("soundOpen")?(this.soundOpen=1,lz.LocalDataManager.setValue("soundOpen",this.soundOpen)):this.soundOpen=lz.LocalDataManager.getValue("soundOpen"),void 0==lz.LocalDataManager.getValue("vibrationOpen")||null==lz.LocalDataManager.getValue("vibrationOpen")?(this.vibrationOpen=1,lz.LocalDataManager.setValue("vibrationOpen",this.vibrationOpen)):this.vibrationOpen=lz.LocalDataManager.getValue("vibrationOpen"),void 0==lz.LocalDataManager.getValue("battleTipOpen")||null==lz.LocalDataManager.getValue("battleTipOpen")?(this.battleTipOpen=1,lz.LocalDataManager.setValue("battleTipOpen",this.battleTipOpen)):this.battleTipOpen=lz.LocalDataManager.getValue("battleTipOpen"),void 0==lz.LocalDataManager.getValue("notificationOpen")||null==lz.LocalDataManager.getValue("notificationOpen")?(this.notificationOpen=1,lz.LocalDataManager.setValue("notificationOpen",this.notificationOpen)):this.notificationOpen=lz.LocalDataManager.getValue("notificationOpen"),void 0==lz.LocalDataManager.getValue("smsTime")||null==lz.LocalDataManager.getValue("smsTime")?(this.smsTime=0,lz.LocalDataManager.setValue("smsTime",0)):this.smsTime=lz.LocalDataManager.getValue("smsTime"),SoundManager.soundSwitch=this.soundOpen>0?!0:!1},t.prototype.changeSoundOpen=function(){1==this.soundOpen?this.soundOpen=0:this.soundOpen=1,lz.LocalDataManager.setValue("soundOpen",this.soundOpen),SoundManager.soundSwitch=this.soundOpen>0?!0:!1},t.prototype.changeVibrationOpen=function(){1==this.vibrationOpen?this.vibrationOpen=0:this.vibrationOpen=1,lz.LocalDataManager.setValue("vibrationOpen",this.vibrationOpen)},t.prototype.changeBattleTipOpen=function(){1==this.battleTipOpen?this.battleTipOpen=0:this.battleTipOpen=1,lz.LocalDataManager.setValue("battleTipOpen",this.battleTipOpen)},t.prototype.changeNotificationOpen=function(){1==this.notificationOpen?this.notificationOpen=0:this.notificationOpen=1,lz.LocalDataManager.setValue("notificationOpen",this.notificationOpen)},t.prototype.saveSmsTime=function(){this.smsTime=(new Date).getTime()+6e4,lz.LocalDataManager.setValue("smsTime",this.smsTime)},t.prototype.initRoomConfig=function(t){this.goldRummyConfig=t.gold_game_entryfee,this.pointRummyConfig=t.point_rummy_entryfee,this.poolRummyConfig=t.pool_rummy_entryfee,this.dealRummyConfig=t.deal_rummy_entryfee},t.prototype.initChatList=function(t){this.chatList=[];for(var e=0;e<t.length;e++){var i=JSON.parse(t[e]);this.chatList.push(i)}if(t.length<=50){var n={type:2,text:"Ask me questions when you encounter problems in the game",index:0};this.chatList.unshift(n)}},t.prototype.addChat=function(t){this.chatList.push(t)},t.prototype.addChatList=function(t){if(t&&t.length>0)for(var e=0;e<t.length;e++){var i=JSON.parse(t[e]);this.chatList.push(i)}},t.prototype.getChatCurrentIndex=function(){if(this.chatList.length>0){var t=this.chatList[this.chatList.length-1];return t.index}return 0},t.prototype.getGameConfig=function(t,e){if(1==t)return this.goldRummyConfig;if(2==t){if(1==e)return this.pointRummyConfig;if(2==e)return this.poolRummyConfig;if(3==e)return this.dealRummyConfig}return null},t.prototype.updateRoomInfo=function(t){t&&(this.currentRoom||(this.currentRoom=new RoomData),this.currentRoom.init(t))},t.prototype.updatePlayerState=function(t,e,i){this.currentRoom&&this.currentRoom.updatePlayerState(t,e,i)},t.prototype.updatePlayerScore=function(t){this.currentRoom&&this.currentRoom.updatePlayerScore(t)},t.prototype.updateTransactionList=function(t,e){1==e&&(this.transactionList=[]);for(var i=0;i<t.length;i++){var n=new TransactionData(t[i],i);this.transactionList.push(n)}this.transactionPage=e},t.prototype.updateOrderList=function(t,e){1==e&&(this.orderList=[]);for(var i=0;i<t.length;i++){var n=new OrderData(t[i],i);this.orderList.push(n)}this.orderPage=e},t.prototype.updateBonusList=function(t,e){1==e&&(this.bonusList=[]);for(var i=0;i<t.length;i++){var n=new BonusData(t[i],i);this.bonusList.push(n)}this.bonusPage=e},t.prototype.updateBonusItem=function(t){for(var e=0;e<this.bonusList.length;e++){var i=this.bonusList[e];if(i.getBonusId()==t.id)return void i.updateBonusData(t)}},t.prototype.updateContactList=function(t){this.contactList=[];for(var e=0;e<t.length;e++){var i=new ContactData(t[e],e);this.contactList.push(i)}},t.prototype.isShowWithdraw=function(){return!1},t.gamePing=0,t}();__reflect(GameModel.prototype,"GameModel");var BonusData=function(){function t(t,e){this.id=t.id,this.index=e,this.name=t.nickname,this.amount=t.amount,this.bonus=t.bonus,this.collect=t.collect;var i=new Date(t.created_at);this.date=i.getFullYear()+"-"+i.getMonth()+"-"+i.getDate()+" "+i.getHours()+":"+i.getMinutes()+":"+i.getSeconds()}return t.prototype.updateBonusData=function(t){this.collect=t.collect},t.prototype.getBonusId=function(){return this.id},t}();__reflect(BonusData.prototype,"BonusData");var ContactData=function(){function t(t,e){this.index=e,this.name=t.name,this.phone=t.phone}return t}();__reflect(ContactData.prototype,"ContactData");var LocationData=function(){function t(t,e){this.index=e,this.location=t}return t}();__reflect(LocationData.prototype,"LocationData");var OrderData=function(){function t(t,e){this.index=e,this.merchantTransactionId=t.merchantTransactionId,this.amount=t.amount,this.state=t.state;var i=new Date(t.created_at);this.date=i.getFullYear()+"-"+i.getMonth()+"-"+i.getDate()+" "+i.getHours()+":"+i.getMinutes()+":"+i.getSeconds()}return t}();__reflect(OrderData.prototype,"OrderData");var RoomData=function(){function t(){this.finishDeal=0,this.totalDeal=0,this._meModel=null,this._playerDic={},this._meModel=DataCenter.getInstance().player}return t.prototype.init=function(t){t&&(this.roomId=t.roomid,this.finishDeal=t.finishdeal,this.totalDeal=t.totaldeal,this.configId=t.roomconfig.id,this.name=t.roomconfig.name,this.mode=t.roomconfig.mode,this.type=t.roomconfig.type,this.level=t.roomconfig.level,this.decks=t.roomconfig.decks,this.seats=t.roomconfig.seats,this.mode==ROOM_MODE.CASH_MODE?this.entry_fee=t.roomconfig.entry_fee:this.entry_fee=t.roomconfig.entry_fee,this.point_value=this.entry_fee/80,this.initPlayer(t.playerdata),this.playerCount=this.playerList.length)},t.prototype.initPlayer=function(t){if(this.playerList=[],this._playerDic={},t)for(var e=0;e<t.length;e++){var i=new PlayerInfo;i.init(t[e]),this._meModel.userId==i.id&&(this._meModel.info.playerState=t[e].playerstate),this.playerList.push(i),this._playerDic[i.id]=i}},t.prototype.getPlayerById=function(t){return this._playerDic[t]},t.prototype.getPlayerByIdx=function(t){for(var e in this._playerDic){var i=this._playerDic[e];if(i.idx==t)return i}return null},t.prototype.updatePlayerState=function(t,e,i){if(-1==t)for(var n=0;n<this.playerList.length;n++){var a=this.playerList[n];a&&(1==i?a.playerState!=PLAYER_STATE.DROP_GAME&&a.playerState!=PLAYER_STATE.AWAY&&(a.playerState=e,this._meModel.userId==a.id&&(this._meModel.info.playerState=e)):a.playerState=e)}else{var s=this.getPlayerById(t);s&&(s.playerState=e,this._meModel.userId==t&&(this._meModel.info.playerState=e))}},t.prototype.updatePlayerScore=function(t){for(var e=0;e<this.playerList.length;e++){var i=this.playerList[e];i&&t[i.id]&&(i.score=t[i.id])}},t}();__reflect(RoomData.prototype,"RoomData");var TransactionData=function(){function t(t,e){this.id=t.id,this.index=e,this.transaction_id=t.transaction_id,this.type=t.type,this.in_out=t.in_out,this.relation_id=t.relation_id,this.amount=t.amount,this.type==TRANSACTION_TYPE.TRANSACTION_TYPE_NONE&&(this.detail="Other transaction"),this.type==TRANSACTION_TYPE.TRANSACTION_TYPE_GAME&&(1==this.in_out&&(this.detail="Win a game and get bonus"),2==this.in_out&&(this.detail="Lose a game and deduct fee")),this.type==TRANSACTION_TYPE.TRANSACTION_TYPE_PAY_PHONEPE&&(this.detail="Pay to get money"),this.type==TRANSACTION_TYPE.TRANSACTION_TYPE_PAY_AIRPAY&&(this.detail="Pay to get money"),this.type==TRANSACTION_TYPE.TRANSACTION_TYPE_WITHDRAW&&(this.detail="Cash withdrawal"),this.type==TRANSACTION_TYPE.TRANSACTION_TYPE_INVITE_BONUS&&(this.detail="Invite friends to get bonus"),this.type==TRANSACTION_TYPE.TRANSACTION_TYPE_LOGIN_BONUS&&(this.detail="Get Sign up bonus"),1==this.in_out&&(this.inOut="In"),1==this.in_out&&(this.inOut="Out"),this.date=Utils.timestampToDate(t.created_at)}return t}();__reflect(TransactionData.prototype,"TransactionData");var PLAYER_STATE;!function(t){t[t.NONE=0]="NONE",t[t.MATCHING=1]="MATCHING",t[t.GAME_WAITING=2]="GAME_WAITING",t[t.DRAWING=3]="DRAWING",t[t.DISCARDING=4]="DISCARDING",t[t.DECLARING=5]="DECLARING",t[t.DROP_GAME=6]="DROP_GAME",t[t.AWAY=7]="AWAY",t[t.ERROR_DECLARE=8]="ERROR_DECLARE",t[t.ELIMINATE=9]="ELIMINATE",t[t.COMPLETE=10]="COMPLETE"}(PLAYER_STATE||(PLAYER_STATE={}));var PlayerModel=function(){function t(){this.info=new PlayerInfo}return t.prototype.updateUserData=function(t){t&&(this.info.init(t),this.userId=this.info.id,this.mobile=t.mobile,this.email=t.email,this.fb_id=t.fb_id,this.google_id=t.google_id,this.mobile=t.mobile,this.email=t.email)},t.prototype.updateUserMobile=function(t){this.mobile=t},t.prototype.updatePlayerGoldCash=function(t,e,i){this.info&&(this.info.gold=t,this.info.cash=e,this.info.cash_reward=i)},t}();__reflect(PlayerModel.prototype,"PlayerModel");var PlayerInfo=function(){function t(){this.isDeclare=!1,this.isReady=!0,this.dp_EndTime=0,this.dp_BonusTime=0,this.playerState=0,this.isUpdate=!1,this.disconnect=!1,this.score=0,this._gold=0,this._cash=0,this._cash_reward=0,this._score=0}return t.prototype.init=function(t){t&&(this.id=t.userid,this.idx=t.roomindex,this.name=t.username,this.gold=t.gold,this.cash=t.cash,this.cash_reward=t.cash_reward,this.avatar="game_json.avatar_"+t.avatar,this.playerState=t.playerstate,this.disconnect=t.disconnect)},t.prototype.updateNameAvatar=function(t){this.name=t.username,this.avatar="game_json.avatar_"+t.avatar},Object.defineProperty(t.prototype,"gold",{get:function(){return this._gold},set:function(t){this._gold!=t&&(this._gold=t,this.isMe&&(this.isUpdate=!0,lz.Facade.sendNotification(GameEvent.UPDATE_PLAYER_MONEY)))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cash",{get:function(){var t=(this._cash+this._cash_reward)/100;return t},set:function(t){this._cash!=t&&(this._cash=t,this.isMe&&(this.isUpdate=!0,lz.Facade.sendNotification(GameEvent.UPDATE_PLAYER_MONEY)))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cash_user",{get:function(){return this._cash/100},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cash_reward",{get:function(){return this._cash_reward/100},set:function(t){this._cash_reward!=t&&(this._cash_reward=t,this.isMe&&(this.isUpdate=!0,lz.Facade.sendNotification(GameEvent.UPDATE_PLAYER_MONEY)))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isMe",{get:function(){return this.id==DataCenter.getInstance().player.userId},enumerable:!0,configurable:!0}),t}();__reflect(PlayerInfo.prototype,"PlayerInfo");var AndroidManager=function(){function t(){this._app=DataCenter.getInstance().app,this._game=DataCenter.getInstance().game,this._battle=DataCenter.getInstance().battle}return t.getInstance=function(){return null==t.instance&&(t.instance=new t),t.instance},t.prototype.init=function(){console.log("gameLog    注册了监听安卓的消息~~~~~~~~~~~~~"),egret.ExternalInterface.addCallback("sendToJS",this.postAndroidEvent),this.getAppInfo()},t.prototype.postAndroidEvent=function(e){console.log("Android data = "+e);var i=JSON.parse(e);if("app_info"==i.name&&(DataCenter.getInstance().app.appInit(i),LoginController.getInstance().autoLogin()),"contact_list"==i.name&&(lz.Wait.hide(),console.log("gameLog    本次安卓回调请求ContactList  ==  ",i),i.data&&(DataCenter.getInstance().game.updateContactList(i.data),lz.Facade.sendNotification(GameEvent.UPDATE_CONTACT))),"fb_login_success"==i.name&&(lz.Wait.hide(),console.log("gameLog    本次安卓回调请求FB登录  ==  ",i),i.type&&1==i.type?LoginController.getInstance().bindFacebook(i.fb_id):LoginController.getInstance().faceBookLogin(i.fb_id)),"google_login_success"==i.name&&(lz.Wait.hide(),console.log("gameLog    本次安卓回调请求google登录  ==  ",i),i.type&&1==i.type?LoginController.getInstance().bindGoogle(i.google_id):LoginController.getInstance().googleLogin(i.google_id)),"phonepe_pay_result"==i.name){console.log("gameLog    phonepe_pay_result  ==  ");var n=i.Status;if("SUCCESS"==n&&i.txnRef){var a=i.txnRef;GameController.getInstance().checkPhonePEPayment(a)}}if("airpay_pay_result"==i.name&&(console.log("gameLog    airpay_pay_result  ==  "),i.airpay_result)){var s=i.airpay_result,o=s.TRANSACTIONID;o&&o.length>0?GameController.getInstance().checkAirpayPayment(o):Utils.showMessageBox(LanguageConfig.PAY_ERROR)}"share_access"==i.name&&lz.Wait.hide(),"resume"==i.name&&(lz.Wait.hide(),DataCenter.getInstance().game.resumeStartTime(),(DataCenter.getInstance().game.isBattle||lz.GameGlobal.gameType==GameViewType.Battle)&&BattleController.getInstance().updateBattle(),t.getInstance().trackEvent("resume","page",String(lz.GameGlobal.gameType))),"android_test"==i.name&&(console.log("gameLog    android_test  ==  "+JSON.stringify(e)),lz.Facade.sendNotification(GameEvent.ANDROID_TEST,{data:i}))},t.prototype.fb_login=function(t){lz.Wait.show(WaitEvent.WAIT_ANDROID_FACEBOOK_LOGIN);var e={name:"fb_login",type:t};console.log(e,"准备调用fb登录~~~~~~"),egret.ExternalInterface.call("sendToNative",JSON.stringify(e))},t.prototype.google_login=function(t){lz.Wait.show(WaitEvent.WAIT_ANDROID_GOOGLE_LOGIN);var e={name:"google_login",type:t};console.log(e,"准备调用google登录~~~~~~"),egret.ExternalInterface.call("sendToNative",JSON.stringify(e))},t.prototype.getAppInfo=function(){var t={name:"app_info"};console.log("gameLog    申请代理数据  ==  ",JSON.stringify(t)),egret.ExternalInterface.call("sendToNative",JSON.stringify(t))},t.prototype.payWithPhonePe=function(t,e,i,n,a,s){var o={name:"pay_phonepe",user_id:t,merchant_transaction_id:e,amount:i,callback_url:n,pay_type:a,pay_data:s};console.log("gameLog    申请代理数据  ==  ",JSON.stringify(o)),egret.ExternalInterface.call("sendToNative",JSON.stringify(o))
},t.prototype.payWithAirpay=function(t,e,i,n,a){var s={name:"pay_airpay",user_id:t,merchant_transaction_id:e,amount:i,successUrl:n,failureUrl:a};console.log("gameLog    申请代理数据  ==  ",JSON.stringify(s)),egret.ExternalInterface.call("sendToNative",JSON.stringify(s))},t.prototype.shareApp=function(t,e){lz.Wait.show(WaitEvent.WAIT_ANDROID_SHARE_APP),console.log("SHOW");var i={name:t,user_id:e};egret.ExternalInterface.call("sendToNative",JSON.stringify(i))},t.prototype.getContactList=function(){lz.Wait.show(WaitEvent.WAIT_ANDROID_CONTACT_LIST);var t={name:"contact_list"};egret.ExternalInterface.call("sendToNative",JSON.stringify(t))},t.prototype.trackEvent=function(t,e,i){console.log("track_event="+t);var n={name:"track_event",event_name:t,event_key:e,event_value:i};egret.ExternalInterface.call("sendToNative",JSON.stringify(n))},t.prototype.showAndroidTest=function(){var t={name:"android_test"};console.log("gameLog    android_test  ==  ",JSON.stringify(t)),egret.ExternalInterface.call("sendToNative",JSON.stringify(t))},t.prototype.vibrateMobile=function(){if(DataCenter.getInstance().game.vibrationOpen){var t={name:"vibrate"};egret.ExternalInterface.call("sendToNative",JSON.stringify(t))}},t}();__reflect(AndroidManager.prototype,"AndroidManager");var GameDispatcher=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.getInstance=function(){return null==e.instance&&(e.instance=new e),e.instance},e}(egret.EventDispatcher);__reflect(GameDispatcher.prototype,"GameDispatcher");var NET_STATE;!function(t){t[t.NULL=0]="NULL",t[t.CONNECTING=1]="CONNECTING",t[t.CONNECTED=2]="CONNECTED",t[t.DISCONNECT=3]="DISCONNECT",t[t.ERROR=4]="ERROR"}(NET_STATE||(NET_STATE={}));var GameSocket=function(){function t(){this._netState=NET_STATE.NULL,this._key="C3C7975FAA7C1885570D4D8C7441E5F8",this._url="",this._port=0,this._msgTemplate={},this._time=0,this._index=0}return t.getInstance=function(){return null==t.instance&&(t.instance=new t),t.instance},t.prototype.init=function(t,e,i){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(n){return this._url=t,this._port=e,this._msgTemplate=i,this.netState=NET_STATE.NULL,this._socket=new egret.WebSocket,this._socket.type=egret.WebSocket.TYPE_STRING,this._socket.addEventListener(egret.ProgressEvent.SOCKET_DATA,this.onReceiveMessage,this),this._socket.addEventListener(egret.Event.CLOSE,this.onSocketClose,this),this._socket.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onSocketError,this),[2]})})},t.prototype.connect=function(){return __awaiter(this,void 0,void 0,function(){var t,e,i;return __generator(this,function(n){return this.netState=NET_STATE.CONNECTING,t=this._socket,e=this,i=new Promise(function(i,n){var a=this;0!=e._port?t.connect(e._url,e._port):t.connectByUrl(e._url),t.addEventListener(egret.Event.CONNECT,function(t){lz.Log.out(a,"socket connect success",t),e.netState=NET_STATE.CONNECTED,i(t)},this),t.addEventListener(egret.IOErrorEvent.IO_ERROR,function(t){lz.Log.out(a,"socket connect failue",t),e.netState=NET_STATE.DISCONNECT,n(t)},this)}),[2,i.then(function(t){return!0})["catch"](function(t){return lz.Log.out(this,t),!1})]})})},Object.defineProperty(t.prototype,"netState",{get:function(){return this._netState},set:function(t){this._netState!=t&&(this._netState=t,lz.GameDispatcher.getInstance().dispatchEventWith(lz.SocketEvent.SOCKET_STATE_CHANGE))},enumerable:!0,configurable:!0}),t.prototype.send=function(t,e,i){return __awaiter(this,void 0,void 0,function(){var i,n;return __generator(this,function(a){return this._index++,0==this._socket.connected?[2,[2,!1]]:(this._msgTemplate&&(i=this._msgTemplate),i.msgid=t,i.data=e,i.index=this._index,n=JSON.stringify(i),lz.GameConfig.debug&&t!=EventManager.CS_HEART&&console.log("socket发送数据，id="+t,e),this._socket.writeUTF(JSON.stringify(i)),this._socket.flush(),this._time=(new Date).getTime(),[2])})})},t.prototype.close=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return this._socket.close(),[2]})})},t.prototype.onReceiveMessage=function(t){var e=this._socket.readUTF(),i=JSON.parse(e);if(i.index&&i.index==this._index){var n=(new Date).getTime();GameModel.gamePing=n-this._time}lz.GameConfig.debug&&i.msgid!=EventManager.SC_HEART&&console.log("socket收到数据，id="+i.msgid,i);var a=i.msg;0!=i.code&&a&&a.length>0&&lz.MessageBox.show(a),lz.GameDispatcher.getInstance().dispatchEventWith(i.msgid,!1,i)},t.prototype.onSocketClose=function(t){lz.Log.out(this,"------socket已经关闭：",t),this.netState=NET_STATE.DISCONNECT},t.prototype.onSocketError=function(t){lz.Log.out(this,"------socket报IO错误：",t),this.netState=NET_STATE.ERROR},t}();__reflect(GameSocket.prototype,"GameSocket");var SERVER;!function(t){t[t.LOGIN_SERVER=0]="LOGIN_SERVER",t[t.GAME_SERVER=1]="GAME_SERVER"}(SERVER||(SERVER={}));var HttpRequest=function(){function t(){}return t.getInstance=function(){return null==t.instance&&(t.instance=new t),t.instance},t.prototype.getURLParam=function(t){for(var e="?",i=0,n=Object.keys(t);i<n.length;i++){var a=n[i];e+="?"===e?a+"="+t[a]:"&"+a+"="+t[a]}return e},t.prototype.post1=function(t,e){var i=new egret.HttpRequest;i.responseType=egret.HttpResponseType.TEXT;var n=lz.GameConfig.httpURL+t;i.open(n,egret.HttpMethod.POST),i.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),i.send(),i.addEventListener(egret.Event.COMPLETE,this.onPostComplete,this),i.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onPostIOError,this),i.addEventListener(egret.ProgressEvent.PROGRESS,this.onPostProgress,this)},t.prototype.onPostComplete=function(t){var e=t.currentTarget;lz.GameConfig.debug&&console.log("gameLog    post data : ",e.response)},t.prototype.onPostIOError=function(t){lz.GameConfig.debug&&console.log("gameLog    post error : "+t)},t.prototype.onPostProgress=function(t){lz.GameConfig.debug&&console.log("gameLog    post progress : "+Math.floor(100*t.bytesLoaded/t.bytesTotal)+"%")},t.prototype.post=function(t,e,i,n){return void 0===n&&(n=null),__awaiter(this,void 0,void 0,function(){var a,s,o,r;return __generator(this,function(h){return a=new egret.HttpRequest,a.responseType=egret.HttpResponseType.TEXT,s="",s=t==SERVER.LOGIN_SERVER?lz.GameConfig.httpURL+e:lz.GameConfig.httpGameUrl+e,lz.GameConfig.debug&&console.log("Http请求URL=",s),a.open(s,egret.HttpMethod.POST),a.setRequestHeader("Content-Type","application/json"),null!=n&&a.setRequestHeader("token",n),o=JSON.stringify(i),lz.GameConfig.debug&&console.log("Http参数=",i),r=new Promise(function(t,i){var n=this;a.send(o),a.addEventListener(egret.Event.COMPLETE,function(i){var a,s=i.currentTarget.response;s&&s.length?a=JSON.parse(i.currentTarget.response):(a.code=-1,a.msg="--- Protocol returns to null ---",Log.out(n,e+" Protocol returns to null ")),t(a)},this),a.addEventListener(egret.IOErrorEvent.IO_ERROR,function(t){var e={};e.code=-1,i(JSON.stringify(e))},this)}),[2,r.then(function(t){return lz.GameConfig.debug&&console.log("http返回=",t),t})["catch"](function(t){return t})]})})},t.prototype.get=function(t,e){return void 0===e&&(e=null),__awaiter(this,void 0,void 0,function(){var i,n,a;return __generator(this,function(s){return i=new egret.HttpRequest,i.responseType=egret.HttpResponseType.TEXT,n=lz.GameConfig.httpURL+t,e&&(n=e+t),lz.GameConfig.debug&&console.log(n),i.open(n,egret.HttpMethod.GET),i.setRequestHeader("Content-Type","text/plain;charset=utf-8"),a=new Promise(function(t,e){i.send(),i.addEventListener(egret.Event.COMPLETE,function(e){t(e.currentTarget.response)},this),i.addEventListener(egret.IOErrorEvent.IO_ERROR,function(t){e(t)},this)}),[2,a.then(function(t){return t})["catch"](function(t){return t})]})})},t.prototype.postTest=function(t,e,i,n){return void 0===i&&(i=null),void 0===n&&(n=null),__awaiter(this,void 0,void 0,function(){var a,s,o,r;return __generator(this,function(h){return a=new egret.HttpRequest,a.responseType=egret.HttpResponseType.TEXT,s=lz.GameConfig.httpURL+t,i&&(s=t),lz.GameConfig.debug&&console.log("gameLog    http请求的网址  == ",s),a.open(s,egret.HttpMethod.POST),a.setRequestHeader("Content-Type","application/json"),a.setRequestHeader("token",n),o=JSON.stringify(e),lz.GameConfig.debug&&console.log("gameLog    urlParam----->"+o),r=new Promise(function(e,i){var n=this;a.send(o),a.addEventListener(egret.Event.COMPLETE,function(i){var a,s=i.currentTarget.response;s&&s.length?a=JSON.parse(i.currentTarget.response):(a.code=-1,a.msg="--- Protocol returns to null ---",Log.out(n,t+" Protocol returns to null ")),e(a)},this),a.addEventListener(egret.IOErrorEvent.IO_ERROR,function(t){var e={};e.code=-1,i(JSON.stringify(e))},this)}),[2,r.then(function(t){return t})["catch"](function(t){return t})]})})},t}();__reflect(HttpRequest.prototype,"HttpRequest");var NetEvent=function(t){function e(e,i,n){return void 0===i&&(i=!1),void 0===n&&(n=!1),t.call(this,e,i,n)||this}return __extends(e,t),e}(egret.Event);__reflect(NetEvent.prototype,"NetEvent");var SoundManager=function(){function t(){}return t.init=function(){this.callBackDic={}},t.onActive=function(){},t.onDeActive=function(){},t.insertBackground=function(e){var i=RES.getRes(e);null!=i?(this.pauseBackgroundMusic(),t.bgMusic=i,null!=t.bgMusic&&(t.bgMusicChannel=t.bgMusic.play(0,1),t.bgMusicChannel.once(egret.Event.SOUND_COMPLETE,t.insertComplete,t))):(RES.createGroup(e+"mp3",[e],!0),RES.loadGroup(e+"mp3"))},t.insertComplete=function(e){t.setBackground(t.bgMusicUrl)},t.setBackground=function(e,i){void 0===i&&(i=!1),(t.bgMusicUrl!=e||1==i)&&(t.bgMusicUrl=e,t.musicSwitch&&(RES.createGroup("backgroundSound",[e],!0),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,t.onResourceLoadComplete,this),RES.loadGroup("backgroundSound")))},t.onStage=function(t){},t.onResourceLoadComplete=function(e){"backgroundSound"==e.groupName&&(RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,t.onResourceLoadComplete,this),t.onStage(null),t.playBackgroundMusic())},t.pauseBackgroundMusic=function(){null!=t.bgMusicChannel&&(this.position=t.bgMusicChannel.position,t.bgMusicChannel.stop())},t.playBackgroundMusic=function(){t.musicSwitch&&t.bgMusicUrl&&(this.pauseBackgroundMusic(),t.bgMusic=RES.getRes(t.bgMusicUrl),t.bgMusic&&(t.bgMusicChannel=t.bgMusic.play()))},t.playSound=function(t,e,i){if(void 0===e&&(e=null),void 0===i&&(i=null),DataCenter.getInstance().game.soundOpen){var n=RES.getRes(t);if(null!=n){n.play(0,1)}else RES.createGroup(t+"mp3",[t],!0),RES.loadGroup(t+"mp3")}},t.effectPlayEnd=function(t){var e=t.target;if(e){e.removeEventListener(egret.Event.SOUND_COMPLETE,this.effectPlayEnd,this);var i=this.callBackDic[e.hashCode];if(i){var n=i.c,a=i.t;n&&a&&(n.call(a),delete this.callBackDic[e.hashCode])}e.stop(),e=null}},t.bgSoundValue="",t}();__reflect(SoundManager.prototype,"SoundManager");var GameViewType;!function(t){t[t.None=0]="None",t[t.AppLogin=1]="AppLogin",t[t.AppHome=2]="AppHome",t[t.AppPay=3]="AppPay",t[t.AppOrder=4]="AppOrder",t[t.AppSelectPay=5]="AppSelectPay",t[t.Battle=6]="Battle",t[t.Guild=7]="Guild",t[t.Over=8]="Over"}(GameViewType||(GameViewType={}));var GameView=function(t){function e(e){void 0===e&&(e=GameViewType.AppLogin);var i=t.call(this)||this;return i._classMap=[null,AppLoginView,AppHomeView,AppPayView,AppOrderView,AppSelectPayView,BattleView,BattleGuildView],i._forceArray=[],i._forceDic={},i._type=0,i._type=e,i}return __extends(e,t),Object.defineProperty(e.prototype,"resource",{get:function(){return""},enumerable:!0,configurable:!0}),e.prototype.notificationListeners=function(){return[lz.GameFrameEvent.OPEN_VIEW]},e.prototype.executeNotification=function(t,e,i){if(t==lz.GameFrameEvent.OPEN_VIEW){var n=e,a=!1,s=null,o=void 0,r=this._classMap[n];if(i&&(s=i,("open"==i.type||"open"==i.openType||"open"==i)&&(a=!0)),n!=lz.GameGlobal.gameType||a){if(lz.GameGlobal.gameType=n,this.grp_container.removeChildren(),n==GameViewType.Over)this.grp_ForceView.removeChildren(),this._forceDic={};else for(var h=0;h<this.grp_ForceView.numChildren;h++)this.grp_ForceView.getChildAt(h).hideSelf();if(this._forceArray.indexOf(n)>=0){if(null!=r){var l=this._forceDic[n];if(null==l){var c=new r;i&&(c.param=i),this._forceDic[n]=c,this.grp_ForceView.addChild(c)}else l.param=null,i&&(l.param=i),l.showSelf()}}else null!=r&&(o=new r,s&&(o.param=s),this.grp_container.addChild(o))}}},e.prototype.onAdded=function(e){t.prototype.onAdded.call(this,e)},e.prototype.loadComplete=function(){t.prototype.loadComplete.call(this)},e.prototype.onRemoved=function(e){t.prototype.onRemoved.call(this,e)},Object.defineProperty(e.prototype,"classMap",{set:function(t){this._classMap=t},enumerable:!0,configurable:!0}),e}(lz.GameViewCE);__reflect(GameView.prototype,"GameView");var TextInputView=function(t){function e(){var e=t.call(this)||this;return e.skinName="TextInputSkin",e}return __extends(e,t),e}(eui.Component);__reflect(TextInputView.prototype,"TextInputView");var CHANNEL;!function(t){t[t.WEB=0]="WEB",t[t.ANDROID=1]="ANDROID"}(CHANNEL||(CHANNEL={}));var SCREEN_MODE;!function(t){t[t.PORTRAIT=0]="PORTRAIT",t[t.LANDSCAPE=1]="LANDSCAPE"}(SCREEN_MODE||(SCREEN_MODE={}));var Main=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),egret.ImageLoader.crossOrigin="anonymous",egret.lifecycle.addLifecycleListener(function(t){}),egret.lifecycle.onPause=function(){},egret.lifecycle.onResume=function(){},Global.start(this,egret.OrientationMode.PORTRAIT,0,!1),DataCenter.getInstance();var e=new AssetAdapter;egret.registerImplementation("eui.IAssetAdapter",e),egret.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),this.onResizes(),this.runGame()["catch"](function(t){console.log(t)})},e.prototype.onResizes=function(t){void 0===t&&(t=null),lz.GameGlobal.screenWidth=this.stage.stageWidth,lz.GameGlobal.screenHeight=this.stage.stageHeight},e.prototype.runGame=function(){return __awaiter(this,void 0,void 0,function(){var t,e;return __generator(this,function(i){switch(i.label){case 0:return[4,this.loadResource()];case 1:return i.sent(),[4,RES.getResAsync("description_json")];case 2:return t=i.sent(),lz.GameConfig.initConfig(t),console.log("lz.GameConfig.channel="+lz.GameConfig.channel),[4,RES.getResAsync("all_json")];case 3:return e=i.sent(),LanguageConfig.init(e),this.loadingView=new LoadingView,this.addChild(this.loadingView),this.loadingView.startLoading(),[2]}})})},e.prototype.loadResource=function(){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return e.trys.push([0,4,,5]),lz.GameConfig.resUrl="resource/",[4,RES.loadConfig("default.res.json",lz.GameConfig.resUrl)];case 1:return e.sent(),[4,RES.loadGroup("loading")];case 2:return e.sent(),[4,this.loadTheme()];case 3:return e.sent(),[3,5];case 4:return t=e.sent(),console.error(t),[3,5];case 5:return[2]}})})},e.prototype.loadTheme=function(){var t=this;return new Promise(function(e,i){var n=new eui.Theme("resource/default.thm.json",t.stage);n.addEventListener(eui.UIEvent.COMPLETE,function(){e()},t)})},e}(eui.UILayer);__reflect(Main.prototype,"Main");var BattleRecordView=function(t){function e(){var e=t.call(this)||this;return e.totalWidth=640,e.titleWidth=76,e.skinName="BattleRecordSkin",e}return __extends(e,t),e.prototype.loadComplete=function(){t.prototype.loadComplete.call(this),this.rectBack.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onCilckClose,this),this.btnColse.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onCilckClose,this)},e.prototype.onRemoved=function(t){this.rectBack.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onCilckClose,this),this.btnColse.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onCilckClose,this)},e.prototype.onCilckClose=function(t){this.visible=!1},e.prototype.showBattleRecord=function(t,e,i){this.grpContainer.removeChildren(),this._shape=new egret.Shape,this.grpContainer.addChild(this._shape);var n=e.length,a=(this.totalWidth-76)/n,s=30;if(this._shape.graphics.lineStyle(1,8936235),t==ROOM_TYPE.POOL_RUMMY){for(var o=0;n>o;o++)0==o?(this._shape.graphics.moveTo(this.titleWidth,0),this._shape.graphics.lineTo(this.titleWidth,(i+2)*s)):(this._shape.graphics.moveTo(this.titleWidth+o*a,0),this._shape.graphics.lineTo(this.titleWidth+o*a,(i+2)*s));this._shape.graphics.moveTo(0,s),this._shape.graphics.lineTo(this.totalWidth,s);for(var o=0;i+2>o;o++)this._shape.graphics.moveTo(0,s*(o+1)),this._shape.graphics.lineTo(this.totalWidth,s*(o+1))}if(t==ROOM_TYPE.DEAL_RUMMY){for(var o=0;n>o;o++)0==o?(this._shape.graphics.moveTo(this.titleWidth,0),this._shape.graphics.lineTo(this.titleWidth,(i+3)*s)):(this._shape.graphics.moveTo(this.titleWidth+o*a,0),this._shape.graphics.lineTo(this.titleWidth+o*a,(i+3)*s));this._shape.graphics.moveTo(0,s),this._shape.graphics.lineTo(this.totalWidth,s);for(var o=0;i+3>o;o++)this._shape.graphics.moveTo(0,s*(o+1)),this._shape.graphics.lineTo(this.totalWidth,s*(o+1))}if(t==ROOM_TYPE.POOL_RUMMY)for(var o=0;i+2>o;o++)if(0==o){var r=this.createLabel();r.x=38,r.y=8,r.text="Deal",this.grpContainer.addChild(r)}else if(o==i+1){var h=this.createLabel();h.x=38,h.y=8+30*o,h.text="Score",this.grpContainer.addChild(h)}else{var r=this.createLabel();r.x=38,r.y=8+30*o,r.text=String(o),this.grpContainer.addChild(r)}if(t==ROOM_TYPE.DEAL_RUMMY)for(var o=0;i+3>o;o++)if(0==o){var r=this.createLabel();r.x=38,r.y=8,r.text="Deal",this.grpContainer.addChild(r)}else if(1==o){var l=this.createLabel();l.x=38,l.y=8+30*o,l.text="Start",this.grpContainer.addChild(l)}else if(o==i+2){var h=this.createLabel();h.x=38,h.y=8+30*o,h.text="Score",this.grpContainer.addChild(h)}else{var r=this.createLabel();r.x=38,r.y=8+30*o,r.text=String(o-1),this.grpContainer.addChild(r)}for(var o=0;o<e.length;o++){var c=e[o],d=c.id,p=c.list,u=0,g=this.createLabel();if(g.x=this.titleWidth+o*a+a/2,g.y=8,g.text="User"+d,this.grpContainer.addChild(g),p.length>0)for(var _=0;_<=p.length;_++)if(_==p.length&&p.length>0){var T=this.createLabel();T.x=this.titleWidth+o*a+a/2,T.y=8+30*(_+1),T.text=String(u),this.grpContainer.addChild(T)}else{u+=p[_];var v=this.createLabel();v.x=this.titleWidth+o*a+a/2,v.y=8+30*(_+1),v.text=String(p[_]),this.grpContainer.addChild(v)}}},e.prototype.createLabel=function(){var t=new eui.Label;return t.size=14,t.fontFamily="Arial",t.width=76,t.textAlign=egret.HorizontalAlign.CENTER,t.anchorOffsetX=38,t},e}(lz.BaseView);__reflect(BattleRecordView.prototype,"BattleRecordView");var BattleSettingView=function(t){function e(){var e=t.call(this)||this;return e._game=DataCenter.getInstance().game,e._battle=DataCenter.getInstance().battle,e.skinName="BattleSettingSkin",e}return __extends(e,t),e.prototype.loadComplete=function(){t.prototype.loadComplete.call(this),this.grpInfo.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onShowInfo,this),this.grpRule.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onShowRule,this),this.btnSound.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onChangeSound,this),this.btnVibration.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onChangeVibration,this),this.btnTips.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onChangeShowTips,this),this.btnLast.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onChangeLast,this),this.btnClose.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onCilckClose,this),this.rectBackgroud.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onCilckClose,this),this.grpGameInfo.visible=!1,this.updateView()},e.prototype.onRemoved=function(t){this.grpInfo.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onShowInfo,this),this.grpRule.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onShowRule,this),this.btnSound.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onChangeSound,this),this.btnVibration.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onChangeVibration,this),this.btnTips.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onChangeShowTips,this),this.btnLast.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onChangeLast,this),this.btnClose.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onCilckClose,this),this.rectBackgroud.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onCilckClose,this)},e.prototype.updateView=function(){this.grpMenu.visible=!0,this.grpGameInfo.visible=!1,1==this._game.soundOpen?(this.btnSound.source="game_json.s1",this.imgSound.source="battle_json.icon1"):(this.btnSound.source="game_json.s2",this.imgSound.source="battle_json.icon2"),1==this._game.vibrationOpen?(this.btnVibration.source="game_json.s1",this.imgVibration.source="battle_json.icon3"):(this.btnVibration.source="game_json.s2",this.imgVibration.source="battle_json.icon4"),1==this._game.battleTipOpen?this.btnTips.source="game_json.s1":this.btnTips.source="game_json.s2",1==this._battle.isLastGame?(this.btnLast.source="game_json.check2",this.labLastGame.textColor=3381555):(this.btnLast.source="game_json.check",this.labLastGame.textColor=16777215)},e.prototype.onShowInfo=function(t){this.grpMenu.visible=!1,this.grpGameInfo.visible=!0},e.prototype.onShowRule=function(t){if(this._game.currentRoom){var e=this._game.currentRoom.type,i=new RuleView;i.showView(e),lz.PopupManager.addPop(i),this.visible=!1}},e.prototype.onChangeSound=function(t){this._game.changeSoundOpen(),this.updateView()},e.prototype.onChangeVibration=function(t){this._game.changeVibrationOpen(),this.updateView()},e.prototype.onChangeShowTips=function(t){this._game.changeBattleTipOpen(),this.updateView()},e.prototype.onChangeLast=function(t){this._battle.changeLastGame(),this.updateView()},e.prototype.onCilckClose=function(t){this.visible=!1},e}(lz.BaseView);__reflect(BattleSettingView.prototype,"BattleSettingView");var BattleTipView=function(t){function e(){var e=t.call(this)||this;return e.skinName="BattleTipSkin",e}return __extends(e,t),e.prototype.init=function(t){switch(t){case 0:this.labTipText.text="Pure Sequence";break;case 1:this.labTipText.text="Sequence";break;case 2:this.labTipText.text="Set / Sequence";break;case 3:this.labTipText.text="Set / Sequence"}},e.prototype.showTip=function(){this.imgCheck.source="game_json.check2",this.labTipText.textColor=3381555},e.prototype.showNull=function(){this.imgCheck.source="game_json.check1",this.labTipText.textColor=16777215},e}(eui.ItemRenderer);__reflect(BattleTipView.prototype,"BattleTipView");var BattleUserHeadView=function(t){function e(){var e=t.call(this)||this;e.info=null,e.player=null,e.battle=null,e.game=null,e.angle=0,e.redius=47,e.player=DataCenter.getInstance().player,e.battle=DataCenter.getInstance().battle,e.game=DataCenter.getInstance().game,e.skinName="BattleUserSkin",e.addEventListener(egret.Event.ADDED_TO_STAGE,e.onAdded,e),e.addEventListener(egret.Event.REMOVED_FROM_STAGE,e.onRemoved,e);var i=new egret.Shape;return i.graphics.beginFill(0,.6),i.graphics.drawCircle(47,47,e.redius),i.graphics.endFill(),e.grpTimerBack.addChild(i),e}return __extends(e,t),e.prototype.onAdded=function(t){this.removeEventListener(egret.Event.ADDED_TO_STAGE,this.onAdded,this),lz.Facade.registerNotifListeners(this),this.grpScore.visible=!1},e.prototype.onRemoved=function(t){this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemoved,this),lz.Facade.removeNotifListeners(this)},e.prototype.notificationListeners=function(){return[GameEvent.UPDATE_PLAYER_MONEY]},e.prototype.executeNotification=function(t,e,i){t==GameEvent.UPDATE_PLAYER_MONEY&&this.info&&this.info.isMe},e.prototype.getUserId=function(){return this.info.id},e.prototype.setUserInfo=function(t){this.info=t,t?(this.imgHead.source=t.avatar,this.labName.text=Utils.spliteName(t.name),this.visible=!0,this.updateState(t)):this.visible=!1,this._shapeCount||this.createRound()},e.prototype.updateState=function(t){this.pStateGroup.visible=!1,t.playerState==PLAYER_STATE.DROP_GAME&&(this.pStateGroup.visible=!0,this.labState.text="Drop"),t.playerState==PLAYER_STATE.AWAY&&(this.pStateGroup.visible=!0,this.labState.text="Away"),1==t.disconnect&&(this.pStateGroup.visible=!0,this.labState.text="Disconnect"),t.playerState==PLAYER_STATE.ELIMINATE&&(this.pStateGroup.visible=!0,this.labState.text="Eliminate")},e.prototype.updateColdTime=function(t,e){this.pCodeTime.visible=!1,t&&this.info&&this.player.info&&t.id==this.info.id&&(this.battle.battleState==BATTLE_STATE.RUNNING&&e==COMBAT_TYPE.RUNNING||this.battle.battleState==BATTLE_STATE.FINISH&&e==COMBAT_TYPE.FINISHING)&&(this.pCodeTime.visible=!0),1==this.pCodeTime.visible?t.dp_EndTime>lz.ServerTime.time?(this.labCodeTime.text=t.dp_EndTime-lz.ServerTime.time+"",this.labBonusTime.visible=!1,this.timeMove()):t.dp_BonusTime>lz.ServerTime.time?(this.labCodeTime.text=t.dp_BonusTime-lz.ServerTime.time+"",this.labBonusTime.visible=!0,this.timeMove()):this.labCodeTime.text="0":this.angle=0},e.prototype.showScore=function(){this.info&&(this.game.currentRoom.type==ROOM_TYPE.DEAL_RUMMY||this.game.currentRoom.type==ROOM_TYPE.POOL_RUMMY)&&(this.grpScore.visible=!0,this.labScore.text=String(this.info.score))},e.prototype.hideScore=function(){this.grpScore.visible=!1},e.prototype.createRound=function(){this._shapeCount=new egret.Shape,this._shapeCount.width=this._shapeCount.height=94,this._shapeCount.x=97,this._shapeCount.y=5,this._shapeCount.rotation=-90,this._shapeCount.anchorOffsetX=this._shapeCount.anchorOffsetY=47,this._shapeCount.alpha=.5,this.pCodeTime.addChild(this._shapeCount),this.timerBack.mask=this._shapeCount},e.prototype.resetMove=function(){this.angle=0},e.prototype.timeMove=function(){this.angle+=.2,this.angle>=360&&(this.angle=0),this._shapeCount.graphics.clear(),this._shapeCount.graphics.beginFill(0),this._shapeCount.graphics.moveTo(0,0),this._shapeCount.graphics.lineTo(this.redius,0),this._shapeCount.graphics.drawArc(0,0,this.redius,0,this.angle*Math.PI/180,!0),this._shapeCount.graphics.lineTo(0,0),this._shapeCount.graphics.endFill()},e.prototype.showGuildMode=function(){this.pCodeTime.visible=!1,this.pStateGroup.visible=!1,this.grpScore.visible=!1},e}(eui.Component);__reflect(BattleUserHeadView.prototype,"BattleUserHeadView",["lz.IMediator"]);var COMBAT_TYPE;!function(t){t[t.WAITING=0]="WAITING",t[t.STARTING=1]="STARTING",t[t.TOSSING=2]="TOSSING",t[t.DEALING=3]="DEALING",t[t.RUNNING=4]="RUNNING",t[t.FINISHING=5]="FINISHING",t[t.DECLARING=6]="DECLARING"}(COMBAT_TYPE||(COMBAT_TYPE={}));var BattleView=function(t){function e(){var e=t.call(this)||this;return e.deleted=!1,e._battle=null,e._player=null,e.gap_poker=60,e.gap_group=10,e.userHeadAry=[],e.ptHeadAry=[[578,595],[1118,155],[848,57],[578,57],[308,57],[38,155]],e.ptTossAry=[[641,525],[1067,290],[862,252],[641,252],[420,252],[215,290]],e.tossTwAry=[],e.cardTwAry=[],e.groupTipAry=[],e.ptMaskCard=new egret.Point(440,230),e.ptOutCard=new egret.Point(593,230),e.ptFinishCard=new egret.Point(746,230),e.cardsAry=[],e.nCombatType=COMBAT_TYPE.WAITING,e.nGapTime=0,e.strWait="",e.groupTipsAry=[],e.groupTipsLabelAry=[],e.pokerTipAry=[],e.tossCardTw=null,e.groupCards={},e.battleRecordView=null,e.battleSettingView=null,e._dealIndex=-1,e.moveCard=null,e}return __extends(e,t),e.prototype.loadComplete=function(){t.prototype.loadComplete.call(this),this.updateDelay(),this.guildGroup.visible=!1,this.stage.orientation=egret.OrientationMode.LANDSCAPE,this.stage.setContentSize(1280,720),lz.GameGlobal.screenWidth=this.stage.stageWidth,lz.GameGlobal.screenHeight=this.stage.stageHeight,this.btnContinue.visible=!1,this._battle=DataCenter.getInstance().battle,this._game=DataCenter.getInstance().game,this._player=DataCenter.getInstance().player,this.btnBack.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onCilckBack,this),this.btnDisCard.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickOutCard,this),this.btnFinish.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickFinish,this),this.btnGroup.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickGroup,this),this.pDropGroup.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickDrop,this),this.btnNotice.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onDeclare,this),this.btnBattleTip.addEventListener(egret.TouchEvent.TOUCH_TAP,this.showGroupTip,this),this.btnRecord.addEventListener(egret.TouchEvent.TOUCH_TAP,this.showRecord,this),this.btnSetting.addEventListener(egret.TouchEvent.TOUCH_TAP,this.showBattleSettingView,this),this.finishCard.visible=!1,this.groupTipAry=[this.tip1,this.tip2,this.tip3,this.tip4];for(var e=0;e<this.groupTipAry.length;++e)this.groupTipAry[e].init(e);if(this.battleNoticeGroup.visible=!1,this.pDropGroup.visible=!1,this.grpBattleTip.visible=!1,this.btnRecord.visible=!1,this.tossCard.visible=!1,this.grpSingleGroup.visible=!1,this._game.isBattle=!0,this.param&&this.param.roomData){var i=this.param.roomData;this._game.updateRoomInfo(i)}this.showHeaderText(),this.setVis(),this._game.currentRoom&&this.doUpdate(),this.param&&this.param.battleData&&this.param.roomData&&this.resetBattle(this.param.battleData),lz.UpdateManager.addUpdateable(this)},e.prototype.onRemoved=function(e){t.prototype.onRemoved.call(this,e),this._game.isBattle=!1,this.stage.orientation=egret.OrientationMode.PORTRAIT,this.stage.setContentSize(720,1280),lz.GameGlobal.screenWidth=this.stage.stageWidth,lz.GameGlobal.screenHeight=this.stage.stageHeight,lz.UpdateManager.delUpdateable(this),this.btnBack.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onCilckBack,this),this.btnDisCard.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickOutCard,this),this.btnFinish.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickFinish,this),this.btnGroup.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickGroup,this),this.pDropGroup.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickDrop,this),this.btnNotice.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onDeclare,this),this.btnBattleTip.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.showGroupTip,this),this.btnRecord.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.showRecord,this),this.btnSetting.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.showBattleSettingView,this)},e.prototype.notificationListeners=function(){return[GameEvent.UPDATA_SHOW_TOSS,GameEvent.UPDATA_CARDLIST,GameEvent.UPDATA_ROOMINFO,GameEvent.UPDATA_PLAYER_STATE,GameEvent.START_COUNT_DOWN,GameEvent.GAME_TURN,GameEvent.DRAW_POKER,GameEvent.DRAW_POKER_NOTIFICATION,GameEvent.PLAY_POKER,GameEvent.PLAY_POKER_NOTIFICATION,GameEvent.FINISH_POKER,GameEvent.FINISH_POKER_NOTIFICATION,GameEvent.ERROR_DECLARE,GameEvent.ERROR_DECLARE_NOTIFICATION,GameEvent.FINISH_DECLARE_NOTIFICATION,GameEvent.OPEN_RESULT,GameEvent.GAME_OVER,GameEvent.ME_DROP_GAME,GameEvent.RENEW_GAME,GameEvent.UPDATE_BATTLE,GameEvent.KICK_FROM_BATTLE,GameEvent.NET_DELAY_CHANGE]},e.prototype.executeNotification=function(t,e,i){if(t==GameEvent.UPDATA_SHOW_TOSS)this.playTossTw(e);else if(t==GameEvent.UPDATA_CARDLIST)e.isShowAni&&0==this._game.isResumeTime?this.playCardTw():this.doCreateCard();else if(t==GameEvent.UPDATA_ROOMINFO)this.doUpdate();else if(t==GameEvent.UPDATA_PLAYER_STATE)this.doPlayerUpdate();else if(t==GameEvent.GAME_TURN)this.battleTurn(e);else if(t==GameEvent.START_COUNT_DOWN)this.nCombatType=COMBAT_TYPE.STARTING;else if(t==GameEvent.DRAW_POKER)this.playMyDrawTw(e);else if(t==GameEvent.DRAW_POKER_NOTIFICATION)this.playOtherDrawTw(e);else if(t==GameEvent.PLAY_POKER)this.playMyDiscardTw(e);else if(t==GameEvent.PLAY_POKER_NOTIFICATION)this.playOtherDiscardTw(e);else if(t==GameEvent.FINISH_POKER)this.playMyFinishTw(e);else if(t==GameEvent.FINISH_POKER_NOTIFICATION)this.playOtherFinishTw(e);else if(t==GameEvent.ERROR_DECLARE)this.playMyErrorDeclareTw(e);else if(t==GameEvent.ERROR_DECLARE_NOTIFICATION)this.playOtherErrorDeclareTw(e);else if(t==GameEvent.FINISH_DECLARE_NOTIFICATION)this.playFinishDeclareTw(e);else if(t==GameEvent.OPEN_RESULT)this.openResultView(e);else if(t==GameEvent.ME_DROP_GAME)this.meDropGame();else if(t==GameEvent.RENEW_GAME)this.readyGame();else if(t==GameEvent.GAME_OVER)this.gameOver(e);else if(t==GameEvent.UPDATE_BATTLE){lz.UpdateManager.delUpdateable(this);var n=e.battleData;this.resetBattle(n),lz.UpdateManager.addUpdateable(this)}else t==GameEvent.KICK_FROM_BATTLE?this.kickFromBattle(e):t==GameEvent.CLOSE_BATTLE?this.closeBattle():t==GameEvent.NET_DELAY_CHANGE&&this.updateDelay()
},e.prototype.resetBattle=function(t){if(this._player.info.disconnect=!1,this._battle.newGame(),this._battle.battleState=t.battlestate,this.tossCard.visible=!1,this._battle.battleState==BATTLE_STATE.WAITING)this.nCombatType=COMBAT_TYPE.WAITING;else if(this._battle.battleState==BATTLE_STATE.READY)this._battle.startTime=t.starttime,this.nCombatType=COMBAT_TYPE.STARTING;else{if(this._battle.closeCardCount=t.pokercount,this._game.updatePlayerScore(t.scoredata),this._battle.initJokerCard(t.wildjokerdata),this._battle.initFoldList(t.droppokerlist),this._battle.initCardList(t.pokerdata,!1,!1),this._battle.initRecordList(t.recordlist),this.playCardTw(2),this.updateDeskCard(),this._battle.battleState==BATTLE_STATE.RUNNING){var e=t.runningdata,i=this._game.currentRoom.getPlayerById(e.userid);i&&(i.idx=e.roomindex,i.dp_EndTime=e.expiretime,i.dp_BonusTime=e.bonustime,this._battle.curInfo=i),this.nCombatType=COMBAT_TYPE.RUNNING,this._player.info.playerState==PLAYER_STATE.DROP_GAME&&this.meDropGame()}if(this._battle.battleState==BATTLE_STATE.FINISH){var n=t.finishdata,a=n.finishpoker,i=this._game.currentRoom.getPlayerById(n.finishuserid);i&&(i.dp_EndTime=n.finishtime,this._battle.curInfo=i,this._game.updatePlayerState(n.finishuserid,PLAYER_STATE.DECLARING,1),n.finishuserid==this._player.info.id?(this.battleEnterFinish(a),this.showDeclare()):this.battleEnterFinish(null))}if(this._battle.battleState==BATTLE_STATE.DECLARE){var s=t.declaredata;this._battle.overTime=s.overtime;var a=s.finishpoker,o=s.winuserid;if(this._game.updatePlayerState(this._player.info.id,t.playerstate,1),o!=this._player.info.id){var r=this.getUserHeadView(o);this.showWin(r.x-50,r.y+40)}if(this._player.info.playerState==PLAYER_STATE.COMPLETE){this._battle.isWinPlayOver=!0;var h=s.battleresult;this._battle.initResultList(h)}else this.startDeclaring(a)}}},e.prototype.closeBattle=function(){this.resultView&&lz.PopupManager.delPop(this.resultView),lz.Facade.sendNotification(lz.GameFrameEvent.OPEN_VIEW,GameViewType.AppHome,"open")},e.prototype.kickFromBattle=function(t){var e=t.reason;this.resultView&&this.resultView.showKickResult(e)},e.prototype.showHeaderText=function(){this._game.currentRoom.type==ROOM_TYPE.POINT_RUMMY&&(this._game.currentRoom.mode==ROOM_MODE.GOLD_MODE&&(this.labInfo.text="Point Value: "+this._game.currentRoom.point_value,this.labBalance.text="Balance: "+this._player.info.gold,this.labName.text=this._game.currentRoom.name),this._game.currentRoom.mode==ROOM_MODE.CASH_MODE&&(this.labInfo.text="Point Value: "+this._game.currentRoom.point_value,this.labBalance.text="Balance: "+this._player.info.cash,this.labName.text=this._game.currentRoom.name)),this._game.currentRoom.type==ROOM_TYPE.POOL_RUMMY&&(this._game.currentRoom.mode==ROOM_MODE.GOLD_MODE&&(this.labInfo.text="Deal: "+(this._game.currentRoom.finishDeal+1)+"  |  Entry: "+this._game.currentRoom.entry_fee,this.labBalance.text="Balance: "+this._player.info.gold,this.labName.text=this._game.currentRoom.name),this._game.currentRoom.mode==ROOM_MODE.CASH_MODE&&(this.labInfo.text="Deal: "+(this._game.currentRoom.finishDeal+1)+"  |  Entry: "+this._game.currentRoom.entry_fee,this.labBalance.text="Balance: "+this._player.info.cash,this.labName.text=this._game.currentRoom.name)),this._game.currentRoom.type==ROOM_TYPE.DEAL_RUMMY&&(this._game.currentRoom.mode==ROOM_MODE.GOLD_MODE&&(this.labInfo.text="Deal: "+(this._game.currentRoom.finishDeal+1)+"/"+this._game.currentRoom.totalDeal+"  |  Entry: "+this._game.currentRoom.entry_fee,this.labBalance.text="Balance: "+this._player.info.gold,this.labName.text=this._game.currentRoom.name),this._game.currentRoom.mode==ROOM_MODE.CASH_MODE&&(this.labInfo.text="Deal: "+(this._game.currentRoom.finishDeal+1)+"/"+this._game.currentRoom.totalDeal+"  |  Entry: "+this._game.currentRoom.entry_fee,this.labBalance.text="Balance: "+this._player.info.cash,this.labName.text=this._game.currentRoom.name))},e.prototype.doUpdate=function(){var t=this._game.currentRoom;if(t){this.grpUserHead.removeChildren(),this.userHeadAry=[];for(var e,i=t.playerList,n=0;n<i.length;n++){var a=i[n];if(a.id==this._player.info.id){e=n;break}}for(var n=e;n<i.length;n++){var s=new BattleUserHeadView;s.setUserInfo(i[n]),this.userHeadAry.push(s)}if(e>0)for(var n=0;e>n;n++){var s=new BattleUserHeadView;s.setUserInfo(i[n]),this.userHeadAry.push(s)}for(var n=0;n<this.userHeadAry.length;n++){var s=this.userHeadAry[n];s.x=this.ptHeadAry[n][0],s.y=this.ptHeadAry[n][1],s.viewIndex=n,this.grpUserHead.addChild(s)}this.showHeaderText()}},e.prototype.doPlayerUpdate=function(){var t=this._game.currentRoom;if(t)for(var e=t.playerList,i=0;i<e.length;i++){var n=e[i],a=this.getUserHeadView(n.id);a&&a.updateState(n)}},e.prototype.setVis=function(){this.showCardGroup.visible=this.btnDisCard.visible=!1,this.btnFinish.visible=this.btnDisCard.visible},e.prototype.readyGame=function(){this.btnRecord.visible=!1,this.showHeaderText();for(var t=0;t<this.userHeadAry.length;++t)this.userHeadAry[t].hideScore();null!=this.battleRecordView&&(this.removeChild(this.battleRecordView),this.battleRecordView=null),this._battle.isTossPlayOver=!1,this._battle.isDealPlayOver=!1,this._battle.isWinPlayOver=!1,this.removeCard(),this.battleNoticeGroup.visible=!1,this.winImg&&(this.winImg.visible=!1),this.finishCard.visible=!1,lz.PopupManager.hasPop1("ResultView")&&lz.PopupManager.delPop(this.resultView),this.grpBattleTip.visible=!1,this.nCombatType=COMBAT_TYPE.WAITING,this.pMask.visible=!0,this.setVis()},e.prototype.battleTurn=function(t){var e=t.turnData,i=e.userid;this._battle.round=e.round;var n=e.statelist;for(var a in n)this._game.updatePlayerState(Number(a),n[a],1);var s=this._game.currentRoom.getPlayerById(i);if(s){var o=e.turntype;if(2==o){var r=this.getUserHeadView(i);r&&r.resetMove()}s.idx=e.roomindex,s.dp_EndTime=e.expiretime,s.dp_BonusTime=e.bonustime,this._battle.curInfo=s,i==this._player.info.id&&(SoundManager.playSound("ding_mp3"),AndroidManager.getInstance().vibrateMobile())}},e.prototype.playTossTw=function(t){return 1==this._game.isResumeTime?void this.playTossOver(null):(this.tossCard.visible=!0,this.labWatiTime.text="",this.nCombatType=COMBAT_TYPE.TOSSING,this.tossTwAry=[],void this.playToss(0,t))},e.prototype.playToss=function(t,e){var i=this;if(1==this._game.isResumeTime)return void this.playTossOver(null);if(t>=this.userHeadAry.length)return this.tossCard.visible=!1,void this.tossPokerTw(0,e);var n=this.userHeadAry[t],a=n.getUserId();if(this._battle._tossDic[a]){var s=this._battle._tossDic[a],o=new ImageTwClass;o.x=this.tossCard.x,o.y=this.tossCard.y,o.anchorOffsetX=48,o.anchorOffsetY=65,o.setCardData(s),this.addChild(o),this.tossTwAry.push(o),a==this._battle.tossUserId&&(this.tossCardTw=o),o.createTw(new egret.Point(this.ptTossAry[t][0],this.ptTossAry[t][1]),10,200,function(){i.playToss(t+1,e)})}else this.playToss(t+1,e)},e.prototype.tossPokerTw=function(t,e){var i=this;this.tossCardTw&&egret.Tween.get(this.tossCardTw).to({scaleX:1.4,scaleY:1.4},400,egret.Ease.sineIn).wait(10).call(function(){egret.Tween.get(i.tossCardTw).to({scaleX:1,scaleY:1},400,egret.Ease.sineOut).wait(10).call(function(){0==t?i.tossPokerTw(1,e):i.playTossOver(e)})})},e.prototype.playTossOver=function(t){this._battle.isTossPlayOver=!0;for(var e=0;e<this.tossTwAry.length;++e)this.contains(this.tossTwAry[e])&&this.removeChild(this.tossTwAry[e]);t&&this._battle.initCardList(t.cardList,!0)},e.prototype.playCardTw=function(t){void 0===t&&(t=1),this.jokerCard.doUpdateCard(this._battle.wildJokerData,cardTypes.CARD_DESKTOP_JOKER),this.maskCard.doUpdateCard(null,cardTypes.CARD_DESKTOP),this.btnBack.visible=!1,this.showCardGroup.visible=!0,this.labWatiTime.text="",this.nCombatType=COMBAT_TYPE.DEALING,1==t?this.playTweenFunc():this.doCreateCard()},e.prototype.playTweenFunc=function(){this._dealIndex=0,this.cardTwAry=[],this.timer=new egret.Timer(100,this._battle.cardList.length),this.timer.addEventListener(egret.TimerEvent.TIMER,this.dealCardTw,this),this.timer.start()},e.prototype.dealCardTw=function(){var t=this,e=65*this._battle.cardList.length+30,i=this.showCardGroup.localToGlobal(this.maskRect.x,this.maskRect.y),n=(this.cardGroup.width-e)/2+65*this._dealIndex,a=new egret.Point(n,this.rectCard.y),s=new ImageTwClass;s.x=i.x,s.y=i.y,s.setCardData(this._battle.cardList[this._dealIndex]),s.index=this._dealIndex,this.addChild(s),this.cardTwAry.push(s),s.createTw(a,0,200,function(){s.index==t._battle.cardList.length-1&&egret.setTimeout(t.dealTwOver,t,1e3)}),this._dealIndex+=1},e.prototype.dealTwOver=function(){for(var t=0;t<this.cardTwAry.length;t++)if(this.cardTwAry[t]){var e=this.cardTwAry[t];this.contains(e)&&this.removeChild(e)}this.doCreateCard(),this.updateDeskCard(),this.nCombatType=COMBAT_TYPE.RUNNING},e.prototype.updateDeskCard=function(){this._battle.isDealPlayOver=!0,this.updateFoldCard(),this.pMask.visible=!1,this.btnBack.visible=!0,(this._game.currentRoom.type==ROOM_TYPE.DEAL_RUMMY||this._game.currentRoom.type==ROOM_TYPE.POOL_RUMMY)&&(this.btnRecord.visible=!0);for(var t=0;t<this.userHeadAry.length;++t)this.userHeadAry[t].showScore()},e.prototype.battleEnterFinish=function(t){var e=null;t&&(e=new CardData,e.init(t,this._battle.wildJokerData.num)),this.finishCard.doUpdateCard(e,cardTypes.CARD_FINISH),this.finishCard.visible=!0,this.nCombatType=COMBAT_TYPE.FINISHING},e.prototype.getPoint=function(t){var e=this.userHeadAry[t];return e?new egret.Point(e.x,e.y):null},e.prototype.update=function(t){if(this.nCombatType==COMBAT_TYPE.WAITING)this.nGapTime-=t,this.nGapTime<0&&(this.nGapTime=200,this.strWait=this.strWait.length>=6?"":this.strWait+"."),this.labWatiTime.text="Waiting"+this.strWait;else if(this.nCombatType==COMBAT_TYPE.STARTING)this._battle.startTime>=lz.ServerTime.time?this.labWatiTime.text="Game starting in "+(this._battle.startTime-lz.ServerTime.time)+"s":this.labWatiTime.text="";else if(this.nCombatType==COMBAT_TYPE.DECLARING)return void(this._player.info.playerState==PLAYER_STATE.DROP_GAME||(this.showDeclare(),this.checkBtnVis()));this.labCost.text=this._battle.getDropLosePoint(this._game.currentRoom.playerList.length)+" Point",this.pDropGroup.visible=this._player.info.playerState==PLAYER_STATE.DRAWING&&this._battle.isDealPlayOver,this.maskCard.doUpdateTotalCard(this._battle.closeCardCount),this.jokerCard.touchEnabled=this.jokerCard.touchChildren=1==this._battle.closeCardCount,this.btnBack.visible=this._player.info.playerState==PLAYER_STATE.DROP_GAME||this._battle.battleState==BATTLE_STATE.WAITING||this._battle.battleState==BATTLE_STATE.RUNNING&&this._battle.isDealPlayOver,this.btnBattleTip.visible=1==this._game.battleTipOpen,0==this.btnBattleTip.visible&&(this.grpBattleTip.visible=!1),this.updateFoldCard(),this.checkBtnVis(),this.updateHead()},e.prototype.updateHead=function(){for(var t=null,e=0;e<this.userHeadAry.length;++e)t=this.userHeadAry[e],1==t.visible&&t.updateColdTime(this._battle.curInfo,this.nCombatType)},e.prototype.showDeclare=function(){this.battleNoticeGroup.visible=!0,this._battle.overTime>=lz.ServerTime.time&&(this.labNoticeTip.text="Please group your cards and Declare ("+(this._battle.overTime-lz.ServerTime.time)+")"),this.btnNotice.visible=!0,this.btnNotice.label="Declare"},e.prototype.playMyDrawTw=function(t){var e=this,i=this.getCardListViewWidth(),n=(this.cardGroup.width-i)/2,a=t.card,s=t.drawType,o=new ImageTwClass;if(1==s)o.x=this.ptMaskCard.x,o.y=this.ptMaskCard.y,this.addChild(o),o.createFlipTw(a.num,a.type,function(){var t=n+i-95,a=e.rectCard.y;o.createTw(new egret.Point(t,a),10,200,function(){e.contains(o)&&e.removeChild(o),e.doCreateCard()})});else{o.x=this.ptOutCard.x,o.y=this.ptOutCard.y,o.setCardSource(a.num,a.type),this.addChild(o);var r=n+i-95,h=this.rectCard.y;o.createTw(new egret.Point(r,h),10,200,function(){e.contains(o)&&e.removeChild(o),e.doCreateCard()})}},e.prototype.playOtherDrawTw=function(t){var e=this,i=t.id,n=t.drawtype,a=t.card,s=this.getUserHeadView(i),o=new ImageTwClass;1==n?(o.x=this.ptMaskCard.x,o.y=this.ptMaskCard.y,this.addChild(o),o.createTw(new egret.Point(s.x,s.y),10,200,function(){e.contains(o)&&e.removeChild(o)})):(o.x=this.ptOutCard.x,o.y=this.ptOutCard.y,o.setCardSource(a[1],a[2]),this.addChild(o),o.createTw(new egret.Point(s.x,s.y),10,200,function(){e.contains(o)&&e.removeChild(o)}))},e.prototype.playMyDiscardTw=function(t){for(var e=this,i=t.card,n=t.droplist,a=-1,s=0;s<this.cardsAry.length;++s){var o=this.cardsAry[s];if(i[0]==o.cardData.id){a=s;break}}var r=new ImageTwClass;r.x=this.cardsAry[a].x,r.y=this.cardsAry[a].y+this.cardGroup.y,r.setCardSource(i[1],i[2]),this.addChild(r),this.doCreateCard(),r.createTw(new egret.Point(this.ptOutCard.x,this.ptOutCard.y),10,200,function(){e.contains(r)&&e.removeChild(r),e._battle.initFoldList(n)})},e.prototype.playOtherDiscardTw=function(t){var e=this,i=t.id,n=t.card,a=t.droplist,s=this.getUserHeadView(i),o=new ImageTwClass;o.x=s.x,o.y=s.y,o.setCardSource(n[1],n[2]),this.addChild(o),o.createTw(new egret.Point(this.ptOutCard.x,this.ptOutCard.y),10,200,function(){e.contains(o)&&e.removeChild(o),e._battle.initFoldList(a)})},e.prototype.playMyFinishTw=function(t){for(var e=this,i=t.card,n=-1,a=0;a<this.cardsAry.length;++a){var s=this.cardsAry[a];if(i[0]==s.cardData.id){n=a;break}}var o=new ImageTwClass;o.x=this.cardsAry[n].x,o.y=this.cardsAry[n].y+this.cardGroup.y,o.setCardSource(i[1],i[2]),this.addChild(o),this.doCreateCard(),o.createTw(new egret.Point(this.ptFinishCard.x,this.ptFinishCard.y),10,200,function(){e.contains(o)&&e.removeChild(o),e.showDeclare(),e.battleEnterFinish(i)})},e.prototype.playOtherFinishTw=function(t){var e=this,i=t.id,n=this.getUserHeadView(i),a=new ImageTwClass;a.x=n.x,a.y=n.y,this.addChild(a),a.createTw(new egret.Point(this.ptFinishCard.x,this.ptFinishCard.y),10,200,function(){e.contains(a)&&e.removeChild(a),e.battleEnterFinish(null)})},e.prototype.playMyErrorDeclareTw=function(t){var e=this,i=t.card,n=new ImageTwClass;n.x=this.ptFinishCard.x,n.y=this.ptFinishCard.y,n.setCardSource(i[1],i[2]),this.addChild(n);var a=this.getCardListViewWidth(),s=(this.cardGroup.width-a)/2,o=s+a-95,r=this.rectCard.y;n.createTw(new egret.Point(o,r),10,200,function(){e.contains(n)&&e.removeChild(n),e.finishCard.doUpdateCard(null,cardTypes.CARD_FINISH),e.finishCard.visible=!1,e.meErrorDeclare()})},e.prototype.playOtherErrorDeclareTw=function(t){var e=this,i=t.id,n=this.getUserHeadView(i),a=new ImageTwClass;a.x=this.ptFinishCard.x,a.y=this.ptFinishCard.y,this.addChild(a),a.createTw(new egret.Point(n.x,n.y),10,200,function(){e.finishCard.doUpdateCard(null,cardTypes.CARD_FINISH),e.finishCard.visible=!1,e.contains(a)&&e.removeChild(a)})},e.prototype.playFinishDeclareTw=function(t){var e=t.id,i=t.card,n=new CardData;if(n.init(i,this._battle.wildJokerData.num),this.finishCard.doUpdateCard(n,cardTypes.CARD_FINISH),this.finishCard.visible=!0,e==this._player.info.id)this.startDeclaring(null);else{var a=this.getUserHeadView(e);this.createWinTw(a.x-50,a.y+40)}},e.prototype.getUserHeadView=function(t){for(var e=null,i=0;i<this.userHeadAry.length;++i)if(e=this.userHeadAry[i],e.visible&&e.getUserId()==t)return e;return null},e.prototype.updateFoldCard=function(){this.outCard.visible=this._battle.foldList&&this._battle.foldList.length>0,this.outCard.visible&&this.outCard.doUpdateCard(this._battle.foldList[0],cardTypes.CARD_FOLD)},e.prototype.removeCard=function(){for(var t=0;t<this.cardsAry.length;++t)this.cardsAry[t].visible=!1;for(t=0;t<this.groupTipsAry.length;++t)this.groupTipsAry[t].visible=!1,this.groupTipsLabelAry[t].visible=!1;for(t=0;t<this.pokerTipAry.length;++t)this.pokerTipAry[t].visible=!1},e.prototype.foldHandsCard=function(){for(var t=0;t<this.cardsAry.length;++t)this.cardsAry[t].doUpdateCard(null,cardTypes.CARD_ME);for(t=0;t<this.groupTipsAry.length;++t)this.groupTipsAry[t].visible=!1,this.groupTipsLabelAry[t].visible=!1;for(t=0;t<this.pokerTipAry.length;++t)this.pokerTipAry[t].visible=!1},e.prototype.onMoveStart=function(t){this.moveCard=t.currentTarget,this.moveCard.childIndex=this.cardGroup.getChildIndex(this.moveCard),this.offsetX=t.stageX-this.moveCard.x,this.offsetY=t.stageY-this.moveCard.y},e.prototype.onMoveCard=function(t){if(this.moveCard){if(this.cardGroup.setChildIndex(this.moveCard,999),this.moveCard.x=t.stageX-this.offsetX,this.moveCard.y=t.stageY-this.offsetY,this.moveCard.x<this.moveCard.xpos)for(var e=this.moveCard.cardIndex-1;e>=0;e--)this.moveCard.x<this.cardsAry[e].xpos?this.cardsAry[e].x=this.cardsAry[e].xpos+65:this.cardsAry[e].x=this.cardsAry[e].xpos;else for(var e=this.moveCard.cardIndex+1;e<this.cardsAry.length;e++)this.moveCard.x>this.cardsAry[e].xpos?this.cardsAry[e].x=this.cardsAry[e].xpos-65:this.cardsAry[e].x=this.cardsAry[e].xpos;this.grpSingleGroup.visible=!0}},e.prototype.onMoveCancel=function(t){this.onMoveOut(null)},e.prototype.onMoveOut=function(t){this.cardGroup.setChildIndex(this.moveCard,this.moveCard.childIndex);for(var e=0;e<this.cardsAry.length;e++)this.cardsAry[e].x=this.cardsAry[e].xpos,this.cardsAry[e].y=this.cardsAry[e].ypos;this.grpSingleGroup.visible=!1},e.prototype.onMoveEnd=function(t){var e=this._battle.getCardGroupList();if(this.cardGroup.setChildIndex(this.moveCard,this.moveCard.childIndex),Math.abs(this.moveCard.x-this.moveCard.xpos)>10||Math.abs(this.moveCard.y-this.moveCard.ypos)>10){var i=-1,n=-1;if(this.moveCard.x<this.cardsAry[0].xpos)i=0,n=0;else if(this.moveCard.x>=this.grpSingleGroup.x)i=this._battle.getCardGroupList().length,n=0;else{for(var a=99999,s=null,o=0;o<this.cardsAry.length;o++)Math.abs(this.cardsAry[o].xpos-this.moveCard.x)<a&&(a=Math.abs(this.cardsAry[o].xpos-this.moveCard.x),s=this.cardsAry[o]);i=s.cardData.groupIndex,n=this.moveCard.x>s.xpos?s.cardData.cardIndex+1:s.cardData.cardIndex}if(this.moveCard.cardData.groupIndex==i&&this.moveCard.cardData.cardIndex==n||-1==i||-1==n)for(var o=0;o<this.cardsAry.length;o++)this.cardsAry[o].x=this.cardsAry[o].xpos,this.cardsAry[o].y=this.cardsAry[o].ypos;else{e[i];if(this.moveCard.cardData.groupIndex==i&&this.moveCard.cardData.cardIndex+1==n)for(var o=0;o<this.cardsAry.length;o++)this.cardsAry[o].x=this.cardsAry[o].xpos,this.cardsAry[o].y=this.cardsAry[o].ypos;else BattleController.getInstance().movePoker(this.moveCard.cardData,i,n)}}else this.moveCard.x=this.moveCard.xpos,this.moveCard.y=this.moveCard.ypos,this.moveCard.selectCard();this.grpSingleGroup.visible=!1},e.prototype.doCreateCard=function(){for(var t=null,e=0;e<this.cardsAry.length;++e)t=this.cardsAry[e],t.visible=!1;for(var i=null,e=0;e<this.pokerTipAry.length;++e)i=this.pokerTipAry[e],i.visible=!1;for(var n=0,a=(this.cardGroup.width-this.getCardListViewWidth())/2-50,s=null,o=this._battle.getCardGroupList(),r=0;r<o.length;r++){var h=o[r],l=h.cardList,c=this.pokerTipAry[r];c||(c=new PokerTip,this.pokerTipAry.push(c),this.cardGroup.addChild(c)),c.visible=!0,c.showPokerTip(h),l.length>1?c.x=a+(l.length*this.gap_poker+(95-this.gap_poker)-c.width)/2:c.x=a,c.y=this.rectCard.y-40;for(var d=0;d<l.length;d++){l[d];s=this.cardsAry[n],s||(this.cardGroup.addChild(s=new CardView),s.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onMoveStart,this),s.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.onMoveCard,this),s.addEventListener(egret.TouchEvent.TOUCH_END,this.onMoveEnd,this),s.addEventListener(egret.TouchEvent.TOUCH_CANCEL,this.onMoveCancel,this),s.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.onMoveOut,this),this.cardsAry.push(s)),s.cardIndex=n,s.visible=!0,s.doUpdateCard(l[d],cardTypes.CARD_ME),s.x=a,s.y=this.rectCard.y,s.xpos=s.x,s.ypos=s.y,s.clearSelect(),n++,a+=this.gap_poker}a+=this.gap_group,a+=95-this.gap_poker}this.updateGroupTip()},e.prototype.getCardListViewWidth=function(){for(var t=0,e=this._battle.getCardGroupList(),i=0;i<e.length;i++){var n=e[i];t+=n.cardList.length*this.gap_poker+(95-this.gap_poker)}return t+(e.length-1)*this.gap_group},e.prototype.onClickOutCard=function(t){if(0==this._game.btnLock()&&this.cardsAry.length>BattleConfig.have_Count&&this.btnDisCard.visible){for(var e=this.cardsAry.length-1,i=0,n=null,a=e;a>=0;--a)n=this.cardsAry[a],n.isCheck()&&i++;if(1==i)for(a=e;a>=0;--a)if(n=this.cardsAry[a],n.isCheck()){BattleController.getInstance().playPoker(n.cardData);break}}},e.prototype.gameTurn=function(t){},e.prototype.onDeclare=function(t){0==this._game.btnLock()&&BattleController.getInstance().declarePoker()},e.prototype.onClickDrop=function(t){if(0==this._game.btnLock()){if(this._game.currentRoom.type==ROOM_TYPE.POINT_RUMMY){var e=20;1==this._battle.isPlayed&&(e=40),Utils.showTextAlert("Drop Game Will lose "+e+" points","Game Notice",function(){BattleController.getInstance().dropGame()},lz.AlertType.YesNo)}(this._game.currentRoom.type==ROOM_TYPE.DEAL_RUMMY||this._game.currentRoom.type==ROOM_TYPE.POOL_RUMMY)&&(this._game.currentRoom.mode==ROOM_MODE.CASH_MODE?Utils.showTextAlert("Drop Game Will lose "+this._game.currentRoom.entry_fee+" cash","Game Notice",function(){BattleController.getInstance().dropGame()},lz.AlertType.YesNo):Utils.showTextAlert("Drop Game Will lose "+this._game.currentRoom.entry_fee+" chips","Game Notice",function(){BattleController.getInstance().dropGame()},lz.AlertType.YesNo))}},e.prototype.onCilckBack=function(t){if(0==this._game.btnLock())if(this._battle.battleState==BATTLE_STATE.WAITING||this._player.info.playerState==PLAYER_STATE.DROP_GAME)BattleController.getInstance().leaveGame();else{if(this._game.currentRoom.type==ROOM_TYPE.POINT_RUMMY){var e=20;1==this._battle.isPlayed&&(e=40),Utils.showTextAlert("Leave Game Will lose "+e+" points","Game Notice",function(){BattleController.getInstance().leaveGame()},lz.AlertType.YesNo)}(this._game.currentRoom.type==ROOM_TYPE.DEAL_RUMMY||this._game.currentRoom.type==ROOM_TYPE.POOL_RUMMY)&&(this._game.currentRoom.mode==ROOM_MODE.CASH_MODE?Utils.showTextAlert("Leave Game Will lose "+this._game.currentRoom.entry_fee+" cash","Game Notice",function(){BattleController.getInstance().leaveGame()},lz.AlertType.YesNo):Utils.showTextAlert("Leave Game Will lose "+this._game.currentRoom.entry_fee+" chips","Game Notice",function(){BattleController.getInstance().leaveGame()},lz.AlertType.YesNo))}},e.prototype.checkBtnVis=function(){for(var t=this.cardsAry.length-1,e=0,i=null,n=t;n>=0;--n)i=this.cardsAry[n],i.isCheck()&&e++;this.btnGroup.visible=e>=2,this.btnDisCard.visible=this._player.info.playerState==PLAYER_STATE.DISCARDING&&1==e&&this._battle.cardList.length>BattleConfig.have_Count,this.btnFinish.visible=this._player.info.playerState==PLAYER_STATE.DISCARDING&&this.btnDisCard.visible},e.prototype.onClickGroup=function(t){if(0==this._game.btnLock()&&this.btnGroup.visible){for(var e=[],i=this.cardsAry.length-1,n=null,a=i;a>=0;--a)if(n=this.cardsAry[a],n.isCheck()){var s=[];s[0]=n.cardData.id,s[1]=n.cardData.groupIndex,s[2]=n.cardData.cardIndex,e.push(s)}BattleController.getInstance().groupPoker(e)}},e.prototype.onClickFinish=function(t){if(0==this._game.btnLock()&&this.cardsAry.length>BattleConfig.have_Count&&this.btnFinish.visible){for(var e=this.cardsAry.length-1,i=0,n=null,a=e;a>=0;--a)n=this.cardsAry[a],n.isCheck()&&i++;if(1==i)for(a=e;a>=0;--a)if(n=this.cardsAry[a],n.isCheck()){BattleController.getInstance().finishPoker(n.cardData);break}}},e.prototype.openResultView=function(t){0!=this._battle.isWinPlayOver&&(this._player.userId==t.userid?(this.resultView=new ResultView,lz.PopupManager.addPop(this.resultView),this.resultView.updateResultData(this._battle.resultData)):1==this._battle.declareList[t.userid]&&(console.log("更新记录"+t.userid),this.resultView.updateResultData(this._battle.resultData)))},e.prototype.meDropGame=function(){this.foldHandsCard(),this.battleNoticeGroup.visible=!0,this.labNoticeTip.text="You have dropped game, switch table?",this.btnNotice.visible=!1},e.prototype.meErrorDeclare=function(){AndroidManager.getInstance().trackEvent("battle_other","other_event","ERROR_DECLARE"),this.foldHandsCard(),this.battleNoticeGroup.visible=!0,this.labNoticeTip.text="You have error declare!",this.btnNotice.visible=!1},e.prototype.gameOver=function(t){0==lz.PopupManager.hasPop1("ResultView")&&(this.resultView=new ResultView,lz.PopupManager.addPop(this.resultView)),this.resultView.updateResultData(this._battle.resultData),this.resultView.gameOver(t)},e.prototype.showWin=function(t,e){this.winImg||(this.winImg=new eui.Image,this.winImg.includeInLayout=!1,this.winImg.source="battle_json.win",this.addChild(this.winImg)),this.winImg.anchorOffsetX=this.winImg.width/2,this.winImg.anchorOffsetY=this.winImg.height/2,this.winImg.x=t,this.winImg.y=e,this.winImg.visible=!0},e.prototype.createWinTw=function(t,e){var i=this;this.showWin(t,e),this.winImg.scaleX=2,this.winImg.scaleY=2,egret.Tween.get(this.winImg).to({scaleX:1,scaleY:1},500,egret.Ease.sineIn).wait(500).call(function(){i.startDeclaring(null)})},e.prototype.startDeclaring=function(t){if(this._battle.isWinPlayOver=!0,this.nCombatType=COMBAT_TYPE.DECLARING,t){var e=new CardData;e.init(t,this._battle.wildJokerData.num),this.finishCard.doUpdateCard(e,cardTypes.CARD_FINISH),this.finishCard.visible=!0}this._player.info.playerState==PLAYER_STATE.DROP_GAME&&(0==lz.PopupManager.hasPop1("ResultView")&&(this.resultView=new ResultView,lz.PopupManager.addPop(this.resultView)),this.resultView.updateResultData(this._battle.resultData)),this.updateHead()},e.prototype.showGroupTip=function(){this.grpBattleTip.visible?this.grpBattleTip.visible=!1:this.grpBattleTip.visible=!0},e.prototype.updateGroupTip=function(){for(var t=0,e=0,i=0,n=this._battle.getCardGroupList(),a=0;a<n.length;a++){var s=n[a];s.groupType==GROUP_TYPE.PURE&&t++,s.groupType==GROUP_TYPE.SEQUENCE&&e++,s.groupType==GROUP_TYPE.SET&&i++}this.groupTipAry[0].showNull(),this.groupTipAry[1].showNull(),this.groupTipAry[2].showNull(),this.groupTipAry[3].showNull(),t>0&&(this.groupTipAry[0].showTip(),(e>0||t>1)&&(this.groupTipAry[1].showTip(),e+i+t>2&&this.groupTipAry[2].showTip(),e+i+t>3&&this.groupTipAry[3].showTip()))},e.prototype.showRecord=function(t){null==this.battleRecordView&&(this.battleRecordView=new BattleRecordView,this.addChild(this.battleRecordView)),this.battleRecordView.showBattleRecord(this._game.currentRoom.type,this._battle.recordData,this._game.currentRoom.finishDeal),this.battleRecordView.visible=!0},e.prototype.showBattleSettingView=function(){null==this.battleSettingView&&(this.battleSettingView=new BattleSettingView,this.addChild(this.battleSettingView)),this.battleSettingView.visible=!0,this.battleSettingView.updateView()},e.prototype.updateDelay=function(){this.labDelay.text=GameModel.gamePing+" ms",GameModel.gamePing<150?(this.imgDelay1.source="battle_json.battle_wifi_1",this.imgDelay2.source="battle_json.battle_wifi_2",this.imgDelay3.source="battle_json.battle_wifi_3",this.imgDelay4.source="battle_json.battle_wifi_4"):GameModel.gamePing>=150&&GameModel.gamePing<300?(this.imgDelay1.source="battle_json.battle_wifi_1",this.imgDelay2.source="battle_json.battle_wifi_2",this.imgDelay3.source="battle_json.battle_wifi_3",this.imgDelay4.source="battle_json.battle_wifi_44"):GameModel.gamePing>=300&&GameModel.gamePing<500?(this.imgDelay1.source="battle_json.battle_wifi_1",this.imgDelay2.source="battle_json.battle_wifi_2",this.imgDelay3.source="battle_json.battle_wifi_33",this.imgDelay4.source="battle_json.battle_wifi_44"):(this.imgDelay1.source="battle_json.battle_wifi_1",this.imgDelay2.source="battle_json.battle_wifi_22",this.imgDelay3.source="battle_json.battle_wifi_33",this.imgDelay4.source="battle_json.battle_wifi_44")},e}(BattleViewCE);__reflect(BattleView.prototype,"BattleView",["lz.IUpdateable"]);var ImageTwClass=function(t){function e(){var e=t.call(this)||this;return e.img=null,e.playTw=null,e.addChild(e.img=new eui.Image),e.img.includeInLayout=!1,e.img.source="battle_json.card_mask",e}return __extends(e,t),e.prototype.setCardData=function(t){this.cardData=t,this.setCardSource(t.num,t.type)},e.prototype.setCardSource=function(t,e){this.img.source="battle_json.card_"+t+"_"+e},e.prototype.setMaskSource=function(){this.img.source="battle_json.card_mask"},e.prototype.getCardData=function(){return this.cardData},e.prototype.createTw=function(t,e,i,n){this.clearTw(),this.playTw=egret.Tween.get(this),this.playTw.wait(e).to({x:t.x,y:t.y},i).call(function(){n&&n()})},e.prototype.createFlipTw=function(t,e,i){var n=this;this.img.source="battle_json.card_mask",this.img.skewY=180,this.img.x=this.img.width/2,this.img.anchorOffsetX=this.img.width/2,egret.Tween.get(this.img).to({skewY:270},200).call(function(){n.img.source="battle_json.card_"+t+"_"+e,egret.Tween.get(n.img).to({skewY:360},200).wait(100).call(function(){i&&i()})})},e.prototype.clearTw=function(){this.playTw&&(egret.Tween.removeTweens(this),this.playTw=null)},e}(eui.Component);__reflect(ImageTwClass.prototype,"ImageTwClass");var PokerTip=function(t){function e(){var e=t.call(this)||this;return e._img=new eui.Image,e._shape=new egret.Shape,e._text=new eui.Label,e.addChild(e._shape),e._text.size=18,e._img.source="battle_json.invalid",e._img.width=e._img.height=16,e._img.x=10,e._img.y=7,e.addChild(e._img),e.addChild(e._text),e}return __extends(e,t),e.prototype.showPokerTip=function(t){1==t.cardList.length?(this._shape.graphics.clear(),this._shape.graphics.beginFill(0),this._shape.graphics.drawRoundRect(0,0,95,30,20),this._shape.graphics.endFill(),this._text.text=t.groupScore+" Pts.",1==t.groupState?this._img.source="battle_json.valid":this._img.source="battle_json.invalid",this._shape.graphics.clear(),this._shape.graphics.beginFill(0),this._shape.graphics.drawRoundRect(0,0,this._img.width+this._text.width+30,30,20),this._shape.graphics.endFill()):(t.groupType==GROUP_TYPE.PURE?this._text.text="Pure Sequence（"+t.groupScore+"）":t.groupType==GROUP_TYPE.SEQUENCE?this._text.text="Sequence（"+t.groupScore+"）":t.groupType==GROUP_TYPE.SET?this._text.text="Set（"+t.groupScore+"）":this._text.text="Invalid（"+t.groupScore+"）",1==t.groupState?this._img.source="battle_json.valid":this._img.source="battle_json.invalid",this._shape.graphics.clear(),this._shape.graphics.beginFill(0),this._shape.graphics.drawRoundRect(0,0,this._img.width+this._text.width+20,30,20),this._shape.graphics.endFill()),this._text.x=33,this._text.y=6,this._shape.alpha=.7,this.visible=!0},e}(eui.Component);__reflect(PokerTip.prototype,"PokerTip");var AssetAdapter=function(){function t(){}return t.prototype.getAsset=function(t,e,i){function n(n){e.call(i,n,t)}if(RES.hasRes(t)){var a=RES.getRes(t);a?n(a):RES.getResAsync(t,n,this)}else RES.getResByUrl(t,n,this,RES.ResourceItem.TYPE_IMAGE)},t}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var CardView=function(t){function e(){var e=t.call(this)||this;return e.cardData=null,e.battle=DataCenter.getInstance().battle,e.player=DataCenter.getInstance().player,e.game=DataCenter.getInstance().game,e.cardType=0,e.skinName="CardSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.addEventListener(egret.TouchEvent.REMOVED_FROM_STAGE,this.doRemoveFunc,this),this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickCard,this)},e.prototype.doRemoveFunc=function(t){this.removeEventListener(egret.TouchEvent.REMOVED_FROM_STAGE,this.doRemoveFunc,this),this.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickCard,this)},e.prototype.doUpdateCard=function(t,e){this.cardType=e,this.cardData=t,this.imgCardJoker.visible=!1,this.labNum.text="",e==cardTypes.CARD_DESKTOP?(this.imgCardNum.source="battle_json.card_mask",this.visible=this.battle.closeCardCount>1):e==cardTypes.CARD_DESKTOP_JOKER?(this.visible=t&&t.id>-1,this.imgCardNum.source="battle_json.card_"+t.num+"_"+t.type):e==cardTypes.CARD_DELARE?t?this.imgCardNum.source="battle_json.card_"+t.num+"_"+t.type:this.imgCardNum.source="battle_json.card_mask":t?this.imgCardNum.source="battle_json.card_"+t.num+"_"+t.type:this.imgCardNum.source="battle_json.card_mask",this.cardGroup.y=t&&this.battle.newCardId==t.id&&e==cardTypes.CARD_ME?-30:0,this.imgCardJoker.visible=t&&t.isJoker&&t.num>0||e==cardTypes.CARD_DESKTOP_JOKER,e==cardTypes.CARD_TOSS&&(this.imgCardJoker.visible=!1),this.setTipCardVis()
},e.prototype.doUpdateTotalCard=function(t){this.visible=t>0,this.visible&&this.setTipCardVis()},e.prototype.isCheck=function(){return this.visible&&0!=this.cardGroup.y&&this.cardType==cardTypes.CARD_ME},e.prototype.selectCard=function(){this.cardGroup.y=0==this.cardGroup.y?-30:0},e.prototype.clearSelect=function(){this.cardGroup.y=0},e.prototype.onClickCard=function(t){this.cardType!=cardTypes.CARD_ME&&this.battle.curInfo&&this.battle.curInfo.id==this.player.info.id&&0==this.game.btnLock()&&(this.cardType==cardTypes.CARD_FOLD?this.battle.cardList.length==BattleConfig.have_Count&&BattleController.getInstance().drawPoker(this.cardType):this.cardType==cardTypes.CARD_DESKTOP?this.battle.cardList.length==BattleConfig.have_Count&&BattleController.getInstance().drawPoker(this.cardType):this.cardType==cardTypes.CARD_DESKTOP_JOKER&&1==this.battle.closeCardCount&&BattleController.getInstance().drawPoker(cardTypes.CARD_DESKTOP))},e.prototype.setTipCardVis=function(){return this.cardType==cardTypes.CARD_FINISH||this.cardType==cardTypes.CARD_DELARE||this.cardType==cardTypes.CARD_TOSS?void(this.imgTipsLight.visible=!1):this.player.info.playerState!=PLAYER_STATE.DRAWING||this.cardType!=cardTypes.CARD_DESKTOP&&this.cardType!=cardTypes.CARD_FOLD||!this.battle.isDealPlayOver?this.cardType==cardTypes.CARD_DESKTOP_JOKER&&1==this.battle.closeCardCount?void(this.imgTipsLight.visible=!0):void(this.imgTipsLight.visible=!1):void(this.imgTipsLight.visible=!0)},e.prototype.showTipsHighLight=function(){this.imgTipsLight.visible=!0},e.prototype.hideTipsHighLight=function(){this.imgTipsLight.visible=!1},e}(eui.Component);__reflect(CardView.prototype,"CardView");var cardTypes;!function(t){t[t.CARD_DESKTOP_JOKER=0]="CARD_DESKTOP_JOKER",t[t.CARD_DESKTOP=1]="CARD_DESKTOP",t[t.CARD_FOLD=2]="CARD_FOLD",t[t.CARD_ME=3]="CARD_ME",t[t.CARD_TOSS=4]="CARD_TOSS",t[t.CARD_FINISH=5]="CARD_FINISH",t[t.CARD_DELARE=6]="CARD_DELARE",t[t.CARD_MOVE=7]="CARD_MOVE",t[t.CARD_RESULT=8]="CARD_RESULT"}(cardTypes||(cardTypes={}));var ChatRecord=function(t){function e(e,i){var n=t.call(this)||this;n._player=DataCenter.getInstance().player;var a=700;return n.headImg=new eui.Image,n.headImg.y=0,n.headImg.width=60,n.headImg.height=60,n.headImg.source="game_json.avatar_master",n.chatLabel=new eui.Label,n.chatLabel.y=20,n.chatLabel.text=i,n.chatLabel.width>500&&(n.chatLabel.width=500),n.chatLabel.wordWrap=!0,n.chatLabel.lineSpacing=5,n.chatLabel.textColor=0,n.chatBack=new eui.Rect,n.chatBack.y=0,n.chatBack.width=n.chatLabel.width+40,n.chatBack.height=30*n.chatLabel.numLines+40+5*(n.chatLabel.numLines-1),n.chatBack.fillColor=16777215,n.chatBack.ellipseWidth=20,n.chatBack.ellipseHeight=20,2==e?(n.headImg.source="game_json.avatar_master",n.headImg.x=0,n.chatBack.x=70,n.chatLabel.x=90,n.chatBack.fillColor=16777215):(n.headImg.source=n._player.info.avatar,n.headImg.x=a-n.headImg.width,n.chatBack.x=a-70-n.chatBack.width,n.chatLabel.x=a-90-n.chatLabel.width,n.chatBack.fillColor=7585304),n.addChild(n.chatBack),n.addChild(n.headImg),n.addChild(n.chatLabel),n}return __extends(e,t),e}(eui.Component);__reflect(ChatRecord.prototype,"ChatRecord");var ChatView=function(t){function e(){var e=t.call(this)||this;return e._game=DataCenter.getInstance().game,e}return __extends(e,t),Object.defineProperty(e.prototype,"moduleName",{get:function(){return"ChatViewSkin"},enumerable:!0,configurable:!0}),e.prototype.notificationListeners=function(){return[GameEvent.UPDATE_USER_CHAT]},e.prototype.executeNotification=function(t,e,i){switch(t){case GameEvent.UPDATE_USER_CHAT:this.updateView()}},e.prototype.loadComplete=function(){t.prototype.loadComplete.call(this),this.btnSend.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSendText,this)},e.prototype.onRemoved=function(e){t.prototype.onRemoved.call(this,e),this.btnSend.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onSendText,this)},e.prototype.onSendText=function(t){return 0==this.inputSendText.text.length?void Utils.showMessageBox(LanguageConfig.CAN_NOT_SEND_NULL):void(0==this._game.btnLock(3e3)&&GameController.getInstance().addChat(this.inputSendText.text))},e.prototype.initView=function(){if(0==this._game.btnLock(3e3))if(0==this._game.chatList.length)GameController.getInstance().chatList(CHAT_ACTION.INIT_CHAT,0);else{var t=this._game.getChatCurrentIndex();GameController.getInstance().chatList(CHAT_ACTION.UPDATE_CHAT,t)}},e.prototype.updateView=function(){this.inputSendText.text="",this.grpContent.removeChildren();for(var t=0,e=this._game.chatList,i=0;i<e.length;i++){var n=e[i],a=new ChatRecord(n.type,n.text);a.x=0,a.y=t,this.grpContent.addChild(a),t+=a.height+30}t<this.contentScroller.viewport.height?this.contentScroller.viewport.scrollV=0:this.contentScroller.viewport.scrollV=t-this.contentScroller.viewport.height},e}(lz.BaseView);__reflect(ChatView.prototype,"ChatView");var MENU_ID;!function(t){t[t.WITHDRAWAL=0]="WITHDRAWAL",t[t.USER=1]="USER",t[t.ACCOUNT=2]="ACCOUNT",t[t.KYC=3]="KYC",t[t.TRANSACTION=4]="TRANSACTION",t[t.RULE=5]="RULE",t[t.BONUS=6]="BONUS",t[t.LOGOUT=7]="LOGOUT"}(MENU_ID||(MENU_ID={}));var AppHomeView=function(t){function e(){var e=t.call(this)||this;return e._app=DataCenter.getInstance().app,e._game=DataCenter.getInstance().game,e._player=DataCenter.getInstance().player,e.userMenu=null,e.accountMenu=null,e.withdrawalMenu=null,e.kycMenu=null,e.transactionMenu=null,e.ruleMenu=null,e}return __extends(e,t),Object.defineProperty(e.prototype,"moduleName",{get:function(){return"AppHomeSkin"},enumerable:!0,configurable:!0}),e.prototype.notificationListeners=function(){return[GameEvent.UPDATA_PLAYERDATA,GameEvent.OPEN_MENU,GameEvent.OPEN_SHARE,GameEvent.OPEN_BONUS,GameEvent.OPEN_CONTACT,GameEvent.UPDATA_LOGIN_BONUS,GameEvent.UPDATE_CONTACT]},e.prototype.executeNotification=function(t,e,i){switch(t){case GameEvent.UPDATA_PLAYERDATA:this.updatePlayerData();break;case GameEvent.OPEN_MENU:this.openMenu(e);break;case GameEvent.OPEN_SHARE:this.onShare(null);break;case GameEvent.OPEN_BONUS:this.onOpenBonus();break;case GameEvent.OPEN_CONTACT:this.onOpenContact();break;case GameEvent.UPDATA_LOGIN_BONUS:this.showRedpot();break;case GameEvent.UPDATE_CONTACT:this.onGetContact()}},e.prototype.onAdded=function(e){t.prototype.onAdded.call(this,e),this.lobbyView.updateView(),this.updatePlayerData(),this.shareView.visible=!1,this.bonusView.visible=!1,this.chatView.visible=!1,this.lobbyView.visible=!0,this.contactView.visible=!1},e.prototype.loadComplete=function(){t.prototype.loadComplete.call(this),this.grpGold.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onReloadGold,this),this.grp1.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onChat,this),this.grp2.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onLoginBonus,this),this.grp3.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onGoLobby,this),this.grp4.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onShare,this),this.grp5.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onOpenMenu,this),this.btnAddCash.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onAddCash,this),this.btnSetting.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onOpenSetting,this),this.btnSelf.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onOpenUserMenu,this),this.grpArea.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onShowLocation,this),this.labChips.text=Utils.getMoney(this._player.info.gold),this.labCash.text=Utils.getCash(this._player.info.cash),this.btnSelf.source=this._player.info.avatar,this.labUserName.text=this._player.info.name,this.menuTextCommon(),this.onGoLobby(null),this.showRedpot()},e.prototype.onRemoved=function(e){t.prototype.onRemoved.call(this,e),this.grpGold.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onReloadGold,this),this.grp1.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onChat,this),this.grp2.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onLoginBonus,this),this.grp3.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onGoLobby,this),this.grp4.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onShare,this),this.grp5.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onOpenMenu,this),this.btnAddCash.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onAddCash,this),this.btnSetting.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onOpenSetting,this),this.btnSelf.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onOpenUserMenu,this),this.grpArea.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onShowLocation,this)},e.prototype.updatePlayerData=function(){this.labUserName.text=this._player.info.name,this.labChips.text=Utils.getMoney(this._player.info.gold),this.labCash.text=Utils.getCash(this._player.info.cash),this.btnSelf.source=this._player.info.avatar},e.prototype.menuTextCommon=function(){this.labMenu1.size=20,this.labMenu2.size=20,this.labMenu3.size=20,this.labMenu4.size=20,this.labMenu5.size=20,this.labMenu1.textColor=12369084,this.labMenu2.textColor=12369084,this.labMenu3.textColor=12369084,this.labMenu4.textColor=12369084,this.labMenu5.textColor=12369084,this.reddot1.visible=!1,this.reddot2.visible=!1,this.reddot3.visible=!1,this.reddot4.visible=!1,this.reddot5.visible=!1,this.showRedpot()},e.prototype.onOpenSetting=function(t){lz.PopupManager.addPop(new SettingView)},e.prototype.onOpenUserMenu=function(t){var e={menuid:MENU_ID.USER};this.openMenu(e)},e.prototype.onAddCash=function(t){lz.Facade.sendNotification(lz.GameFrameEvent.OPEN_VIEW,GameViewType.AppPay,"open")},e.prototype.onChat=function(t){this.closeMenu(),this.menuTextCommon(),this.chatView.initView(),this.chatView.visible=!0,this.shareView.visible=!1,this.lobbyView.visible=!1,this.bonusView.visible=!1,this.contactView.visible=!1,this.labMenu1.size=24,this.labMenu1.textColor=16777215},e.prototype.onLoginBonus=function(){lz.PopupManager.addPop(new LoginBonusView)},e.prototype.onGoLobby=function(t){this.closeMenu(),this.menuTextCommon(),this.chatView.visible=!1,this.shareView.visible=!1,this.lobbyView.visible=!0,this.bonusView.visible=!1,this.contactView.visible=!1,this.labMenu3.size=24,this.labMenu3.textColor=16777215},e.prototype.onShare=function(t){this.closeMenu(),this.menuTextCommon(),this.shareView.visible=!0,this.chatView.visible=!1,this.lobbyView.visible=!1,this.bonusView.visible=!1,this.contactView.visible=!1,this.labMenu4.size=24,this.labMenu4.textColor=16777215},e.prototype.onOpenBonus=function(){this.closeMenu(),this.shareView.visible=!1,this.chatView.visible=!1,this.lobbyView.visible=!1,this.bonusView.visible=!0,this.contactView.visible=!1,this.bonusView.getBonusList()},e.prototype.onOpenContact=function(){0==this._game.btnLock(3e3)&&AndroidManager.getInstance().getContactList()},e.prototype.onGetContact=function(){this.closeMenu(),this.shareView.visible=!1,this.chatView.visible=!1,this.lobbyView.visible=!1,this.bonusView.visible=!1,this.contactView.visible=!0,this.contactView.showList()},e.prototype.onOpenMenu=function(t){var e=new AppMenuView;lz.PopupManager.addPop(e)},e.prototype.closeMenu=function(){this.userMenu&&(this.userMenu.visible=!1),this.accountMenu&&(this.accountMenu.visible=!1),this.withdrawalMenu&&(this.withdrawalMenu.visible=!1),this.kycMenu&&(this.kycMenu.visible=!1),this.transactionMenu&&(this.transactionMenu.visible=!1),this.ruleMenu&&(this.ruleMenu.visible=!1)},e.prototype.openMenu=function(t){this.chatView.visible=!1,this.lobbyView.visible=!1,this.closeMenu();var e=t.menuid;e==MENU_ID.WITHDRAWAL&&(null==this.withdrawalMenu&&(this.withdrawalMenu=new AppWithdrawView,this.grpContainer.addChild(this.withdrawalMenu)),this.withdrawalMenu.visible=!0),e==MENU_ID.USER&&(null==this.userMenu&&(this.userMenu=new AppUserView,this.grpContainer.addChild(this.userMenu)),this.userMenu.visible=!0),e==MENU_ID.ACCOUNT&&(null==this.accountMenu&&(this.accountMenu=new AppAccountView,this.grpContainer.addChild(this.accountMenu)),this.accountMenu.visible=!0),e==MENU_ID.KYC&&(null==this.kycMenu&&(this.kycMenu=new AppKYCView,this.grpContainer.addChild(this.kycMenu)),this.kycMenu.visible=!0),e==MENU_ID.TRANSACTION&&(null==this.transactionMenu&&(this.transactionMenu=new AppTransactionView,this.grpContainer.addChild(this.transactionMenu)),this.transactionMenu.visible=!0,0==this._game.btnLock(3e3)&&GameController.getInstance().transactionList(1)),e==MENU_ID.RULE&&(null==this.ruleMenu&&(this.ruleMenu=new AppRuleView,this.grpContainer.addChild(this.ruleMenu)),this.ruleMenu.visible=!0),e==MENU_ID.BONUS&&this.onOpenBonus(),e==MENU_ID.LOGOUT&&lz.Facade.sendNotification(lz.GameFrameEvent.OPEN_VIEW,GameViewType.AppLogin,"open")},e.prototype.onReloadGold=function(t){return this._player.info.gold>=1e4?void Utils.showMessageBox(LanguageConfig.RELOAD_GOLD_SUCCESS):void(0==this._game.btnLock()?GameController.getInstance().reloadGold():Utils.showMessageBox(LanguageConfig.TAG_TRY_LATER))},e.prototype.onShowLocation=function(t){lz.PopupManager.addPop(new ServiceAreaView)},e.prototype.showRedpot=function(){this._game.loginBonusDay<5&&0==this._game.loginBonusTime?this.reddot2.visible=!0:this.reddot2.visible=!1},e}(lz.BaseView);__reflect(AppHomeView.prototype,"AppHomeView");var BindMobileView=function(t){function e(){var e=t.call(this)||this;return e._game=DataCenter.getInstance().game,e._player=DataCenter.getInstance().player,e}return __extends(e,t),Object.defineProperty(e.prototype,"moduleName",{get:function(){return"BindMobileSkin"},enumerable:!0,configurable:!0}),e.prototype.notificationListeners=function(){return[GameEvent.START_COUNT_DOWN,GameEvent.UPDATA_PLAYERDATA]},e.prototype.executeNotification=function(t,e,i){switch(t){case GameEvent.START_COUNT_DOWN:this._game.smsTime=(new Date).getTime()+60,this.startCountDown(60);break;case GameEvent.UPDATA_PLAYERDATA:10==this._player.mobile.length&&lz.PopupManager.delPop(this)}},e.prototype.loadComplete=function(){t.prototype.loadComplete.call(this),this.btnClose.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickClose,this),this.btnSend.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSendSMS,this),this.btnBindMobile.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBindMobile,this);var e=(new Date).getTime();if(e<this._game.smsTime){var i=Math.floor((this._game.smsTime-e)/1e3);this.startCountDown(i)}},e.prototype.onRemoved=function(e){t.prototype.onRemoved.call(this,e),this.btnClose.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickClose,this),this.btnSend.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onSendSMS,this),this.btnBindMobile.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onBindMobile,this),null!=this.timer&&(this.timer.stop(),this.timer.removeEventListener(egret.TimerEvent.TIMER,this.onCountDown,this))},e.prototype.startCountDown=function(t){this.countDownNumber=t,this.btnSend.label=this.countDownNumber+"",null!=this.timer&&(this.timer.stop(),this.timer.removeEventListener(egret.TimerEvent.TIMER,this.onCountDown,this)),this.timer=new egret.Timer(1e3,this.countDownNumber),this.timer.addEventListener(egret.TimerEvent.TIMER,this.onCountDown,this),this.timer.start()},e.prototype.onCountDown=function(){this.countDownNumber-=1,this.btnSend.label=this.countDownNumber+"",this.countDownNumber<=0&&(this.timer.stop(),this._game.smsTime=0,this.btnSend.label="Send")},e.prototype.onClickClose=function(t){lz.PopupManager.delPop(this)},e.prototype.onSendSMS=function(t){var e=(new Date).getTime();return this.countDownNumber>0||e<this._game.smsTime?void Utils.showMessageBox(LanguageConfig.SMS_COUNTDOWN):void(10==this.inputMobile.text.length?0==this._game.btnLock()&&(this._game.saveSmsTime(),this.startCountDown(60),LoginController.getInstance().sendSMS(this.inputMobile.text)):Utils.showMessageBox(LanguageConfig.TAG_PHONE_ERROR))},e.prototype.onBindMobile=function(t){if(6==this.inputOTP.text.length&&10==this.inputMobile.text.length){var e=this.inputMobile.text,i=this.inputOTP.text,n={};n.nickname=null,n.mobile=e,n.code=i,n.avatar=null,n.fb_id=null,n.google_id=null,0==this._game.btnLock(2e3)&&GameController.getInstance().modifyUserData(n)}else Utils.showMessageBox(LanguageConfig.TAG_CODE_ERROR)},e}(lz.BaseView);__reflect(BindMobileView.prototype,"BindMobileView");var LoginBonusView=function(t){function e(){var e=t.call(this)||this;return e._game=DataCenter.getInstance().game,e.labList=[],e.btnList=[],e}return __extends(e,t),Object.defineProperty(e.prototype,"moduleName",{get:function(){return"LoginBonusSkin"},enumerable:!0,configurable:!0}),e.prototype.notificationListeners=function(){return[GameEvent.UPDATA_LOGIN_BONUS]},e.prototype.executeNotification=function(t,e,i){switch(t){case GameEvent.UPDATA_LOGIN_BONUS:this.showCollectStatus()}},e.prototype.loadComplete=function(){t.prototype.loadComplete.call(this),this.btnClose.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickClose,this),this.rectBack.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickClose,this),this.btnCollect1.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onCollectBonus,this),this.btnCollect2.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onCollectBonus,this),this.btnCollect3.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onCollectBonus,this),this.btnCollect4.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onCollectBonus,this),this.btnCollect5.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onCollectBonus,this),this.btnList=[this.btnCollect1,this.btnCollect2,this.btnCollect3,this.btnCollect4,this.btnCollect5],this.labList=[this.labTime1,this.labTime2,this.labTime3,this.labTime4,this.labTime5],this.showCollectStatus()},e.prototype.onRemoved=function(e){t.prototype.onRemoved.call(this,e),this.btnClose.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickClose,this),this.rectBack.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickClose,this),this.btnCollect1.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onCollectBonus,this),this.btnCollect2.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onCollectBonus,this),this.btnCollect3.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onCollectBonus,this),this.btnCollect4.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onCollectBonus,this),this.btnCollect5.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onCollectBonus,this)},e.prototype.showCollectStatus=function(){for(var t=this._game.loginBonusDay,e=this._game.loginBonusTime,i=(new Date).getTime(),n=0;5>n;n++)if(this.labList[n].visible=!1,t==n?(this.btnList[n].enabled=!0,this.btnList[n].label="Collect"):n>t?(this.btnList[n].enabled=!1,this.btnList[n].label="Close"):(this.btnList[n].enabled=!1,this.btnList[n].label="Collected"),n==t&&e>i){var a=(e-i)/1e3,s=Math.floor(a/3600),o=Math.floor((a-3600*s)/60),r="";r=s>0?"Open after "+s+" hours":o>0?"Open after "+o+" minutes":"Open after 1 minute",this.labList[n].text=r,this.labList[n].visible=!0}},e.prototype.onCollectBonus=function(t){0==this._game.btnLock()&&GameController.getInstance().collectLoginBonus()},e.prototype.onClickClose=function(t){lz.PopupManager.delPop(this)},e}(lz.BaseView);__reflect(LoginBonusView.prototype,"LoginBonusView");var LoadingView=function(t){function e(){var e=t.call(this)||this;return e.androidUpgradeUrl="",e.androidUpgradeType=0,e._app=DataCenter.getInstance().app,e.count=0,e}return __extends(e,t),Object.defineProperty(e.prototype,"moduleName",{get:function(){return"LoadingViewSkin"},enumerable:!0,configurable:!0}),e.prototype.notificationListeners=function(){return[GameEvent.GAME_VERSION]},e.prototype.executeNotification=function(t,e,i){switch(t){case GameEvent.GAME_VERSION:this.handleGameVersion(e)}},e.prototype.loadComplete=function(){var e=this;t.prototype.loadComplete.call(this),this.loadingBar=new lz.UIProgressBar("loading_json.loadingBar_2","loading_json.loadingBar_1"),this.loadingBar.y=880,this.loadingBar.width=650,this.loadingBar.horizontalCenter=0,this.addChild(this.loadingBar),this.loadingBar.value=0,this.tipText=new eui.Label,this.tipText.x=this.loadingBar.x+100,this.tipText.y=this.loadingBar.y+60,this.tipText.text="Check update,Please wait...",this.addChild(this.tipText),this.grpUpgrade.visible=!1,egret.ExternalInterface.addCallback("sendToJS",function(t){e.nativeCallJs(t)}),lz.GameGlobal.gameType=-1},e.prototype.onRemoved=function(e){t.prototype.onRemoved.call(this,e)},e.prototype.onProgress=function(t,e){this.loadingBar&&(this.loadingBar.value=t/e*100)},e.prototype.startLoading=function(){0==lz.GameConfig.channel?this.createGameScene():LoginController.getInstance().getGameVersion()},e.prototype.handleGameVersion=function(t){var e=t.state;if(0==e&&t.version_data){var i=t.version_data;this.checkUpdate(i)}else this.count+=1,3==this.count?this.tipText.text="Server is currently under maintenance.":LoginController.getInstance().getGameVersion()},e.prototype.checkUpdate=function(t){var e={name:"check_update",remote_game_version:t.game_version,remote_game_url:t.game_url,game_force:t.game_force,remote_android_version_code:t.android_version_code,remote_android_url:t.android_url,android_force:t.android_force};this.jsCallNative(e)},e.prototype.nativeCallJs=function(t){console.log("jj------egret--------->nativeCallJs:",t);var e=JSON.parse(t.trim());switch(e.name){case"check_update":this.checkUpdateResult(e);break;case"update_progress":this.showUpdateProgress(e);break;case"ready_for_restart":this.updateCompleteToRestart();break;case"update_failed":this.updateFailed(e)}},e.prototype.jsCallNative=function(t){console.log("jj------egret--------->jsCallNative:",JSON.stringify(t)),egret.ExternalInterface.call("sendToNative",JSON.stringify(t))},e.prototype.updateCompleteToRestart=function(){this.tipText.text="Update complete.Please wait.",console.log("jj------egret--------->goToRestart"),this.jsCallNative({name:"start_after_update"})},e.prototype.updateFailed=function(t){LoginController.getInstance().errorReport(t.step),console.log("jj------egret--------->update failed:",t.step),this.tipText.text="Update Failue,Pleare retry later","ERROR_MANIFEST_NOT_READ"==t.step?this.showReInstall():this.showReStart()},e.prototype.checkUpdateResult=function(t){if(1==t.android_need_update)return void this.showAndroidUpdate(t);if(1==t.game_need_update){console.log("jj------egret--------->checkUpdate:","has update!");var e=t.game_update_url;this.jsCallNative({name:"start_update",game_update_url:e})}else console.log("jj------egret--------->checkUpdate:","no update"),this.createGameScene()},e.prototype.showUpdateProgress=function(t){var e=t.progress,i=t.total;this.onProgress(e,i)},e.prototype.createGameScene=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return this.tipText.text="Connect to server...",[4,RES.loadGroup("preload",0,this)];case 1:return t.sent(),lz.GameGlobal.initGame(this),lz.GameGlobal.gameLayer.addChild(new GameView),LoginController.getInstance().startLogin(),[2]}})})},e.prototype.showAndroidUpdate=function(t){this.grpUpgrade.visible=!0,this.imgNotice.source="loading_json.upgrade_icon",this.labNotice.text="Jaldi Rummy App needs an upgrade.",this.btnUpgrade.label="Upgrade Now",this.androidUpgradeUrl=t.android_update_url,this.androidUpgradeType=t.android_update_type,this.btnUpgrade.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onAndroidUpgrade,this),this.loadingBar.visible=!1,this.tipText.visible=!1},e.prototype.showReInstall=function(){this.grpUpgrade.visible=!0,this.imgNotice.source="loading_json.error_icon",this.labNotice.text="App corruption! Please reinstall",this.btnUpgrade.label="Reinstall Now",this.btnUpgrade.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onReinstall,this),this.loadingBar.visible=!1,this.tipText.visible=!1},e.prototype.showReStart=function(){this.grpUpgrade.visible=!0,this.imgNotice.source="loading_json.error_icon",this.labNotice.text="The app encountered an error and needs to be restarted",this.btnUpgrade.label="Restart Now",this.btnUpgrade.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onRestart,this),this.loadingBar.visible=!1,this.tipText.visible=!1},e.prototype.onAndroidUpgrade=function(t){var e={name:"android_upgrade",android_upgrade_url:this.androidUpgradeUrl,android_upgrade_type:this.androidUpgradeType};this.jsCallNative(e)},e.prototype.onReinstall=function(t){var e={name:"reinstall"};this.jsCallNative(e)},e.prototype.onRestart=function(t){var e={name:"restart"};this.jsCallNative(e)},e}(lz.BaseView);__reflect(LoadingView.prototype,"LoadingView",["RES.PromiseTaskReporter"]);var AppDealRummyView=function(t){function e(){var e=t.call(this)||this;return e._game=DataCenter.getInstance().game,e._player=DataCenter.getInstance().player,e._labValueList=[],e._switcherPos=[90,154,220,284,349,415,478,544,610],e}return __extends(e,t),Object.defineProperty(e.prototype,"moduleName",{get:function(){return"AppDealRummySkin"},enumerable:!0,configurable:!0}),e.prototype.loadComplete=function(){t.prototype.loadComplete.call(this),this.btnJia.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onAddLevel,this),this.btnJian.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onReduceLevel,this),this.btnRect1.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSetLevel1,this),this.btnRect2.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSetLevel2,this),this.btnRect3.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSetLevel3,this),this.btnRect4.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSetLevel4,this),this.btnRect5.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSetLevel5,this),this.btnRect6.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSetLevel6,this),this.btnRect7.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSetLevel7,this),this.btnRect8.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSetLevel8,this),this.btnRect9.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSetLevel9,this),this.btnDeal2.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onChangeDeal2,this),this.btnDeal3.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onChangeDeal3,this),this.btnEnter.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onEnterGame,this),this._labValueList=[this.labValue1,this.labValue2,this.labValue3,this.labValue4,this.labValue5,this.labValue6,this.labValue7,this.labValue8,this.labValue9]},e.prototype.onRemoved=function(e){t.prototype.onRemoved.call(this,e),this.btnJia.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onAddLevel,this),this.btnJian.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onReduceLevel,this),this.btnRect1.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onSetLevel1,this),this.btnRect2.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onSetLevel2,this),this.btnRect3.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onSetLevel3,this),this.btnRect4.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onSetLevel4,this),this.btnRect5.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onSetLevel5,this),this.btnRect6.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onSetLevel6,this),this.btnRect7.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onSetLevel7,this),this.btnRect8.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onSetLevel8,this),this.btnRect9.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onSetLevel9,this),this.btnDeal2.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onChangeDeal2,this),this.btnDeal3.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onChangeDeal3,this),this.btnEnter.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onEnterGame,this)},e.prototype.initView=function(){if(this.setCurrentLevel(1),this.setCurrentDeal(2),this._game.mode==ROOM_MODE.GOLD_MODE){var t=this._game.goldRummyConfig[2]/100;this.grpSelectEntry.visible=!1,this.labMinEntry.text="Min Entry： "+t,this.btnEnter.label="Chips Play Now"}else{this.grpSelectEntry.visible=!0;for(var e=this._game.dealRummyConfig,i=0;i<e.length;i++){var n=e[i]/100,a=this._labValueList[i];this._player.info.cash>=n&&this.setCurrentLevel(i+1),a.text=String(n)}this.btnEnter.label="Cash Play Now"}},e.prototype.setCurrentDeal=function(t){3==t?(this._currentDeal=3,this.selectBack.x=140,this.labDealCount2.textColor=16777215,this.labDeals2.textColor=16777215,this.labDealCount3.textColor=0,this.labDeals3.textColor=0):(this._currentDeal=2,this.selectBack.x=5,this.labDealCount2.textColor=0,this.labDeals2.textColor=0,this.labDealCount3.textColor=16777215,this.labDeals3.textColor=16777215)},e.prototype.setCurrentLevel=function(t){t>=this._labValueList.length?this._currentLevel=this._labValueList.length:1>t?this._currentLevel=1:this._currentLevel=t,this.btnSwitcher.x=this._switcherPos[this._currentLevel-1];var e=this._game.dealRummyConfig[this._currentLevel-1]/100;this.btnEnter.enabled=!0,this._game.mode==ROOM_MODE.GOLD_MODE&&(this.labMinEntry.text="Min Entry： "+e,e>this._player.info.gold&&(this.btnEnter.enabled=!1)),this._game.mode==ROOM_MODE.CASH_MODE&&(this.labMinEntry.text="Min Entry： ₹ "+e,e>this._player.info.cash&&(this.btnEnter.enabled=!1))},e.prototype.onAddLevel=function(t){this.setCurrentLevel(this._currentLevel+1)},e.prototype.onReduceLevel=function(t){this.setCurrentLevel(this._currentLevel-1)},e.prototype.onChangeDeal2=function(t){this.setCurrentDeal(2)},e.prototype.onChangeDeal3=function(t){this.setCurrentDeal(3)},e.prototype.onEnterGame=function(t){0==this._game.btnLock()&&GameController.getInstance().fastGame(this._game.mode,ROOM_TYPE.DEAL_RUMMY,this._currentLevel,this._currentDeal,2)},e.prototype.onSetLevel1=function(t){this.setCurrentLevel(1)},e.prototype.onSetLevel2=function(t){this.setCurrentLevel(2)},e.prototype.onSetLevel3=function(t){this.setCurrentLevel(3)},e.prototype.onSetLevel4=function(t){this.setCurrentLevel(4)},e.prototype.onSetLevel5=function(t){this.setCurrentLevel(5)},e.prototype.onSetLevel6=function(t){this.setCurrentLevel(6)},e.prototype.onSetLevel7=function(t){this.setCurrentLevel(7)},e.prototype.onSetLevel8=function(t){this.setCurrentLevel(8)},e.prototype.onSetLevel9=function(t){this.setCurrentLevel(9)},e}(lz.BaseView);__reflect(AppDealRummyView.prototype,"AppDealRummyView");var AppLobbyView=function(t){function e(){var e=t.call(this)||this;return e._app=DataCenter.getInstance().app,e._game=DataCenter.getInstance().game,e}return __extends(e,t),Object.defineProperty(e.prototype,"moduleName",{get:function(){return"AppLobbyViewSkin"},enumerable:!0,configurable:!0}),e.prototype.loadComplete=function(){t.prototype.loadComplete.call(this),this.tab1.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSelectType1,this),this.tab2.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSelectType2,this),this.tab3.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSelectType3,this),this.grpChipTab.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSelectMode1,this),this.grpCashTab.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSelectMode2,this),this.grpTournamentsTab.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSelectMode3,this)},e.prototype.onRemoved=function(e){t.prototype.onRemoved.call(this,e),this.tab1.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onSelectType1,this),this.tab2.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onSelectType2,this),this.tab3.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onSelectType3,this),this.rectChip.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onSelectMode1,this),this.rectCash.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onSelectMode2,this),this.grpTournamentsTab.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onSelectMode3,this)},e.prototype.onSelectType1=function(t){this._game.type=ROOM_TYPE.POINT_RUMMY,this.updateView()},e.prototype.onSelectType2=function(t){this._game.type=ROOM_TYPE.POOL_RUMMY,this.updateView()},e.prototype.onSelectType3=function(t){this._game.type=ROOM_TYPE.DEAL_RUMMY,this.updateView()},e.prototype.onSelectMode1=function(t){this._game.mode=ROOM_MODE.GOLD_MODE,this.updateView()},e.prototype.onSelectMode2=function(t){this._game.mode=ROOM_MODE.CASH_MODE,this.updateView()},e.prototype.onSelectMode3=function(t){this._game.mode=ROOM_MODE.TOURNAMENTS_MODE,this.updateView()},e.prototype.showViewMode=function(){this._game.mode==ROOM_MODE.GOLD_MODE&&(this.rectChip.fillColor=9785885,this.rectCash.fillColor=4472893,this.rectTournaments.fillColor=4472893,this.rectSelect.x=240,this.labPractise.scaleX=this.labPractise.scaleY=1.2,this.labCash.scaleX=this.labCash.scaleY=1,this.labTournament.scaleX=this.labTournament.scaleY=1,this.labPractise.textColor=14590054,this.labCash.textColor=16777215,this.labTournament.textColor=16777215),this._game.mode==ROOM_MODE.CASH_MODE&&(this.rectChip.fillColor=4472893,this.rectCash.fillColor=9785885,this.rectTournaments.fillColor=4472893,this.rectSelect.x=0,this.labPractise.scaleX=this.labPractise.scaleY=1,this.labCash.scaleX=this.labCash.scaleY=1.2,this.labTournament.scaleX=this.labTournament.scaleY=1,this.labPractise.textColor=16777215,this.labCash.textColor=14590054,this.labTournament.textColor=16777215),this._game.mode==ROOM_MODE.TOURNAMENTS_MODE&&(this.rectChip.fillColor=4472893,this.rectCash.fillColor=4472893,this.rectTournaments.fillColor=9785885,this.grpMain.visible=!1,this.grpTournaments.visible=!0,this.rectSelect.x=480,this.labPractise.scaleX=this.labPractise.scaleY=1,this.labCash.scaleX=this.labCash.scaleY=1,this.labTournament.scaleX=this.labTournament.scaleY=1.2,this.labPractise.textColor=16777215,this.labCash.textColor=16777215,this.labTournament.textColor=14590054)
},e.prototype.updateView=function(){this.grpMain.visible=!0,this.grpTournaments.visible=!1,this._game.type==ROOM_TYPE.POINT_RUMMY&&(this.tab1.source="game_json.tab",this.tab2.source="game_json.tab2",this.tab3.source="game_json.tab2",this.pointView.visible=!0,this.poolView.visible=!1,this.dealView.visible=!1,this.pointView.initView()),this._game.type==ROOM_TYPE.POOL_RUMMY&&(this.tab1.source="game_json.tab2",this.tab2.source="game_json.tab",this.tab3.source="game_json.tab2",this.pointView.visible=!1,this.poolView.visible=!0,this.dealView.visible=!1,this.poolView.initView()),this._game.type==ROOM_TYPE.DEAL_RUMMY&&(this.tab1.source="game_json.tab2",this.tab2.source="game_json.tab2",this.tab3.source="game_json.tab",this.pointView.visible=!1,this.poolView.visible=!1,this.dealView.visible=!0,this.dealView.initView()),this.showViewMode()},e}(lz.BaseView);__reflect(AppLobbyView.prototype,"AppLobbyView");var AppPointRummyView=function(t){function e(){var e=t.call(this)||this;return e._game=DataCenter.getInstance().game,e._player=DataCenter.getInstance().player,e._labValueList=[],e._switcherPos=[90,154,220,284,349,415,478,544,610],e}return __extends(e,t),Object.defineProperty(e.prototype,"moduleName",{get:function(){return"AppPointRummySkin"},enumerable:!0,configurable:!0}),e.prototype.loadComplete=function(){t.prototype.loadComplete.call(this),this.btnJia.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onAddLevel,this),this.btnJian.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onReduceLevel,this),this.btnSelect2.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onChangePlayerCount2,this),this.btnSelect6.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onChangePlayerCount6,this),this.btnRect1.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSetLevel1,this),this.btnRect2.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSetLevel2,this),this.btnRect3.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSetLevel3,this),this.btnRect4.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSetLevel4,this),this.btnRect5.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSetLevel5,this),this.btnRect6.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSetLevel6,this),this.btnRect7.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSetLevel7,this),this.btnRect8.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSetLevel8,this),this.btnRect9.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSetLevel9,this),this.btnEnter.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onEnterGame,this),this._labValueList=[this.labValue1,this.labValue2,this.labValue3,this.labValue4,this.labValue5,this.labValue6,this.labValue7,this.labValue8,this.labValue9]},e.prototype.onRemoved=function(e){t.prototype.onRemoved.call(this,e),this.btnJia.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onAddLevel,this),this.btnJian.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onReduceLevel,this),this.btnSelect2.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onChangePlayerCount2,this),this.btnSelect6.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onChangePlayerCount6,this),this.btnRect1.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onSetLevel1,this),this.btnRect2.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onSetLevel2,this),this.btnRect3.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onSetLevel3,this),this.btnRect4.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onSetLevel4,this),this.btnRect5.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onSetLevel5,this),this.btnRect6.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onSetLevel6,this),this.btnRect7.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onSetLevel7,this),this.btnRect8.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onSetLevel8,this),this.btnRect9.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onSetLevel9,this),this.btnEnter.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onEnterGame,this)},e.prototype.initView=function(){if(this.setCurrentLevel(1),this.setCurrentPlayer(2),this._game.mode==ROOM_MODE.GOLD_MODE){var t=this._game.goldRummyConfig[0]/100;this.grpSelectEntry.visible=!1,this.labPointValue.text="Point Value： "+t/80,this.labMinEntry.text="Min Entry： "+t,this.btnEnter.label="Chips Play Now"}else{this.grpSelectEntry.visible=!0;for(var e=this._game.pointRummyConfig,i=0;i<e.length;i++){var n=e[i]/100,a=n/80,s=this._labValueList[i];this._player.info.cash>=n&&this.setCurrentLevel(i+1),s.text=String(a)}this.btnEnter.label="Cash Play Now"}},e.prototype.setCurrentPlayer=function(t){6==t?(this._currentPlayer=6,this.selectBack.x=140,this.labPlayerCount2.textColor=16777215,this.labPlayers2.textColor=16777215,this.labPlayerCount6.textColor=0,this.labPlayers6.textColor=0):(this._currentPlayer=2,this.selectBack.x=5,this.labPlayerCount2.textColor=0,this.labPlayers2.textColor=0,this.labPlayerCount6.textColor=16777215,this.labPlayers6.textColor=16777215)},e.prototype.setCurrentLevel=function(t){t>=this._labValueList.length?this._currentLevel=this._labValueList.length:1>t?this._currentLevel=1:this._currentLevel=t,this.btnSwitcher.x=this._switcherPos[this._currentLevel-1];var e=this._game.pointRummyConfig[this._currentLevel-1]/100,i=e/80;this.btnEnter.enabled=!0,this._game.mode==ROOM_MODE.GOLD_MODE&&(this.labPointValue.text="Point Value： "+i,this.labMinEntry.text="Min Entry： "+e,e>this._player.info.gold&&(this.btnEnter.enabled=!1)),this._game.mode==ROOM_MODE.CASH_MODE&&(this.labPointValue.text="Point Value： ₹ "+i,this.labMinEntry.text="Min Entry： ₹ "+e,e>this._player.info.cash&&(this.btnEnter.enabled=!1))},e.prototype.onAddLevel=function(t){this.setCurrentLevel(this._currentLevel+1)},e.prototype.onReduceLevel=function(t){this.setCurrentLevel(this._currentLevel-1)},e.prototype.onChangePlayerCount2=function(t){this.setCurrentPlayer(2)},e.prototype.onChangePlayerCount6=function(t){this.setCurrentPlayer(6)},e.prototype.onEnterGame=function(t){0==this._game.btnLock()&&GameController.getInstance().fastGame(this._game.mode,ROOM_TYPE.POINT_RUMMY,this._currentLevel,0,this._currentPlayer)},e.prototype.onSetLevel1=function(t){this.setCurrentLevel(1)},e.prototype.onSetLevel2=function(t){this.setCurrentLevel(2)},e.prototype.onSetLevel3=function(t){this.setCurrentLevel(3)},e.prototype.onSetLevel4=function(t){this.setCurrentLevel(4)},e.prototype.onSetLevel5=function(t){this.setCurrentLevel(5)},e.prototype.onSetLevel6=function(t){this.setCurrentLevel(6)},e.prototype.onSetLevel7=function(t){this.setCurrentLevel(7)},e.prototype.onSetLevel8=function(t){this.setCurrentLevel(8)},e.prototype.onSetLevel9=function(t){this.setCurrentLevel(9)},e}(lz.BaseView);__reflect(AppPointRummyView.prototype,"AppPointRummyView");var AppPoolRummyView=function(t){function e(){var e=t.call(this)||this;return e._game=DataCenter.getInstance().game,e._player=DataCenter.getInstance().player,e._labValueList=[],e._switcherPos=[90,154,220,284,349,415,478,544,610],e}return __extends(e,t),Object.defineProperty(e.prototype,"moduleName",{get:function(){return"AppPoolRummySkin"},enumerable:!0,configurable:!0}),e.prototype.loadComplete=function(){t.prototype.loadComplete.call(this),this.btnJia.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onAddLevel,this),this.btnJian.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onReduceLevel,this),this.btnSelect2.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onChangePlayerCount2,this),this.btnSelect6.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onChangePlayerCount6,this),this.btnSelect61.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onChangePool61,this),this.btnSelect101.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onChangePool101,this),this.btnSelect201.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onChangePool201,this),this.btnRect1.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSetLevel1,this),this.btnRect2.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSetLevel2,this),this.btnRect3.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSetLevel3,this),this.btnRect4.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSetLevel4,this),this.btnRect5.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSetLevel5,this),this.btnRect6.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSetLevel6,this),this.btnRect7.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSetLevel7,this),this.btnRect8.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSetLevel8,this),this.btnRect9.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSetLevel9,this),this.btnEnter.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onEnterGame,this),this._labValueList=[this.labValue1,this.labValue2,this.labValue3,this.labValue4,this.labValue5,this.labValue6,this.labValue7,this.labValue8,this.labValue9]},e.prototype.onRemoved=function(e){t.prototype.onRemoved.call(this,e),this.btnJia.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onAddLevel,this),this.btnJian.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onReduceLevel,this),this.btnSelect2.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onChangePlayerCount2,this),this.btnSelect6.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onChangePlayerCount6,this),this.btnSelect61.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onChangePool61,this),this.btnSelect101.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onChangePool101,this),this.btnSelect201.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onChangePool201,this),this.btnRect1.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onSetLevel1,this),this.btnRect2.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onSetLevel2,this),this.btnRect3.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onSetLevel3,this),this.btnRect4.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onSetLevel4,this),this.btnRect5.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onSetLevel5,this),this.btnRect6.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onSetLevel6,this),this.btnRect7.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onSetLevel7,this),this.btnRect8.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onSetLevel8,this),this.btnRect9.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onSetLevel9,this),this.btnEnter.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onEnterGame,this)},e.prototype.initView=function(){if(this.setCurrentLevel(1),this.setCurrentPlayer(2),this.setCurrentValue(61),this._game.mode==ROOM_MODE.GOLD_MODE){var t=this._game.goldRummyConfig[1]/100;this.grpSelectEntry.visible=!1,this.labMinEntry.text="Min Entry： "+t,this.btnEnter.label="Chips Play Now"}else{this.grpSelectEntry.visible=!0;for(var e=this._game.poolRummyConfig,i=0;i<e.length;i++){var n=e[i]/100,a=this._labValueList[i];this._player.info.cash>=n&&this.setCurrentLevel(i+1),a.text=String(n)}this.btnEnter.label="Cash Play Now"}},e.prototype.setCurrentPlayer=function(t){6==t?(this._currentPlayer=6,this.selectPlayerBack.x=140,this.labPlayerCount2.textColor=16777215,this.labPlayers2.textColor=16777215,this.labPlayerCount6.textColor=0,this.labPlayers6.textColor=0):(this._currentPlayer=2,this.selectPlayerBack.x=5,this.labPlayerCount2.textColor=0,this.labPlayers2.textColor=0,this.labPlayerCount6.textColor=16777215,this.labPlayers6.textColor=16777215)},e.prototype.setCurrentLevel=function(t){t>=this._labValueList.length?this._currentLevel=this._labValueList.length:1>t?this._currentLevel=1:this._currentLevel=t,this.btnSwitcher.x=this._switcherPos[this._currentLevel-1];var e=this._game.poolRummyConfig[this._currentLevel-1]/100;this.btnEnter.enabled=!0,this._game.mode==ROOM_MODE.GOLD_MODE&&(this.labMinEntry.text="Min Entry： "+e,e>this._player.info.gold&&(this.btnEnter.enabled=!1)),this._game.mode==ROOM_MODE.CASH_MODE&&(this.labMinEntry.text="Min Entry： ₹ "+e,e>this._player.info.cash&&(this.btnEnter.enabled=!1))},e.prototype.onAddLevel=function(t){this.setCurrentLevel(this._currentLevel+1)},e.prototype.onReduceLevel=function(t){this.setCurrentLevel(this._currentLevel-1)},e.prototype.onChangePlayerCount2=function(t){this.setCurrentPlayer(2)},e.prototype.onChangePlayerCount6=function(t){this.setCurrentPlayer(6)},e.prototype.onChangePool61=function(t){this.setCurrentValue(61),this.selectPoolBack.x=5,this.labPool61.textColor=0,this.labPool101.textColor=16777215,this.labPool201.textColor=16777215},e.prototype.onChangePool101=function(t){this.setCurrentValue(101),this.selectPoolBack.x=140,this.labPool61.textColor=16777215,this.labPool101.textColor=0,this.labPool201.textColor=16777215},e.prototype.onChangePool201=function(t){this.setCurrentValue(201),this.selectPoolBack.x=280,this.labPool61.textColor=16777215,this.labPool101.textColor=16777215,this.labPool201.textColor=0},e.prototype.setCurrentValue=function(t){this._currentValue=t},e.prototype.onEnterGame=function(t){0==this._game.btnLock()&&GameController.getInstance().fastGame(this._game.mode,ROOM_TYPE.POOL_RUMMY,this._currentLevel,this._currentValue,this._currentPlayer)},e.prototype.onSetLevel1=function(t){this.setCurrentLevel(1)},e.prototype.onSetLevel2=function(t){this.setCurrentLevel(2)},e.prototype.onSetLevel3=function(t){this.setCurrentLevel(3)},e.prototype.onSetLevel4=function(t){this.setCurrentLevel(4)},e.prototype.onSetLevel5=function(t){this.setCurrentLevel(5)},e.prototype.onSetLevel6=function(t){this.setCurrentLevel(6)},e.prototype.onSetLevel7=function(t){this.setCurrentLevel(7)},e.prototype.onSetLevel8=function(t){this.setCurrentLevel(8)},e.prototype.onSetLevel9=function(t){this.setCurrentLevel(9)},e}(lz.BaseView);__reflect(AppPoolRummyView.prototype,"AppPoolRummyView");var AppLoginView=function(t){function e(){var e=t.call(this)||this;return e.locationList=["AP | Andhra Pradesh","AR | Arunachal Pradesh","AS | Assam","BR | Bihar","CT | Chhattisgarh","GA | Goa","GJ | Gujarat","HR | Haryana","HP | Himachal Pradesh","JK | Jammu and Kashmir","JH | Jharkhand","KA | Karnataka","KL | Kerala","MP | Madhya Pradesh","MH | Maharashtra","MN | Manipur","ML | Meghalaya","MZ | Mizoram","NL | Nagaland","OR | Odisha","PB | Punjab","RJ | Rajasthan","SK | Sikkim","TN | Tamil Nadu","TG | Telangana","TR | Tripura","UT | Uttarakhand","UP | Uttar Pradesh","WB | West Bengal","AN | Andaman and Nicobar Islands","CH | Chandigarh","DN | Dadra and Nagar Haveli","DD | Daman and Diu","DL | Delhi","LD | Lakshadweep","PY | Puducherry"],e.locationDataList=[],e.rejectLocation=[2,19,18,22,23,0,24],e.showSelect=!1,e.selectIndex=14,e.infoAry=new eui.ArrayCollection,e._game=DataCenter.getInstance().game,e._app=DataCenter.getInstance().app,e}return __extends(e,t),Object.defineProperty(e.prototype,"moduleName",{get:function(){return"AppLoginSkin"},enumerable:!0,configurable:!0}),e.prototype.notificationListeners=function(){return[GameEvent.START_COUNT_DOWN]},e.prototype.executeNotification=function(t,e,i){switch(t){case GameEvent.START_COUNT_DOWN:}},e.prototype.loadComplete=function(){t.prototype.loadComplete.call(this),this.btnLogin.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickGuestLogin,this),this.btnFBLogin.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickFbLogin,this),this.btnGoogleLogin.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickGoogleLogin,this),this.btnSend.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSendSMS,this),this.btnMobileLogin.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickMobileLogin,this),this.grpSelectLocation.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSelectLocation,this),this.dataList.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.onTapLocation,this),this.rectBack.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onCancelSelect,this);var e=(new Date).getTime();if(e<this._game.smsTime){var i=Math.floor((this._game.smsTime-e)/1e3);this.startCountDown(i)}for(var n=0;n<this.locationList.length;n++){var a=new LocationData(this.locationList[n],n);this.locationDataList.push(a)}this.dataList.itemRenderer=LocationItem,this.dataList.dataProvider=new eui.ArrayCollection(this.locationDataList),this.showLocationList(),this._game.socketFirst=!0,this.labVersion.text="Ver: "+this._app.gameVersion},e.prototype.onRemoved=function(e){t.prototype.onRemoved.call(this,e),this.btnLogin.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickGuestLogin,this),this.btnFBLogin.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickFbLogin,this),this.btnGoogleLogin.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickGoogleLogin,this),this.btnSend.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onSendSMS,this),this.btnMobileLogin.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickMobileLogin,this),this.grpSelectLocation.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onSelectLocation,this),this.dataList.removeEventListener(eui.ItemTapEvent.ITEM_TAP,this.onTapLocation,this),this.rectBack.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onCancelSelect,this)},e.prototype.onCancelSelect=function(t){this.showSelect=!1,this.showLocationList()},e.prototype.onTapLocation=function(){console.log(this.dataList.selectedIndex),this.selectIndex=this.dataList.selectedIndex,this.showSelect=!1,this.showLocationList()},e.prototype.showLocationList=function(){this.locationList[this.selectIndex];this.showSelect?(this.grpLocation.visible=!0,this.imgTriangle.source="loading_json.triangle",this.rectBack.visible=!0):(this.grpLocation.visible=!1,this.imgTriangle.source="loading_json.triangle2",this.rectBack.visible=!1),this.labLocation.text=this.locationList[this.selectIndex]},e.prototype.onSelectLocation=function(t){this.showSelect?this.showSelect=!1:this.showSelect=!0,this.showLocationList()},e.prototype.startCountDown=function(t){this.countDownNumber=t,this.btnSend.label=this.countDownNumber+"",null!=this.timer&&(this.timer.stop(),this.timer.removeEventListener(egret.TimerEvent.TIMER,this.onCountDown,this)),this.timer=new egret.Timer(1e3,this.countDownNumber),this.timer.addEventListener(egret.TimerEvent.TIMER,this.onCountDown,this),this.timer.start()},e.prototype.onCountDown=function(){this.countDownNumber-=1,this.btnSend.label=this.countDownNumber+"",this.countDownNumber<=0&&(this.timer.stop(),this._game.smsTime=0,this.btnSend.label="Send")},e.prototype.onClickGuestLogin=function(t){return this.rejectLocation.indexOf(this.selectIndex)>=0?void Utils.showMessageBox(LanguageConfig.REJECT_LOCATION):void(0==this._game.btnLock()&&LoginController.getInstance().touristLogin())},e.prototype.onClickFbLogin=function(t){return this.rejectLocation.indexOf(this.selectIndex)>=0?void Utils.showMessageBox(LanguageConfig.REJECT_LOCATION):void(0==this._game.btnLock(3e3)&&AndroidManager.getInstance().fb_login(0))},e.prototype.onClickGoogleLogin=function(t){return this.rejectLocation.indexOf(this.selectIndex)>=0?void Utils.showMessageBox(LanguageConfig.REJECT_LOCATION):void(0==this._game.btnLock(3e3)&&AndroidManager.getInstance().google_login(0))},e.prototype.onClickMobileLogin=function(t){return this.rejectLocation.indexOf(this.selectIndex)>=0?void Utils.showMessageBox(LanguageConfig.REJECT_LOCATION):void(6==this.inputOTP.text.length?0==this._game.btnLock()&&(console.log("click"),LoginController.getInstance().mobileLogin(this.inputMobile.text,this.inputOTP.text)):Utils.showMessageBox(LanguageConfig.TAG_CODE_ERROR))},e.prototype.onSendSMS=function(t){if(this.rejectLocation.indexOf(this.selectIndex)>=0)return void Utils.showMessageBox(LanguageConfig.REJECT_LOCATION);var e=(new Date).getTime();return this.countDownNumber>0||e<this._game.smsTime?void Utils.showMessageBox(LanguageConfig.SMS_COUNTDOWN):void(10==this.inputMobile.text.length?0==this._game.btnLock()&&(this._game.saveSmsTime(),this.startCountDown(60),LoginController.getInstance().sendSMS(this.inputMobile.text)):Utils.showMessageBox(LanguageConfig.TAG_PHONE_ERROR))},e}(lz.BaseView);__reflect(AppLoginView.prototype,"AppLoginView");var LocationItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="LocationItemSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.labLocation.text=this.data.location;var e=this.data.index;e%2==0?this.rectBack.fillColor=16777215:this.rectBack.fillColor=15394534},e}(eui.ItemRenderer);__reflect(LocationItem.prototype,"LocationItem");var AppAccountView=function(t){function e(){var e=t.call(this)||this;return e._app=DataCenter.getInstance().app,e._game=DataCenter.getInstance().game,e._player=DataCenter.getInstance().player,e}return __extends(e,t),Object.defineProperty(e.prototype,"moduleName",{get:function(){return"AppAccountSkin"},enumerable:!0,configurable:!0}),e.prototype.loadComplete=function(){t.prototype.loadComplete.call(this),this.btnReload.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onReloadGold,this),this.btnAddCash.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onAddCash,this),this.labChips.text=this._player.info.gold+"",this.labTotalCash.text=this._player.info.cash+"",this.labCash.text=this._player.info.cash_user+"",this.labBonusCash.text=this._player.info.cash_reward+"",this.labPayCash.text="0"},e.prototype.onRemoved=function(e){t.prototype.onRemoved.call(this,e),this.btnReload.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onReloadGold,this),this.btnAddCash.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onAddCash,this)},e.prototype.onReloadGold=function(t){return this._player.info.gold>=1e4?void Utils.showMessageBox(LanguageConfig.RELOAD_GOLD_SUCCESS):void(0==this._game.btnLock()&&GameController.getInstance().reloadGold())},e.prototype.onAddCash=function(t){lz.Facade.sendNotification(lz.GameFrameEvent.OPEN_VIEW,GameViewType.AppPay,"open")},e}(lz.BaseView);__reflect(AppAccountView.prototype,"AppAccountView");var AppKYCView=function(t){function e(){return t.call(this)||this}return __extends(e,t),Object.defineProperty(e.prototype,"moduleName",{get:function(){return"AppKYCSkin"},enumerable:!0,configurable:!0}),e.prototype.loadComplete=function(){t.prototype.loadComplete.call(this),this.btnVerifyMobile.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onVerify,this),this.btnVerifyName.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onVerify,this),this.btnSubmit.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onVerify,this)},e.prototype.onRemoved=function(e){t.prototype.onRemoved.call(this,e),this.btnVerifyMobile.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onVerify,this),this.btnVerifyName.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onVerify,this),this.btnSubmit.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onVerify,this)},e.prototype.onVerify=function(t){Utils.showMessageBox(LanguageConfig.TAG_NOT_AVAILABLE)},e}(lz.BaseView);__reflect(AppKYCView.prototype,"AppKYCView");var AppMenuView=function(t){function e(){var e=t.call(this)||this;return e._app=DataCenter.getInstance().app,e._game=DataCenter.getInstance().game,e}return __extends(e,t),Object.defineProperty(e.prototype,"moduleName",{get:function(){return"AppMenuSkin"},enumerable:!0,configurable:!0}),e.prototype.loadComplete=function(){t.prototype.loadComplete.call(this),this.rectBackground.addEventListener(egret.TouchEvent.TOUCH_TAP,this.hideMenu,this),this.grpUser.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onShowUserView,this),this.grpAccount.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onShowAccountView,this),this.grpWithdrawal.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onShowWithdrawalView,this),this.grpKYC.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onShowKYCView,this),this.grpTransaction.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onShowTransactionView,this),this.grpSchool.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onShowSchoolView,this),this.grpRule.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onShowRuleView,this),this.grpBonus.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onShowBonusView,this),this.grpLogout.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onLogout,this);var e=DataCenter.getInstance().player;this.headImage.source=e.info.avatar;var i=new eui.Rect,n=this._game.isShowWithdraw();n?(this.grpWithdrawal.visible=!0,i.width=400,i.height=900,i.x=0,i.y=0):(this.grpWithdrawal.visible=!1,i.width=400,i.height=800,i.x=0,i.y=100),i.fillColor=16777215,this.grpMenuBack.addChild(i)},e.prototype.onRemoved=function(e){t.prototype.onRemoved.call(this,e),this.rectBackground.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.hideMenu,this),this.grpUser.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onShowUserView,this),this.grpAccount.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onShowAccountView,this),this.grpWithdrawal.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onShowWithdrawalView,this),this.grpTransaction.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onShowTransactionView,this),this.grpSchool.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onShowSchoolView,this),this.grpRule.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onShowRuleView,this),this.grpBonus.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onShowBonusView,this),this.grpLogout.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onLogout,this)},e.prototype.hideMenu=function(){lz.PopupManager.delPop(this)},e.prototype.onShowWithdrawalView=function(t){lz.Facade.sendNotification(GameEvent.OPEN_MENU,{menuid:MENU_ID.WITHDRAWAL}),this.hideMenu()},e.prototype.onShowUserView=function(t){lz.Facade.sendNotification(GameEvent.OPEN_MENU,{menuid:MENU_ID.USER}),this.hideMenu()},e.prototype.onShowAccountView=function(t){lz.Facade.sendNotification(GameEvent.OPEN_MENU,{menuid:MENU_ID.ACCOUNT}),this.hideMenu()},e.prototype.onShowKYCView=function(t){lz.Facade.sendNotification(GameEvent.OPEN_MENU,{menuid:MENU_ID.KYC}),this.hideMenu()},e.prototype.onShowTransactionView=function(t){lz.Facade.sendNotification(GameEvent.OPEN_MENU,{menuid:MENU_ID.TRANSACTION}),this.hideMenu()},e.prototype.onShowSchoolView=function(t){lz.Facade.sendNotification(lz.GameFrameEvent.OPEN_VIEW,GameViewType.Guild,"open"),this.hideMenu()},e.prototype.onShowRuleView=function(t){lz.Facade.sendNotification(GameEvent.OPEN_MENU,{menuid:MENU_ID.RULE}),this.hideMenu()},e.prototype.onShowBonusView=function(t){lz.Facade.sendNotification(GameEvent.OPEN_MENU,{menuid:MENU_ID.BONUS}),this.hideMenu()},e.prototype.onLogout=function(t){lz.Facade.sendNotification(GameEvent.OPEN_MENU,{menuid:MENU_ID.LOGOUT}),this.hideMenu()},e}(lz.BaseView);__reflect(AppMenuView.prototype,"AppMenuView");var AppRuleView=function(t){function e(){var e=t.call(this)||this;return e.ypos=270,e}return __extends(e,t),Object.defineProperty(e.prototype,"moduleName",{get:function(){return"AppRuleSkin"},enumerable:!0,configurable:!0}),e.prototype.loadComplete=function(){t.prototype.loadComplete.call(this),this._data=LanguageConfig.getLanData("RummyRule"),this.showView()},e.prototype.onRemoved=function(e){t.prototype.onRemoved.call(this,e)},e.prototype.showView=function(){for(var t=this._data,e=0;e<t.length;e++){var i=t[e];this.ypos+=10;var n=new eui.Label;n.text=i.title,n.size=22,n.x=0,n.textColor=0,n.y=this.ypos,n.width=640,n.wordWrap=!0,this.grpContent.addChild(n),this.ypos+=n.height+10;var a=new eui.Rect(640,2,6697728);a.x=0,a.y=this.ypos,this.grpContent.addChild(a),this.ypos+=20;for(var s=i.content,o=0;o<s.length;o++){var r=new eui.Label;r.text=s[o],r.size=18,r.x=0,r.y=this.ypos,r.textColor=0,r.width=630,r.wordWrap=!0,r.lineSpacing=4,this.grpContent.addChild(r),this.ypos+=r.height+20}}},e}(lz.BaseView);__reflect(AppRuleView.prototype,"AppRuleView");var AppTransactionView=function(t){function e(){var e=t.call(this)||this;return e.infoAry=new eui.ArrayCollection,e.needUp=!1,e._game=DataCenter.getInstance().game,e}return __extends(e,t),Object.defineProperty(e.prototype,"moduleName",{get:function(){return"AppTransactionSkin"},enumerable:!0,configurable:!0}),e.prototype.notificationListeners=function(){return[GameEvent.UPDATE_TRANSACTION]},e.prototype.executeNotification=function(t,e,i){switch(t){case GameEvent.UPDATE_TRANSACTION:this.showList()}},e.prototype.loadComplete=function(){t.prototype.loadComplete.call(this),this.moveScroll.addEventListener(eui.UIEvent.CHANGE,this.moveHandler,this),this.moveScroll.addEventListener(eui.UIEvent.CHANGE_END,this.outHandler,this)},e.prototype.onRemoved=function(e){t.prototype.onRemoved.call(this,e),this.moveScroll.removeEventListener(eui.UIEvent.CHANGE,this.moveHandler,this),this.moveScroll.removeEventListener(eui.UIEvent.CHANGE_END,this.outHandler,this)},e.prototype.showList=function(){this.dataGroup.itemRenderer=TransactionItem,this.dataGroup.dataProvider=new eui.ArrayCollection(this._game.transactionList)},e.prototype.moveHandler=function(t){console.log(this.moveScroll.viewport.scrollV>this.moveScroll.viewport.contentHeight-this.moveScroll.viewport.height),this.moveScroll.viewport.scrollV>this.moveScroll.viewport.contentHeight-this.moveScroll.viewport.height+60&&(this.needUp=!0)},e.prototype.outHandler=function(t){console.log(this.needUp),this.needUp&&(this.needUp=!1)},e}(lz.BaseView);__reflect(AppTransactionView.prototype,"AppTransactionView");var AppUserView=function(t){function e(){var e=t.call(this)||this;return e.modifyType=0,e.avatar="",e._player=DataCenter.getInstance().player,e._game=DataCenter.getInstance().game,e}return __extends(e,t),Object.defineProperty(e.prototype,"moduleName",{get:function(){return"AppUserSkin"},enumerable:!0,configurable:!0}),e.prototype.notificationListeners=function(){return[GameEvent.UPDATA_PLAYERDATA]},e.prototype.executeNotification=function(t,e,i){switch(t){case GameEvent.UPDATA_PLAYERDATA:this.showUserInfo()}},e.prototype.loadComplete=function(){t.prototype.loadComplete.call(this),this.btnModifyName.addEventListener(egret.TouchEvent.TOUCH_TAP,this.showTextInput1,this),this.btnModifyMobile.addEventListener(egret.TouchEvent.TOUCH_TAP,this.bindMobile,this),this.btnModifyAvatar.addEventListener(egret.TouchEvent.TOUCH_TAP,this.modifyAvatar,this),this.btnModify.addEventListener(egret.TouchEvent.TOUCH_TAP,this.modifyData,this),this.btnFBTip.addEventListener(egret.TouchEvent.TOUCH_TAP,this.showDeleteFB,this),this.btnClose.addEventListener(egret.TouchEvent.TOUCH_TAP,this.closeInput,this),this.btnBindFB.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBindFacebook,this),this.btnBindGG.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBindGoogle,this),this.grpTextinput.visible=!1,this.showAvatarList(),this.showUserInfo()},e.prototype.onRemoved=function(e){t.prototype.onRemoved.call(this,e),this.btnModifyName.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.showTextInput1,this),this.btnModifyMobile.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.bindMobile,this),this.btnModifyAvatar.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.modifyAvatar,this),this.btnModify.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.modifyData,this),this.btnFBTip.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.showDeleteFB,this),this.btnClose.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.closeInput,this),this.btnBindFB.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onBindFacebook,this),this.btnBindGG.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onBindGoogle,this)},e.prototype.showUserInfo=function(){this.textName.text=this._player.info.name,this.headImage.source=this._player.info.avatar,this._player.mobile&&this._player.mobile.length>0?this.textMobile.text=this._player.mobile:this.textMobile.text="N/A",this._player.fb_id&&this._player.fb_id.length>0?(this.btnBindFB.enabled=!1,this.labFacebookId.text=this._player.fb_id):(this.btnBindFB.enabled=!0,this.labFacebookId.text="N/A"),this._player.google_id&&this._player.google_id.length>0?(this.btnBindGG.enabled=!1,this.labGoogleId.text=this._player.google_id):(this.btnBindGG.enabled=!0,this.labGoogleId.text="N/A")},e.prototype.showAvatarList=function(){this.rect=new eui.Rect(0,0,13421772),this.grpAvatar.addChild(this.rect);for(var t=0;23>t;t++){var e=new eui.Image;e.source="game_json.avatar_"+(t+1),e.width=e.height=70;var i=Math.floor(t/6),n=t%6;e.x=100*n+25,e.y=100*i+15,e.name=t+1+"",this.grpAvatar.addChild(e),e.addEventListener(egret.TouchEvent.TOUCH_TAP,this.selectAvatar,this)
}},e.prototype.selectAvatar=function(t){var e=t.currentTarget;this.rect.width=86,this.rect.height=86,this.rect.x=e.x-8,this.rect.y=e.y-8,this.rect.alpha=.8,this.avatar=e.name},e.prototype.showTextInput1=function(t){this.modifyType=1,this.showTextInput()},e.prototype.showTextInput=function(){this.textInput.text="",this.grpTextinput.visible=!0,1==this.modifyType&&(this.labTitle.text="Please input UserName",this.labInputTip.text="Text length must with 6-12.")},e.prototype.closeInput=function(){this.grpTextinput.visible=!1},e.prototype.bindMobile=function(t){lz.PopupManager.addPop(new BindMobileView)},e.prototype.modifyData=function(t){if(1==this.modifyType){var e=this.textInput.text;if(e.length<6||e.length>12)return void Utils.showMessageBox(LanguageConfig.TEXT_LENGTH_WITH_12);this.modifyName(e)}this.closeInput()},e.prototype.modifyName=function(t){var e={};e.nickname=t,e.mobile=null,e.code=null,e.avatar=null,e.fb_id=null,e.google_id=null,0==this._game.btnLock()&&GameController.getInstance().modifyUserData(e)},e.prototype.modifyAvatar=function(t){if(""==this.avatar)return void Utils.showMessageBox(LanguageConfig.TEXT_LENGTH_NOT_EMPTY);var e={};e.nickname=null,e.mobile=null,e.code=null,e.avatar=this.avatar,e.fb_id=null,e.google_id=null,0==this._game.btnLock(2e3)&&GameController.getInstance().modifyUserData(e)},e.prototype.onBindFacebook=function(t){0==this._game.btnLock(3e3)&&AndroidManager.getInstance().fb_login(1)},e.prototype.onBindGoogle=function(t){0==this._game.btnLock(3e3)&&AndroidManager.getInstance().google_login(1)},e.prototype.showDeleteFB=function(t){var e=this;this._player.fb_id&&this._player.fb_id.length>0?Utils.showTextAlert("Do you want to delete user information about Facebook in the game?","Game Notice",function(){e.deleteFB()},lz.AlertType.YesNo):Utils.showMessageBox(LanguageConfig.FACEBOOK_NOT_LOGIN)},e.prototype.deleteFB=function(){0==this._game.btnLock()&&LoginController.getInstance().deleteFacebook()},e}(lz.BaseView);__reflect(AppUserView.prototype,"AppUserView");var AppWithdrawView=function(t){function e(){return t.call(this)||this}return __extends(e,t),Object.defineProperty(e.prototype,"moduleName",{get:function(){return"AppWithdrawSkin"},enumerable:!0,configurable:!0}),e.prototype.loadComplete=function(){t.prototype.loadComplete.call(this),AndroidManager.getInstance().showAndroidTest()},e.prototype.onRemoved=function(e){t.prototype.onRemoved.call(this,e)},e.prototype.notificationListeners=function(){return[GameEvent.ANDROID_TEST]},e.prototype.executeNotification=function(t,e,i){switch(t){case GameEvent.ANDROID_TEST:this.showList(e)}},e.prototype.showList=function(t){console.log("showList="+JSON.stringify(t));var e=t.data,i=e.list1,n=e.list2;this.labList1.text=i,this.labList2.text=n},e}(lz.BaseView);__reflect(AppWithdrawView.prototype,"AppWithdrawView");var TransactionItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="TransactionItemSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.labId.text=this.data.transaction_id,this.labAmount.text=this.data.amount/100+"",this.labDetail.text=this.data.detail,this.labDate.text=this.data.date;var e=this.data.index;e%2==0?this.backRect.fillColor=16777215:this.backRect.fillColor=15394534},e}(eui.ItemRenderer);__reflect(TransactionItem.prototype,"TransactionItem");var AppOrderItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="OrderItemSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.labId.text=this.data.merchantTransactionId,this.labAmount.text=this.data.amount/100+"",this.labDetail.text=this.data.state,this.labDate.text=this.data.date;var e=this.data.index;e%2==0?this.backRect.fillColor=16777215:this.backRect.fillColor=15394534},e}(eui.ItemRenderer);__reflect(AppOrderItem.prototype,"AppOrderItem");var AppOrderView=function(t){function e(){var e=t.call(this)||this;return e._game=DataCenter.getInstance().game,e.infoAry=new eui.ArrayCollection,e}return __extends(e,t),Object.defineProperty(e.prototype,"moduleName",{get:function(){return"AppOrderViewSkin"},enumerable:!0,configurable:!0}),e.prototype.notificationListeners=function(){return[GameEvent.UPDATE_ORDER]},e.prototype.executeNotification=function(t,e,i){switch(t){case GameEvent.UPDATE_ORDER:this.showList()}},e.prototype.loadComplete=function(){t.prototype.loadComplete.call(this),this.btnClose.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClose,this),GameController.getInstance().orderList(1)},e.prototype.onClose=function(t){lz.Facade.sendNotification(lz.GameFrameEvent.OPEN_VIEW,GameViewType.AppPay,"open")},e.prototype.onRemoved=function(e){t.prototype.onRemoved.call(this,e),this.btnClose.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClose,this)},e.prototype.showList=function(){this.labNone.visible=0==this._game.orderList.length;this._game.orderList;this.dataGroup.itemRenderer=AppOrderItem,this.dataGroup.dataProvider=new eui.ArrayCollection(this._game.orderList)},e}(lz.BaseView);__reflect(AppOrderView.prototype,"AppOrderView");var AppPayView=function(t){function e(){var e=t.call(this)||this;return e._player=DataCenter.getInstance().player,e}return __extends(e,t),Object.defineProperty(e.prototype,"moduleName",{get:function(){return"AppPayViewSkin"},enumerable:!0,configurable:!0}),e.prototype.loadComplete=function(){t.prototype.loadComplete.call(this),this.btnClose.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClose,this),this.btnOrder.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onShowOrder,this),this.payPanel1.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSelect1,this),this.payPanel2.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSelect2,this),this.payPanel3.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSelect3,this),this.payPanel4.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSelect4,this),this.inputAmount.addEventListener(egret.TouchEvent.CHANGE,this.onShowAmount,this),this.btnPhonePEAdd.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onPhonePEAddCash,this),this.btnAirpayAdd.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onAirpayAddCash,this),this.cashInfo.text="No Select!"},e.prototype.onRemoved=function(e){t.prototype.onRemoved.call(this,e),this.btnClose.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClose,this),this.btnOrder.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onShowOrder,this),this.payPanel1.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onSelect1,this),this.payPanel2.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onSelect2,this),this.payPanel3.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onSelect3,this),this.payPanel4.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onSelect4,this),this.inputAmount.removeEventListener(egret.TouchEvent.CHANGE,this.onShowAmount,this),this.btnPhonePEAdd.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onPhonePEAddCash,this),this.btnAirpayAdd.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onAirpayAddCash,this)},e.prototype.onShowOrder=function(t){lz.Facade.sendNotification(lz.GameFrameEvent.OPEN_VIEW,GameViewType.AppOrder,"open")},e.prototype.showSelect=function(t){this.rect1.strokeColor=13025472,this.rect2.strokeColor=13025472,this.rect3.strokeColor=13025472,this.rect4.strokeColor=13025472,1==t&&(this.rect1.strokeColor=1471762),2==t&&(this.rect2.strokeColor=1471762),3==t&&(this.rect3.strokeColor=1471762),4==t&&(this.rect4.strokeColor=1471762)},e.prototype.onClose=function(t){lz.Facade.sendNotification(lz.GameFrameEvent.OPEN_VIEW,GameViewType.AppHome,"open")},e.prototype.onSelect1=function(t){this.showSelect(1),this.amount=100,this.cashInfo.text="₹ 100   +   ₹ 0   =   ₹ 100"},e.prototype.onSelect2=function(t){this.showSelect(2),this.amount=500,this.cashInfo.text="₹ 500   +   ₹ 50   =   ₹ 550"},e.prototype.onSelect3=function(t){this.showSelect(3),this.amount=2e3,this.cashInfo.text="₹ 2000   +   ₹ 200   =   ₹ 2200"},e.prototype.onSelect4=function(t){this.showSelect(4),this.amount=5e3,this.cashInfo.text="₹ 5000   +   ₹ 250   =   ₹ 5250"},e.prototype.onShowAmount=function(t){var e=Number(this.inputAmount.text),i=0;e>=500&&2e3>e?i=50:e>=2e3&&5e3>e?i=200:e>=5e3&&(i=250),100>e||e>1e4?(this.amount=0,this.cashInfo.text="amount must in 100 - 10000"):(this.amount=e,this.cashInfo.text="₹ "+e+"   +   ₹ "+i+"   =   ₹ "+(e+i))},e.prototype.onPhonePEAddCash=function(t){AndroidManager.getInstance().trackEvent("payment","pay_button_name","PHONEPE_ADD"),console.log("phonePE payment"),this.amount>=100&&this.amount<=1e4?GameController.getInstance().addPhonePEPayment("UPI_INTENT",100*this.amount,["com.phonepe.app"]):Utils.showMessageBox(LanguageConfig.PAY_AMOUNT_ERROR)},e.prototype.onAirpayAddCash=function(t){AndroidManager.getInstance().trackEvent("payment","pay_button_name","AIRPAY_ADD"),console.log("到这里了码"),this.amount>=100&&this.amount<=1e4?GameController.getInstance().addAirpayPayment(100*this.amount):Utils.showMessageBox(LanguageConfig.PAY_AMOUNT_ERROR)},e}(lz.BaseView);__reflect(AppPayView.prototype,"AppPayView");var AppSelectPayView=function(t){function e(){var e=t.call(this)||this;return e.upiPkgName=["com.phonepe.app","com.phonepe.app.preprod","com.google.android.apps.nbu.paisa.user","net.one97.paytm","in.org.npci.upiapp","in.amazon.mShop.android.shopping"],e.upiAppName=["PhonePE","PhonePE UAT","GPay","PayTM","BHIM","Amazon"],e.uipIcon=["game_json.upi_phonepe","game_json.upi_phonepe","game_json.upi_gpay","game_json.upi_paytm","game_json.upi_bhim","game_json.upi_amazonpay"],e.pay_type="",e.pay_data=[],e.pay_package="",e.upi_id_verify=0,e._app=DataCenter.getInstance().app,e._game=DataCenter.getInstance().game,e}return __extends(e,t),Object.defineProperty(e.prototype,"moduleName",{get:function(){return"AppSelectPayViewSkin"},enumerable:!0,configurable:!0}),e.prototype.loadComplete=function(){t.prototype.loadComplete.call(this),this.grp_UPI_INTENT.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSelectUPIIntent,this),this.grp_UPI_COLLECT.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSelectUPICollect,this),this.grp_CARD.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSelectCard,this),this.grp_NET_BANKING.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSelectNetBanking,this),this.btnVerify.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onVerifyVPA,this),this.btnAdd.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onPay,this),this.btnClose.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClose,this),this.inputCardNumber.addEventListener(egret.Event.CHANGE,this.onChangeCardInput,this),this.inputMM.addEventListener(egret.Event.CHANGE,this.onChangeCardInput,this),this.inputYY.addEventListener(egret.Event.CHANGE,this.onChangeCardInput,this),this.inputCvv.addEventListener(egret.Event.CHANGE,this.onChangeCardInput,this),this.labPayInfo.text=GameController.getInstance().payInfo,this.btnAdd.label="Pay Now ₹ "+GameController.getInstance().payAmount,this.btnAdd.enabled=!1;for(var e=this._app.upiList,i=0;i<e.length;i++){var n=e[i],a=this.upiPkgName.indexOf(n);if(a>=0){var s=new eui.Image;s.source=this.uipIcon[a],s.width=104,s.height=104,s.x=20*(i+1)+104*i,s.y=20,s.name=n,s.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSelectUPIApp,this),this.grpUpiList.addChild(s);var o=new eui.Label;o.text=this.upiAppName[a],o.width=104,o.height=40,o.x=20*(i+1)+104*i,o.y=135,o.size=18,o.wordWrap=!0,o.textAlign=egret.HorizontalAlign.CENTER,o.textColor=0,this.grpUpiList.addChild(o)}}e.length>0&&(this.labTips.visible=!1),this.rectUPIBack.visible=!1,this.hideGroup(),this.onSelectUPIIntent(null)},e.prototype.hideGroup=function(){this.grpUpiList.visible=!1,this.grpVpa.visible=!1,this.grpCard.visible=!1,this.grpNetBanking.visible=!1},e.prototype.onRemoved=function(e){t.prototype.onRemoved.call(this,e),this.grp_UPI_INTENT.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onSelectUPIIntent,this),this.grp_UPI_COLLECT.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onSelectUPICollect,this),this.grp_CARD.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onSelectCard,this),this.grp_NET_BANKING.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onSelectNetBanking,this),this.btnVerify.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onVerifyVPA,this),this.btnAdd.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onPay,this),this.btnClose.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClose,this),this.inputCardNumber.removeEventListener(egret.Event.CHANGE,this.onChangeCardInput,this),this.inputMM.removeEventListener(egret.Event.CHANGE,this.onChangeCardInput,this),this.inputYY.removeEventListener(egret.Event.CHANGE,this.onChangeCardInput,this),this.inputCvv.removeEventListener(egret.Event.CHANGE,this.onChangeCardInput,this)},e.prototype.onSelectUPIIntent=function(t){this.hideGroup(),this.rectBack.x=this.rectBar.x=0,this.pay_type="UPI_INTENT",this.grpUpiList.visible=!0,this.grpUpiList.y=340,this.labPayTip.y=this.grpUpiList.y+this.grpUpiList.height+30,this.btnAdd.y=this.labPayTip.y+50,this.pay_package?(this.pay_data=[this.pay_package],this.labPayTip.text="Click to continue payment",this.labPayTip.textColor=1471762,this.btnAdd.enabled=!0):(this.pay_data=[],this.labPayTip.text="Please select UPI app!",this.labPayTip.textColor=10195602,this.btnAdd.enabled=!1)},e.prototype.onSelectUPICollect=function(t){this.hideGroup(),this.rectBack.x=this.rectBar.x=160,this.pay_type="UPI_COLLECT",this.grpVpa.visible=!0,this.grpVpa.y=340,this.labPayTip.y=this.grpVpa.y+this.grpVpa.height+30,this.btnAdd.y=this.labPayTip.y+50,this.inputUPIID.text&&0==this.btnVerify.enabled?(this.pay_data=[this.inputUPIID.text],this.labPayTip.text="Click to continue payment",this.labPayTip.textColor=1471762,this.btnAdd.enabled=!0):(this.pay_data=[],this.labPayTip.text="Please verify your UPI ID!",this.labPayTip.textColor=10195602,this.btnAdd.enabled=!1)},e.prototype.onSelectCard=function(t){this.hideGroup(),this.rectBack.x=this.rectBar.x=320,this.pay_type="CARD",this.grpCard.visible=!0,this.grpCard.y=340,this.labPayTip.y=this.grpCard.y+this.grpCard.height+30,this.btnAdd.y=this.labPayTip.y+50,this.inputCardNumber.text&&this.inputMM.text&&this.inputYY.text&&this.inputCvv.text?(this.pay_data=[this.inputCardNumber.text,this.inputMM.text,this.inputYY.text,this.inputCvv.text],this.labPayTip.text="Click to continue payment",this.labPayTip.textColor=1471762,this.btnAdd.enabled=!0):(this.pay_data=[],this.labPayTip.text="Please enter valid card info!",this.labPayTip.textColor=10195602,this.btnAdd.enabled=!1)},e.prototype.onSelectNetBanking=function(t){this.hideGroup(),this.rectBack.x=this.rectBar.x=480,this.pay_type="NET_BANKING",this.grpNetBanking.visible=!0,this.grpNetBanking.y=340,this.labPayTip.y=this.grpNetBanking.y+this.grpNetBanking.height+30,this.btnAdd.y=this.labPayTip.y+50,this.pay_data=[],this.labPayTip.text="The pay method is integrating....",this.labPayTip.textColor=10195602,this.btnAdd.enabled=!1},e.prototype.onSelectUPIApp=function(t){var e=t.currentTarget;this.rectUPIBack.x=e.x-3,this.rectUPIBack.y=e.y-3,this.rectUPIBack.visible=!0,this.pay_package=e.name,this.pay_data=[this.pay_package],this.labPayTip.text="Click to continue payment",this.labPayTip.textColor=1471762,this.btnAdd.enabled=!0,AndroidManager.getInstance().trackEvent("payment","pay_button_name",e.name)},e.prototype.onPay=function(t){if(0==this.pay_data.length&&"UPI_INTENT"==this.pay_type)return void Utils.showMessageBox(LanguageConfig.SELECT_UPI_APP);if(0==this.pay_data.length&&"UPI_COLLECT"==this.pay_type)return void Utils.showMessageBox(LanguageConfig.VERIFY_UPI_ID);if(this.pay_data.length<4&&"CARD"==this.pay_type)return void Utils.showMessageBox(LanguageConfig.ENTER_VALID_CARD_INFO);if(0==this.pay_data.length&&"NET_BANKING"==this.pay_type)return void Utils.showMessageBox(LanguageConfig.TAG_PAY_INTEGRATING);if(0==this._game.btnLock()){var e=GameController.getInstance().payAmount;GameController.getInstance().addPhonePEPayment(this.pay_type,100*e,this.pay_data)}},e.prototype.onVerifyVPA=function(t){Utils.showMessageBox(LanguageConfig.TAG_PAY_INTEGRATING)},e.prototype.onChangeCardInput=function(t){this.inputCardNumber.text&&this.inputMM.text&&this.inputYY.text&&this.inputCvv.text?(this.pay_data=[this.inputCardNumber.text,this.inputMM.text,this.inputYY.text,this.inputCvv.text],this.labPayTip.text="Click to continue payment",this.labPayTip.textColor=1471762,this.btnAdd.enabled=!0):(this.pay_data=[],this.labPayTip.text="Please enter valid card info!",this.labPayTip.textColor=10195602,this.btnAdd.enabled=!1)},e.prototype.onClose=function(t){lz.Facade.sendNotification(lz.GameFrameEvent.OPEN_VIEW,GameViewType.AppPay,"open")},e}(lz.BaseView);__reflect(AppSelectPayView.prototype,"AppSelectPayView");var ResultUserView=function(t){function e(){var e=t.call(this)||this;return e.groupTipsAry=[],e.cardViewAry=[],e.skinName="ResultUserSkin",e}return __extends(e,t),e.prototype.setDataFunc=function(t,e,i){this.imgHead.source="game_json.avatar_"+i.avatar,this.labName.text=Utils.spliteName(i.name),this.labResult.text=1==i.win?"Won":"Lost",this.labScore.text=i.score+"",this.labChips.text=i.winvalue+"",this.labTotal.text=i.currentscore+"",e==ROOM_TYPE.POINT_RUMMY&&(t==ROOM_MODE.GOLD_MODE?this.labChips.text=i.winvalue+"":this.labChips.text=i.winvalue/100+"",this.labScore.x=756,this.labScore.width=97,this.labChips.x=852,this.labChips.width=126,this.labTotal.visible=!1),e==ROOM_TYPE.POOL_RUMMY&&(this.labScore.x=756,this.labScore.width=97,this.labTotal.x=852,this.labTotal.width=126,this.labChips.visible=!1),e==ROOM_TYPE.DEAL_RUMMY&&(this.labScore.x=732,this.labScore.width=88,this.labChips.x=820,this.labChips.width=81,this.labTotal.x=899,this.labTotal.width=79),i.playerState==PLAYER_STATE.DROP_GAME||i.playerState==PLAYER_STATE.AWAY?(this.labDeclaring.visible=!1,this.doCreateMaskCard()):i.groupAry.length>0?(this.labDeclaring.visible=!1,this.doCreateResultCard(i.groupAry)):this.labDeclaring.visible=!0},e.prototype.initCards=function(){for(var t=null,e=0;13>e;++e)this.cardViewAry[e]?t=this.cardViewAry[e]:(t=new CardView,this.cardViewAry.push(t),this.pCardGroup.addChild(t=new CardView));t.doUpdateCard(null,cardTypes.CARD_DELARE)},e.prototype.doCreateMaskCard=function(){for(var t=null,e=0;13>e;++e)this.cardViewAry[e]?t=this.cardViewAry[e]:(t=new CardView,this.cardViewAry.push(t),this.pCardGroup.addChild(t=new CardView)),t.visible=!0,t.doUpdateCard(null,cardTypes.CARD_DELARE),t.x=65*e-20;this.pCardGroup.width=875},e.prototype.doCreateResultCard=function(t){for(var e=null,i=0;i<this.cardViewAry.length;++i)e=this.cardViewAry[i],e.visible=!1;for(var n=0,a=10,s=null,o=0;o<t.length;o++){for(var r=t[o],h=r.cardList,l=0;l<h.length;l++){h[l];s=this.cardViewAry[n],s||(this.pCardGroup.addChild(s=new CardView),this.cardViewAry.push(s)),s.cardIndex=n,s.visible=!0,s.doUpdateCard(h[l],cardTypes.CARD_RESULT),s.x=a,s.y=0,s.xpos=s.x,s.ypos=s.y,n++,a+=65}a+=10,a+=30}},e}(eui.Component);__reflect(ResultUserView.prototype,"ResultUserView");var ResultView=function(t){function e(){var e=t.call(this)||this;return e.rData=null,e.nTime=0,e.resultViewList=[],e._battle=DataCenter.getInstance().battle,e._game=DataCenter.getInstance().game,e}return __extends(e,t),Object.defineProperty(e.prototype,"moduleName",{get:function(){return"ResultSkin"},enumerable:!0,configurable:!0}),e.prototype.loadComplete=function(){t.prototype.loadComplete.call(this),DataCenter.getInstance().battle.newCardId=-1;for(var e=0;6>e;++e){var i=new ResultUserView;this.pUserGroup.addChild(i),i.y=74*e,i.visible=!1,this.resultViewList.push(i)}},e.prototype.onAdded=function(e){t.prototype.onAdded.call(this,e),this.btnBack.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickClose,this),this.btnNextGame.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickNextGame,this)},e.prototype.onRemoved=function(e){t.prototype.onRemoved.call(this,e),lz.UpdateManager.delUpdateable(this),this.btnBack.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickClose,this),this.btnNextGame.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickNextGame,this)},e.prototype.showKickResult=function(t){this.grpResult.visible=!0,this.labResultTitle.visible=!0,this.labResultValue.visible=!0;var e="";1==t&&(e="Long time no action.  Please Start a new game!"),2==t&&(this._game.currentRoom.mode==ROOM_MODE.GOLD_MODE&&(e="Not enough chips.  Please Start a new game!"),this._game.currentRoom.mode==ROOM_MODE.CASH_MODE&&(e="Not enough cash.  Please Start a new game!")),this.stopTime(),this.labResultTip.text=e,this.btnBack.enabled=!0},e.prototype.stopTime=function(){this.btnNextGame.enabled=!1,this.btnNextGame.label="0",this.nTime=0,lz.UpdateManager.delUpdateable(this)},e.prototype.gameOver=function(t){var e=t.result;if(this.btnNextGame.enabled=!0,this.btnBack.visible=!0,this.btnNextGame.visible=!0,this.labResultTitle.visible=!0,this.labResultValue.visible=!0,this.grpResult.visible=!0,e.isnew){var i=e.winvalue;this._game.currentRoom.type==ROOM_TYPE.DEAL_RUMMY||this._game.currentRoom.type==ROOM_TYPE.POOL_RUMMY?(this.btnBack.enabled=!0,this.stopTime(),i>=0?(this._game.currentRoom.mode==ROOM_MODE.GOLD_MODE&&(this.labResultTip.text="You're the winner of the game.",this.labResultTitle.text="Got Chips",this.labResultValue.text=e.oringingold+" + "+i+" = "+e.gold),this._game.currentRoom.mode==ROOM_MODE.CASH_MODE&&(this.labResultTip.text="You're the winner of the game.",this.labResultTitle.text="Got Cash",this.labResultValue.text=e.oringincash/100+"₹ + "+i/100+"₹ - "+e.rake/100+"₹ = "+(e.cash/100+e.cash_reward/100)+"₹")):0>i&&(this._game.currentRoom.mode==ROOM_MODE.GOLD_MODE&&(this.labResultTip.text="You were eliminated.Good luck for future game!",this.labResultTitle.text="Lost Chips",this.labResultValue.text=e.oringingold+" - "+-i+" = "+e.gold),this._game.currentRoom.mode==ROOM_MODE.CASH_MODE&&(this.labResultTip.text="You were eliminated.Good luck for future game!",this.labResultTitle.text="Lost Cash",this.labResultValue.text=e.oringincash/100+"₹ - "+-i/100+"₹ = "+(e.cash+e.cash_reward)/100+"₹"))):(this.btnBack.enabled=!0,this.nTime=9e3,lz.UpdateManager.addUpdateable(this),i>=0?(this._game.currentRoom.mode==ROOM_MODE.GOLD_MODE&&(this.labResultTip.text="You are winner. Next game will start....",this.labResultTitle.text="Got Chips",this.labResultValue.text=e.oringingold+" + "+i+" = "+e.gold),this._game.currentRoom.mode==ROOM_MODE.CASH_MODE&&(this.labResultTip.text="You are winner. Next game will start....",this.labResultTitle.text="Got Cash",this.labResultValue.text=e.oringincash/100+"₹ + "+i/100+"₹ - "+e.rake/100+"₹ = "+(e.cash/100+e.cash_reward/100)+"₹")):0>i&&(this._game.currentRoom.mode==ROOM_MODE.GOLD_MODE&&(this.labResultTip.text="You are lose.  Next game will start....",this.labResultTitle.text="Lost Chips",this.labResultValue.text=e.oringingold+" - "+-i+" = "+e.gold),this._game.currentRoom.mode==ROOM_MODE.CASH_MODE&&(this.labResultTip.text="You are lose.  Next game will start....",this.labResultTitle.text="Lost Cash",this.labResultValue.text=e.oringincash/100+"₹ - "+-i/100+"₹ = "+(e.cash+e.cash_reward)/100+"₹")))}else if(1==e.isEliminate){if(this.btnBack.enabled=!0,this.stopTime(),this._game.currentRoom.mode==ROOM_MODE.GOLD_MODE){e.gold-i;this.labResultTip.text="You are lose.  Good luck for future game!",this.labResultTitle.text="Lost Chips",this.labResultValue.text=e.oringinvalue+" - "+-i+" = "+e.gold}if(this._game.currentRoom.mode==ROOM_MODE.CASH_MODE){e.cash+e.cash_reward-i;this.labResultTip.text="You are lose.  Good luck for future game!",this.labResultTitle.text="Lost Cash",this.labResultValue.text=e.oringinvalue/100+"₹ - "+-i/100+"₹ = "+(e.cash+e.cash_reward)/100+"₹"}}else this.btnBack.enabled=!1,this.labResultTip.text="Next deal will start....",this.grpResult.visible=!1,this.nTime=9e3,lz.UpdateManager.addUpdateable(this);this.labResultTitle.text+="    Round:"+e.round},e.prototype.updateResultData=function(t){this.rData=t,t.type==ROOM_TYPE.POINT_RUMMY&&(this.imageBack.source="battle_json.scoreboard"),t.type==ROOM_TYPE.DEAL_RUMMY&&(this.imageBack.source="battle_json.scoreboard2"),t.type==ROOM_TYPE.POOL_RUMMY&&(this.imageBack.source="battle_json.scoreboard3");for(var e=this.rData.infoAry.length,i=null,n=0;e>n;++n)i=this.resultViewList[n],this.rData.infoAry[n]&&(i.setDataFunc(t.mode,t.type,this.rData.infoAry[n]),i.visible=!0);this.labResultTip.text="Wait for other player declare!",this.labResultTitle.visible=!1,this.labResultValue.visible=!1,this.grpResult.visible=!1},e.prototype.closeResultView=function(){lz.PopupManager.delPop(this),BattleController.getInstance().leaveGame()},e.prototype.onClickClose=function(t){this.closeResultView()},e.prototype.onClickNextGame=function(t){},e.prototype.update=function(t){if(this.nTime>0){var e=Math.floor(this.nTime/1e3);if(this.btnNextGame.label=e+"",1==this._battle.isLastGame&&5>e)return void this.closeResultView()}this.nTime-=t},e}(lz.BaseView);__reflect(ResultView.prototype,"ResultView",["lz.IUpdateable"]);var RuleView=function(t){function e(){var e=t.call(this)||this;return e.skinName="RuleSkin",e}return __extends(e,t),e.prototype.loadComplete=function(){t.prototype.loadComplete.call(this),this.btnColse.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickClose,this)},e.prototype.onRemoved=function(e){t.prototype.onRemoved.call(this,e),this.btnColse.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickClose,this)},e.prototype.onClickClose=function(t){lz.PopupManager.delPop(this)},e.prototype.showView=function(t){this.x=(lz.GameGlobal.screenWidth-this.width)/2,this.y=(lz.GameGlobal.screenHeight-this.height)/2,this.pTextGroup.removeChildren();var e=LanguageConfig.getLanData("Rule1"),i={};t==ROOM_TYPE.POINT_RUMMY&&(i=e[0]),t==ROOM_TYPE.POOL_RUMMY&&(i=e[1]),t==ROOM_TYPE.DEAL_RUMMY&&(i=e[2]),this.labTitle.text=i.title;for(var n=i.label,a=10,s=0;s<n.length;s++){var o=n[s],r=new eui.Label;r.size=20,r.x=10,r.y=a,r.text=o,r.width=620,this.pTextGroup.addChild(r),a+=r.height+20}},e}(lz.BaseView);__reflect(RuleView.prototype,"RuleView");var ServiceAreaView=function(t){function e(){var e=t.call(this)||this;return e._app=DataCenter.getInstance().app,e}return __extends(e,t),Object.defineProperty(e.prototype,"moduleName",{get:function(){return"AreaViewSkin"},enumerable:!0,configurable:!0}),e.prototype.loadComplete=function(){t.prototype.loadComplete.call(this),this.btnColse.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickClose,this)},e.prototype.onRemoved=function(e){t.prototype.onRemoved.call(this,e),this.btnColse.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickClose,this)},e.prototype.onClickClose=function(t){lz.PopupManager.delPop(this)},e}(lz.BaseView);__reflect(ServiceAreaView.prototype,"ServiceAreaView");var SettingView=function(t){function e(){var e=t.call(this)||this;return e._game=DataCenter.getInstance().game,e}return __extends(e,t),Object.defineProperty(e.prototype,"moduleName",{get:function(){return"SettingViewSkin"},enumerable:!0,configurable:!0}),e.prototype.loadComplete=function(){t.prototype.loadComplete.call(this),this.btnColse.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickClose,this),this.btnSound.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onChangeSound,this),this.btnVibration.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onChangeVibration,this),this.btnNotification.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onChangeNotification,this),this.grpLanguage1.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onChangeLanguage1,this),this.grpLanguage2.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onChangeLanguage2,this),this.updateSetting()},e.prototype.onRemoved=function(e){t.prototype.onRemoved.call(this,e),this.btnColse.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickClose,this),this.btnSound.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onChangeSound,this),this.btnVibration.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onChangeVibration,this),this.btnNotification.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onChangeNotification,this),this.grpLanguage1.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onChangeLanguage1,this),this.grpLanguage2.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onChangeLanguage2,this)},e.prototype.updateSetting=function(){1==this._game.soundOpen?this.btnSound.source="game_json.s1":this.btnSound.source="game_json.s2",1==this._game.vibrationOpen?this.btnVibration.source="game_json.s1":this.btnVibration.source="game_json.s2",1==this._game.notificationOpen?this.btnNotification.source="game_json.s1":this.btnNotification.source="game_json.s2"},e.prototype.onClickClose=function(t){lz.PopupManager.delPop(this)},e.prototype.onChangeSound=function(t){this._game.changeSoundOpen(),this.updateSetting()},e.prototype.onChangeVibration=function(t){this._game.changeVibrationOpen(),this.updateSetting()},e.prototype.onChangeNotification=function(t){this._game.changeNotificationOpen(),this.updateSetting()},e.prototype.onChangeLanguage1=function(t){},e.prototype.onChangeLanguage2=function(t){},e}(lz.BaseView);__reflect(SettingView.prototype,"SettingView");var BonusItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="BonusItemSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.bonus_id=this.data.id,this.labName.text=this.data.name,this.labBonus.text=this.data.bonus;var e=this.data.index;e%2==0?this.backRect.fillColor=16053492:this.backRect.fillColor=14737632,0==this.data.collect?(this.btnCollect.enabled=!0,this.btnCollect.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onCollectBonus,this)):this.btnCollect.enabled=!1},e.prototype.onCollectBonus=function(t){GameController.getInstance().collectBonus(this.bonus_id)},e}(eui.ItemRenderer);__reflect(BonusItem.prototype,"BonusItem");var BonusView=function(t){function e(){var e=t.call(this)||this;return e._game=DataCenter.getInstance().game,e}return __extends(e,t),Object.defineProperty(e.prototype,"moduleName",{get:function(){return"BonusViewSkin"},enumerable:!0,configurable:!0}),e.prototype.notificationListeners=function(){return[GameEvent.UPDATE_BONUS]},e.prototype.executeNotification=function(t,e,i){switch(t){case GameEvent.UPDATE_BONUS:this.showList()}},e.prototype.loadComplete=function(){t.prototype.loadComplete.call(this),this.btnOpenShare.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onOpenShare,this),this.labNone.visible=0==this._game.bonusList.length},e.prototype.getBonusList=function(){0==this._game.btnLock(3e3)&&GameController.getInstance().getBonusList(1)},e.prototype.onRemoved=function(e){t.prototype.onRemoved.call(this,e),this.btnOpenShare.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onOpenShare,this)},e.prototype.onOpenShare=function(t){lz.Facade.sendNotification(GameEvent.OPEN_SHARE,{})},e.prototype.showList=function(){this.labNone.visible=0==this._game.bonusList.length,this.dataGroup.itemRenderer=BonusItem,this.dataGroup.dataProvider=new eui.ArrayCollection(this._game.bonusList)},e}(lz.BaseView);__reflect(BonusView.prototype,"BonusView");var ContactItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="ContactItemSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.labName.text=this.data.name;var e=this.data.index;e%2==0?this.backRect.fillColor=16053492:this.backRect.fillColor=14737632},e}(eui.ItemRenderer);__reflect(ContactItem.prototype,"ContactItem");var ContactView=function(t){function e(){var e=t.call(this)||this;return e._game=DataCenter.getInstance().game,e}return __extends(e,t),Object.defineProperty(e.prototype,"moduleName",{get:function(){return"ContactViewSkin"},enumerable:!0,configurable:!0}),e.prototype.loadComplete=function(){t.prototype.loadComplete.call(this),this.btnOpenShare.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onOpenShare,this)},e.prototype.onRemoved=function(e){t.prototype.onRemoved.call(this,e),this.btnOpenShare.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onOpenShare,this)},e.prototype.showList=function(){this.labNone.visible=0==this._game.bonusList.length,console.log("showContacts,listLength = ",this._game.contactList.length),this.dataGroup.itemRenderer=ContactItem,this.dataGroup.dataProvider=new eui.ArrayCollection(this._game.contactList)
},e.prototype.onOpenShare=function(t){lz.Facade.sendNotification(GameEvent.OPEN_SHARE,{})},e}(lz.BaseView);__reflect(ContactView.prototype,"ContactView");var ShareView=function(t){function e(){var e=t.call(this)||this;return e._app=DataCenter.getInstance().app,e._game=DataCenter.getInstance().game,e._player=DataCenter.getInstance().player,e}return __extends(e,t),Object.defineProperty(e.prototype,"moduleName",{get:function(){return"ShareViewSkin"},enumerable:!0,configurable:!0}),e.prototype.loadComplete=function(){t.prototype.loadComplete.call(this),this.btnBonus.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onOpenBonus,this),this.grpContact.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onShare,this),this.grpWA.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onShareWA,this)},e.prototype.onRemoved=function(e){t.prototype.onRemoved.call(this,e),this.btnBonus.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onOpenBonus,this),this.grpContact.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onShare,this),this.grpWA.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onShareWA,this)},e.prototype.onOpenBonus=function(t){lz.Facade.sendNotification(GameEvent.OPEN_BONUS,{})},e.prototype.onShareWA=function(t){0==this._game.btnLock()&&AndroidManager.getInstance().shareApp("share_wa",String(this._player.userId))},e.prototype.onShare=function(t){0==this._game.btnLock()&&AndroidManager.getInstance().shareApp("share_app",String(this._player.userId))},e}(lz.BaseView);__reflect(ShareView.prototype,"ShareView");