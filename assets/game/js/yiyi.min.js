var __reflect=this&&this.__reflect||function(p,c,t){p.__class__=c,t?t.push(c):t=[c],p.__types__=p.__types__?t.concat(p.__types__):t};var __extends=this&&this.__extends||function __extends(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);r.prototype=e.prototype,t.prototype=new r};var __awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){return new(P||(P=Promise))(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator["throw"](value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):new P(function(resolve){resolve(result.value)}).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})};var __generator=this&&this.__generator||function(thisArg,body){var _={label:0,sent:function(){if(t[0]&1)throw t[1];return t[1]},trys:[],ops:[]},f,y,t,g;return g={next:verb(0),throw:verb(1),return:verb(2)},typeof Symbol==="function"&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){return step([n,v])}}function step(op){if(f)throw new TypeError("Generator is already executing.");while(_)try{if(f=1,y&&(t=y[op[0]&2?"return":op[0]?"throw":"next"])&&!(t=t.call(y,op[1])).done)return t;if(y=0,t)op=[0,t.value];switch(op[0]){case 0:case 1:t=op;break;case 4:_.label++;return{value:op[1],done:false};case 5:_.label++;y=op[1];op=[0];continue;case 7:op=_.ops.pop();_.trys.pop();continue;default:if(!(t=_.trys,t=t.length>0&&t[t.length-1])&&(op[0]===6||op[0]===2)){_=0;continue}if(op[0]===3&&(!t||op[1]>t[0]&&op[1]<t[3])){_.label=op[1];break}if(op[0]===6&&_.label<t[1]){_.label=t[1];t=op;break}if(t&&_.label<t[2]){_.label=t[2];_.ops.push(op);break}if(t[2])_.ops.pop();_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e];y=0}finally{f=t=0}if(op[0]&5)throw op[1];return{value:op[0]?op[1]:void 0,done:true}}};var lz;(function(lz){var BaseView=function(_super){__extends(BaseView,_super);function BaseView(){var _this=_super.call(this)||this;_this.isComplete=false;_this.gameDispatcher=lz.GameDispatcher.getInstance();_this.addEventListener(egret.Event.ADDED_TO_STAGE,_this.onAdded,_this);_this.addEventListener(egret.Event.REMOVED_FROM_STAGE,_this.onRemoved,_this);return _this}BaseView.prototype.showSelf=function(){this.visible=true};BaseView.prototype.hideSelf=function(){this.visible=false};Object.defineProperty(BaseView.prototype,"moduleName",{get:function(){return""},enumerable:true,configurable:true});Object.defineProperty(BaseView.prototype,"resource",{get:function(){return""},enumerable:true,configurable:true});BaseView.prototype.notificationListeners=function(){return[]};BaseView.prototype.executeNotification=function(notificationName,obj,obj2){};BaseView.prototype.reloadComplete=function(){};BaseView.prototype.onAdded=function(event){this.removeEventListener(egret.Event.ADDED_TO_STAGE,this.onAdded,this);if(this.resource.length>0){this.loadGroup()}else{this.loadComplete()}};BaseView.prototype.loadGroup=function(){this.touchEnabled=false;this.touchChildren=false;RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onModuleLoadComplete,this);RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onModuleLoadError,this);RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onModuleProgress,this);RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this);RES.loadGroup(this.resource)};BaseView.prototype.onModuleLoadError=function(event){this.onModuleLoadComplete(event)};BaseView.prototype.onModuleProgress=function(event){if(event.groupName==this.resource){}};BaseView.prototype.onItemLoadError=function(event){};BaseView.prototype.onModuleLoadComplete=function(event){if(event.groupName==this.resource){this.touchEnabled=true;this.touchChildren=true;RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this);RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onModuleLoadComplete,this);RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onModuleLoadError,this);RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onModuleProgress,this);this.loadComplete()}};BaseView.prototype.loadComplete=function(){this.isComplete=true;if(this.moduleName.length>0){this.skinName=this.moduleName}if(lz.GameGlobal.isFullScreen){this.left=0;this.right=0;this.top=0;this.bottom=0}lz.Facade.registerNotifListeners(this)};BaseView.prototype.onRemoved=function(event){lz.Facade.removeNotifListeners(this);this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemoved,this);this.removeChildren()};return BaseView}(eui.Component);lz.BaseView=BaseView;__reflect(BaseView.prototype,"lz.BaseView",["lz.IMediator"])})(lz||(lz={}));var lz;(function(lz){var LoadingViewCE=function(_super){__extends(LoadingViewCE,_super);function LoadingViewCE(bgRes,logoRes,logoTop,barBg,barThumb){var _this=_super.call(this)||this;_this.loadingBar=new lz.UIProgressBar(barBg,barThumb);var grp=new eui.Group;_this.width=lz.GameGlobal.screenWidth;_this.height=lz.GameGlobal.screenHeight;var bg=new eui.Image;bg.texture=RES.getRes(bgRes);grp.addChild(bg);grp.addChild(_this.loadingBar);if(logoRes){var logo=new eui.Image;logo.texture=RES.getRes(logoRes);logo.horizontalCenter=0;logo.top=logoTop;grp.addChild(logo)}if(lz.GameGlobal.baseLayer.stage.orientation==egret.OrientationMode.LANDSCAPE){_this.loadingBar.y=329;_this.loadingBar.width=782;_this.loadingBar.horizontalCenter=0}else{_this.loadingBar.y=880;_this.loadingBar.left=20;_this.loadingBar.right=20;_this.loadingBar.horizontalCenter=0}_this.addChild(grp);if(lz.GameGlobal.isFullScreen){lz.DisplayUtils.doFullScreen(grp);lz.DisplayUtils.doFullScreen(bg)}else{grp.verticalCenter=0;grp.horizontalCenter=0}return _this}Object.defineProperty(LoadingViewCE.prototype,"moduleName",{get:function(){return""},enumerable:true,configurable:true});return LoadingViewCE}(lz.BaseView);lz.LoadingViewCE=LoadingViewCE;__reflect(LoadingViewCE.prototype,"lz.LoadingViewCE")})(lz||(lz={}));var lz;(function(lz){var Updateable=function(_super){__extends(Updateable,_super);function Updateable(){var _this=_super.call(this)||this;_this._pause=false;_this.deleted=false;_this.addEventListener(egret.Event.ADDED_TO_STAGE,_this.onAdded,_this);_this.addEventListener(egret.Event.REMOVED_FROM_STAGE,_this.onRemoved,_this);return _this}Updateable.prototype.onAdded=function(event){if(this.pause){this.stop()}else{this.play()}this.removeEventListener(egret.Event.ADDED_TO_STAGE,this.onAdded,this)};Updateable.prototype.onRemoved=function(event){this.stop();this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.onAdded,this)};Updateable.prototype.stop=function(){lz.UpdateManager.delUpdateable(this)};Updateable.prototype.play=function(){this.deleted=false;lz.UpdateManager.addUpdateable(this)};Updateable.prototype.update=function(delta){};Object.defineProperty(Updateable.prototype,"pause",{get:function(){return this._pause},set:function(value){if(this._pause!=value){this._pause=value;if(!value){this.play()}else{this.stop()}}},enumerable:true,configurable:true});return Updateable}(eui.Image);lz.Updateable=Updateable;__reflect(Updateable.prototype,"lz.Updateable",["lz.IUpdateable"])})(lz||(lz={}));var astar;(function(astar){var AStar=function(){function AStar(){this._straightCost=1;this._diagCost=Math.SQRT2;this._heuristic=this.diagonal}AStar.prototype.findPath=function(grid){this._grid=grid;this._open=[];this._closed=[];this._startNode=this._grid.startNode;this._endNode=this._grid.endNode;this._startNode.g=0;this._startNode.h=this._heuristic(this._startNode);this._startNode.f=this._startNode.g+this._startNode.h;return this.search()};AStar.prototype.search=function(){var node=this._startNode;while(node!=this._endNode){var startX=Math.max(0,node.x-1);var endX=Math.min(this._grid.numCols-1,node.x+1);var startY=Math.max(0,node.y-1);var endY=Math.min(this._grid.numRows-1,node.y+1);for(var i=startX;i<=endX;i++){for(var j=startY;j<=endY;j++){if(i!=node.x&&j!=node.y){continue}var test=this._grid.getNode(i,j);if(test==node||!test.walkable||!this._grid.getNode(node.x,test.y).walkable||!this._grid.getNode(test.x,node.y).walkable){continue}var cost=this._straightCost;if(!(node.x==test.x||node.y==test.y)){cost=this._diagCost}var g=node.g+cost*test.costMultiplier;var h=this._heuristic(test);var f=g+h;if(this.isOpen(test)||this.isClosed(test)){if(test.f>f){test.f=f;test.g=g;test.h=h;test.parent=node}}else{test.f=f;test.g=g;test.h=h;test.parent=node;this._open.push(test)}}}for(var o=0;o<this._open.length;o++){}this._closed.push(node);if(this._open.length==0){console.log("AStar >> no path found");return false}var openLen=this._open.length;for(var m=0;m<openLen;m++){for(var n=m+1;n<openLen;n++){if(this._open[m].f>this._open[n].f){var temp=this._open[m];this._open[m]=this._open[n];this._open[n]=temp}}}node=this._open.shift()}this.buildPath();return true};AStar.prototype.buildPath=function(){this._path=new Array;var node=this._endNode;this._path.push(node);while(node!=this._startNode){node=node.parent;this._path.unshift(node)}};Object.defineProperty(AStar.prototype,"path",{get:function(){return this._path},enumerable:true,configurable:true});AStar.prototype.isOpen=function(node){for(var i=0;i<this._open.length;i++){if(this._open[i]==node){return true}}return false};AStar.prototype.isClosed=function(node){for(var i=0;i<this._closed.length;i++){if(this._closed[i]==node){return true}}return false};AStar.prototype.manhattan=function(node){return Math.abs(node.x-this._endNode.x)*this._straightCost+Math.abs(node.y+this._endNode.y)*this._straightCost};AStar.prototype.euclidian=function(node){var dx=node.x-this._endNode.x;var dy=node.y-this._endNode.y;return Math.sqrt(dx*dx+dy*dy)*this._straightCost};AStar.prototype.diagonal=function(node){var dx=Math.abs(node.x-this._endNode.x);var dy=Math.abs(node.y-this._endNode.y);var diag=Math.min(dx,dy);var straight=dx+dy;return this._diagCost*diag+this._straightCost*(straight-2*diag)};Object.defineProperty(AStar.prototype,"visited",{get:function(){return this._closed.concat(this._open)},enumerable:true,configurable:true});return AStar}();astar.AStar=AStar;__reflect(AStar.prototype,"astar.AStar")})(astar||(astar={}));var astar;(function(astar){var Grid=function(){function Grid(numCols,numRows){this._numCols=numCols;this._numRows=numRows;this._nodes=[];for(var i=0;i<numCols;i++){this._nodes[i]=[];for(var j=0;j<numRows;j++){this._nodes[i][j]=new astar.Node(i,j)}}}Grid.prototype.getNode=function(x,y){return this._nodes[x][y]};Grid.prototype.setEndNode=function(x,y){this._endNode=this._nodes[x][y]};Grid.prototype.setStartNode=function(x,y){this._startNode=this._nodes[x][y]};Grid.prototype.setWalkable=function(x,y,value){this._nodes[x][y].walkable=value};Object.defineProperty(Grid.prototype,"endNode",{get:function(){return this._endNode},enumerable:true,configurable:true});Object.defineProperty(Grid.prototype,"numCols",{get:function(){return this._numCols},enumerable:true,configurable:true});Object.defineProperty(Grid.prototype,"numRows",{get:function(){return this._numRows},enumerable:true,configurable:true});Object.defineProperty(Grid.prototype,"startNode",{get:function(){return this._startNode},enumerable:true,configurable:true});return Grid}();astar.Grid=Grid;__reflect(Grid.prototype,"astar.Grid")})(astar||(astar={}));var astar;(function(astar){var Node=function(){function Node(x,y){this.walkable=true;this.costMultiplier=1;this.x=x;this.y=y}return Node}();astar.Node=Node;__reflect(Node.prototype,"astar.Node")})(astar||(astar={}));var lz;(function(lz){var BaseFactory=function(){function BaseFactory(){}BaseFactory.getVoByID=function(baseName,value){var infoData=lz.XMLManager.getInstance().getDataByName(baseName);return infoData?infoData[value]:null};BaseFactory.getVoByKeys=function(baseName,key,value,key1,value1){if(key1===void 0){key1=""}if(value1===void 0){value1=null}var infoData=lz.XMLManager.getInstance().getDataByName(baseName);if(infoData){var vo=null;for(var kVal in infoData){vo=infoData[kVal];if(vo[key]==value&&(key1.length==0||vo[key1]==value1)){return vo}}}return null};BaseFactory.getVoByKeys2=function(baseName,key,value,key1,value1,key2,value2){if(key1===void 0){key1=""}if(value1===void 0){value1=null}if(key2===void 0){key2=""}if(value2===void 0){value2=null}var infoData=lz.XMLManager.getInstance().getDataByName(baseName);if(infoData){var vo=null;for(var kVal in infoData){vo=infoData[kVal];if(vo[key]==value&&vo[key1]==value1&&vo[key2]==value2){return vo}}}return null};BaseFactory.getVoListByKeys=function(baseName,key,value,key1,value1){if(key===void 0){key=""}if(value===void 0){value=null}if(key1===void 0){key1=""}if(value1===void 0){value1=null}var infoData=lz.XMLManager.getInstance().getDataByName(baseName);var returnVos=[];if(infoData){var vo=null;for(var kVal in infoData){vo=infoData[kVal];if(key.length>0){if(vo[key]==value&&(key1.length==0||vo[key1]==value1)){returnVos.push(vo)}}else{returnVos.push(vo)}}return returnVos}return returnVos};return BaseFactory}();lz.BaseFactory=BaseFactory;__reflect(BaseFactory.prototype,"lz.BaseFactory")})(lz||(lz={}));var lz;(function(lz){var BaseRenderView=function(_super){__extends(BaseRenderView,_super);function BaseRenderView(){var _this=_super.call(this)||this;_this.touchChildren=false;if(_this.moduleName.length>0){_this.skinName=_this.moduleName}_this.addEventListener(egret.Event.ADDED_TO_STAGE,_this.onAdded,_this);_this.addEventListener(egret.Event.REMOVED_FROM_STAGE,_this.onRemoved,_this);return _this}BaseRenderView.prototype.getCurrentState=function(){return this._state};BaseRenderView.prototype.setCurrentState=function(state){this._state=state;this.invalidateState()};BaseRenderView.prototype.notificationListeners=function(){return[]};BaseRenderView.prototype.executeNotification=function(notificationName,obj,obj2){};Object.defineProperty(BaseRenderView.prototype,"moduleName",{get:function(){return""},enumerable:true,configurable:true});BaseRenderView.prototype.onAdded=function(event){this.removeEventListener(egret.Event.ADDED_TO_STAGE,this.onAdded,this);lz.Facade.registerNotifListeners(this)};BaseRenderView.prototype.onRemoved=function(event){lz.Facade.removeNotifListeners(this);this.removeChildren();this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemoved,this)};return BaseRenderView}(eui.ItemRenderer);lz.BaseRenderView=BaseRenderView;__reflect(BaseRenderView.prototype,"lz.BaseRenderView",["lz.IMediator"])})(lz||(lz={}));var DebugPlatform=function(){function DebugPlatform(){}DebugPlatform.prototype.getUserInfo=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){return[2,{nickName:"username"}]})})};DebugPlatform.prototype.tsCallNative=function(functionName,param){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){return[2]})})};DebugPlatform.prototype.login=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){return[2]})})};DebugPlatform.prototype.checkUpdate=function(){};DebugPlatform.prototype.showShareMenu=function(){};DebugPlatform.prototype.onShareAppMessage=function(){};DebugPlatform.prototype.shareAppMessage=function(title,imageUrl,query){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){return[2]})})};DebugPlatform.prototype.vibrate=function(type,completeFun){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){return[2]})})};DebugPlatform.prototype.createVideoAd=function(adUnitId){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){return[2]})})};DebugPlatform.prototype.showModal=function(title,content){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){return[2]})})};DebugPlatform.prototype.createAppBox=function(adUnitId){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){return[2]})})};DebugPlatform.prototype.createBannerAd=function(adUnitId,pX,w,h,bottom,isShow){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){return[2]})})};DebugPlatform.prototype.createInterstitialAd=function(adUnitId){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){return[2]})})};DebugPlatform.prototype.destroyInterstitialAd=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){return[2]})})};DebugPlatform.prototype.hideInterstitialAd=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){return[2]})})};DebugPlatform.prototype.showInterstitialAd=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){return[2]})})};DebugPlatform.prototype.hideBannerAd=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){return[2]})})};DebugPlatform.prototype.showBannerAd=function(px){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){return[2]})})};DebugPlatform.prototype.destroyBannerAd=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){return[2]})})};DebugPlatform.prototype.getBannerAdStyle=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){return[2]})})};DebugPlatform.prototype.getSystemInfo=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){return[2]})})};DebugPlatform.prototype.showToast=function(title){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){return[2]})})};DebugPlatform.prototype.navigateToMiniProgram=function(appId,param,envVersion){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){return[2]})})};DebugPlatform.prototype.previewImage=function(url){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){return[2]})})};DebugPlatform.prototype.setClipboardData=function(data){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){return[2]})})};DebugPlatform.prototype.setUserCloudStorage=function(kvobj){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){return[2]})})};DebugPlatform.prototype.createVideo=function(url){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){return[2]})})};DebugPlatform.prototype.chooseImage=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){return[2]})})};DebugPlatform.prototype.savePhoto=function(url){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){return[2]})})};DebugPlatform.prototype.drawPhoto=function(type){var arg=[];for(var _i=1;_i<arguments.length;_i++){arg[_i-1]=arguments[_i]}return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){return[2]})})};DebugPlatform.prototype.sendShareData=function(kvobj){};DebugPlatform.prototype.aldSendEvent=function(name,param){};DebugPlatform.prototype.aldStage=function(type,param){};DebugPlatform.prototype.onShow=function(callback){};DebugPlatform.prototype.offShow=function(callback){};DebugPlatform.prototype.getLaunchOptionsSync=function(){};return DebugPlatform}();__reflect(DebugPlatform.prototype,"DebugPlatform",["Platform"]);if(!window.platform){window.platform=new DebugPlatform}var lz;(function(lz){var Wait=function(_super){__extends(Wait,_super);function Wait(){var _this=_super.call(this)||this;_this.deleted=false;_this.delayClock=0;_this.closeClock=0;_this.waitIndex="0";_this.imgLoading=new eui.Image;return _this}Wait.prototype.update=function(delta){this.imgLoading.rotation+=10};Object.defineProperty(Wait.prototype,"moduleName",{get:function(){return Wait._skin},enumerable:true,configurable:true});Object.defineProperty(Wait.prototype,"resource",{get:function(){return Wait._group},enumerable:true,configurable:true});Wait.setSkin=function(skin,group){if(skin===void 0){skin=""}if(group===void 0){group=""}this._skin=skin;this._group=group};Wait.prototype.onAdded=function(event){_super.prototype.onAdded.call(this,event);this.x=(lz.GameGlobal.screenWidth-this.width)/2;this.y=(lz.GameGlobal.screenHeight-this.height)/2;this.imgLoading.visible=false;lz.UpdateManager.addUpdateable(this)};Wait.prototype.delayCall=function(){this.closeClock=egret.setTimeout(Wait.hide,this,2e4);this.imgLoading.visible=true};Wait.prototype.loadComplete=function(){_super.prototype.loadComplete.call(this);this.delayClock=egret.setTimeout(this.delayCall,this,200)};Wait.prototype.onRemoved=function(event){egret.clearTimeout(this.delayClock);egret.clearTimeout(this.closeClock);egret.clearTimeout(Wait.offClock);lz.UpdateManager.delUpdateable(this)};Wait.show=function(index){if(index===void 0){index="0"}Wait.waitIndex=index;lz.GameGlobal.lock();if(Wait._instance==null){Wait._instance=new Wait}else{Wait._instance.addEventListener(egret.Event.ADDED_TO_STAGE,Wait._instance.onAdded,Wait._instance);Wait._instance.addEventListener(egret.Event.REMOVED_FROM_STAGE,Wait._instance.onRemoved,Wait._instance)}if(Wait._instance.parent==null){if(Wait.clockId==0){Wait.clockId=egret.setTimeout(Wait.delayCall,Wait,200)}}console.log("Wait.SHOW----waitIndex="+Wait.waitIndex)};Wait.delayCall=function(){lz.PopupManager.addAlert(Wait._instance)};Wait.hide=function(){lz.GameGlobal.unLock();egret.clearTimeout(Wait.clockId);Wait.clockId=0;if(Wait._instance&&Wait._instance.parent!=null){lz.PopupManager.delAlert(Wait._instance)}console.log("Wait.HIDE----waitIndex="+Wait.waitIndex);Wait.waitIndex="0"};Wait._skin="";Wait._group="";Wait.clockId=0;return Wait}(lz.BaseView);lz.Wait=Wait;__reflect(Wait.prototype,"lz.Wait",["lz.IUpdateable"])})(lz||(lz={}));var lz;(function(lz){var BaseBridgeConfig=function(){function BaseBridgeConfig(){}BaseBridgeConfig.SHARE="wxshareurl";BaseBridgeConfig.WXCODE="get_wxCode";BaseBridgeConfig.OPEN_ADV="openadv";return BaseBridgeConfig}();lz.BaseBridgeConfig=BaseBridgeConfig;__reflect(BaseBridgeConfig.prototype,"lz.BaseBridgeConfig")})(lz||(lz={}));var lz;(function(lz){var BridgeConfig=function(){function BridgeConfig(){}BridgeConfig.NATIVE_CALL_EGRET="sendToJS";BridgeConfig.EGRET_CALL_NATIVE="sendToNative";BridgeConfig.SHOW_VIDEO="showVideo";BridgeConfig.SHOW_BANNER="showBanner";BridgeConfig.SHOW_INTERSTITIAL="showInterstitial";BridgeConfig.SHOW_VIDEO_CALLBACK="showVideoCallback";return BridgeConfig}();lz.BridgeConfig=BridgeConfig;__reflect(BridgeConfig.prototype,"lz.BridgeConfig")})(lz||(lz={}));var lz;(function(lz){var CODE;(function(CODE){CODE[CODE["NOVIDEO"]=999]="NOVIDEO"})(CODE=lz.CODE||(lz.CODE={}));var Config=function(){function Config(){}Object.defineProperty(Config,"viewWidth",{get:function(){if(!this._viewWidth){this._viewWidth=egret.MainContext.instance.stage.stageWidth}return this._viewWidth},set:function(v){this._viewWidth=v},enumerable:true,configurable:true});Object.defineProperty(Config,"viewHeight",{get:function(){if(!this._viewHeight){this._viewHeight=egret.MainContext.instance.stage.stageHeight}return this._viewHeight},set:function(v){this._viewHeight=v},enumerable:true,configurable:true});Config.gameMode=0;return Config}();lz.Config=Config;__reflect(Config.prototype,"lz.Config")})(lz||(lz={}));var lz;(function(lz){var GameConfig=function(){function GameConfig(){}GameConfig.initConfig=function(description){GameConfig.httpGameUrl="";GameConfig.debug=description["debug"];GameConfig.serverID=description["serverID"];GameConfig.clientType=description["clientType"];if(GameConfig.serverID){GameConfig.httpURL=description["httpURL"+GameConfig.serverID]}else if(description["httpURL1"]){GameConfig.httpURL=description["httpURL1"]}GameConfig.version=description["version"];GameConfig.gameName=description["gameName"];GameConfig.check=description["check"];GameConfig.share=description["share"];GameConfig.isOpenKeyBoard=description["isOpenKeyBoard"];GameConfig.channel=description["channel"];GameConfig.isInsertSDK=description["isInsertSDK"];GameConfig.videoErrorToShare=description["videoErrorToShare"];if(description["isCross"]){GameConfig.isCross=description["isCross"]}if(description["videoid"]){GameConfig.videoid=description["videoid"]}if(description["bannerid"]){GameConfig.bannerid=description["bannerid"]}if(GameConfig.channel==1001){GameConfig.backURL=description["backURL1"]}else{GameConfig.backURL=description["backURL"]}if(description["downloadUrl"]){GameConfig.downloadUrl=description["downloadUrl"]}GameConfig.orCodeUrl=description["orCodeUrl"]};GameConfig.modifyConfig=function(key,value){if(GameConfig[key]){GameConfig[key]=value}};GameConfig.initADConfig=function(description){this.videoid=description["videoid"];this.bannerid=description["bannerid"];this.interstitialid=description["interstitialid"];this.nativeid=description["nativeid"]};GameConfig.downloadUrl="https://lzqyx.lanzhi.tech/page/download";GameConfig.isCross=false;GameConfig.refreshBannerTime=60;GameConfig.resUrl="";GameConfig.serverID=1;return GameConfig}();lz.GameConfig=GameConfig;__reflect(GameConfig.prototype,"lz.GameConfig")})(lz||(lz={}));var lz;(function(lz){var SceneConfig=function(){function SceneConfig(){}Object.defineProperty(SceneConfig,"scene",{get:function(){return this._scene},set:function(v){this._scene=v},enumerable:true,configurable:true});SceneConfig.INTENSIFY="qianghua";SceneConfig.RESULT="jiesuan";SceneConfig.START="kaishi";SceneConfig.SELECTIONLEVEL="guanqia";SceneConfig.QUIT="tuichu";SceneConfig.MOREGAME="jiugongge";SceneConfig.lzScene="StartView";return SceneConfig}();lz.SceneConfig=SceneConfig;__reflect(SceneConfig.prototype,"lz.SceneConfig")})(lz||(lz={}));var lz;(function(lz){var KeyBoardController=function(){function KeyBoardController(){this.isBattle=true;if(lz.GameConfig.isOpenKeyBoard){this._kb=new KeyBoard;this._kb.addEventListener(KeyBoard.onkeydown,this.onkeydown,this);this._kb.addEventListener(KeyBoard.onkeyup,this.onKeyUp,this)}}KeyBoardController.getInstance=function(){if(KeyBoardController.instance==null){KeyBoardController.instance=new KeyBoardController}return KeyBoardController.instance};KeyBoardController.prototype.onkeydown=function(event){if(!this.isBattle||lz.GameGlobal.isPauseGame){return}lz.GameDispatcher.getInstance().dispatchEventWith(lz.GameFrameEvent.KEYBOARD_DOWN,false,event.data);lz.Facade.sendNotification(lz.GameFrameEvent.KEYBOARD_DOWN,event.data)};KeyBoardController.prototype.onKeyUp=function(event){lz.GameDispatcher.getInstance().dispatchEventWith(lz.GameFrameEvent.KEYBOARD_UP,false,event.data);lz.Facade.sendNotification(lz.GameFrameEvent.KEYBOARD_UP,event.data)};return KeyBoardController}();lz.KeyBoardController=KeyBoardController;__reflect(KeyBoardController.prototype,"lz.KeyBoardController")})(lz||(lz={}));var lz;(function(lz){var AldEvent=function(){function AldEvent(){}AldEvent.GameStart="GameStart";AldEvent.Cash="Cash";AldEvent.OtherGame="OtherGame";AldEvent.GameScore="GameScore";AldEvent.GoldAdv="GoldAdv";AldEvent.GameItemAdv="GameItemAdv";AldEvent.AliveAdv="AliveAdv";AldEvent.VIDEO_FAIL_SHARE="视频播放失败转分享";AldEvent.ADV_PLAY_START="视频开始播放";AldEvent.ADV_PLAY_COMPLETE="视频播放完成";return AldEvent}();lz.AldEvent=AldEvent;__reflect(AldEvent.prototype,"lz.AldEvent")})(lz||(lz={}));var lz;(function(lz){var GameFrameEvent=function(){function GameFrameEvent(){}GameFrameEvent.OPEN_VIEW="GameEvent_Open_view";GameFrameEvent.KEYBOARD_DOWN="GameEvent_KEYBOARD_down";GameFrameEvent.KEYBOARD_UP="GameEvent_KEYBOARD_up";GameFrameEvent.NATIVE_CALLBACK="NativeCallEgret";GameFrameEvent.HIDE_BANNER="GameEvent_Hide_Banner";GameFrameEvent.SHOW_BANNER="GameEvent_Show_Banner";return GameFrameEvent}();lz.GameFrameEvent=GameFrameEvent;__reflect(GameFrameEvent.prototype,"lz.GameFrameEvent")})(lz||(lz={}));var lz;(function(lz){var DragonBonesFactory=function(){function DragonBonesFactory(){this._factory=dragonBones.EgretFactory.factory}Object.defineProperty(DragonBonesFactory,"instance",{get:function(){if(DragonBonesFactory._instance==null)DragonBonesFactory._instance=new DragonBonesFactory;return DragonBonesFactory._instance},enumerable:true,configurable:true});DragonBonesFactory.prototype.getMovieByRes=function(movie){var s=RES.getRes(movie+"_ske_dbmv");var t=RES.getRes(movie+"_tex_png");dragonBones.addMovieGroup(s,t);var m=dragonBones.buildMovie(movie);return m};DragonBonesFactory.prototype.getArmatureByRes=function(movie,texture){var s=RES.getRes(movie+"_ske_dbbin");var t=RES.getRes(texture);var j=RES.getRes(movie+"_tex_json");this._factory.parseDragonBonesData(s);this._factory.parseTextureAtlasData(j,t);var m=this._factory.buildArmatureDisplay(movie);return m};return DragonBonesFactory}();lz.DragonBonesFactory=DragonBonesFactory;__reflect(DragonBonesFactory.prototype,"lz.DragonBonesFactory")})(lz||(lz={}));var lz;(function(lz){var BaseSettingGlobal=function(){function BaseSettingGlobal(){}BaseSettingGlobal.MUSIC="Music";BaseSettingGlobal.SOUND="Sound";BaseSettingGlobal.VOLUME="Volume";BaseSettingGlobal.ZHENDONG="WZTJ_zhendong";BaseSettingGlobal.SETTING_ON="1";BaseSettingGlobal.SETTING_OFF="0";return BaseSettingGlobal}();lz.BaseSettingGlobal=BaseSettingGlobal;__reflect(BaseSettingGlobal.prototype,"lz.BaseSettingGlobal")})(lz||(lz={}));var lz;(function(lz){var GameGlobal=function(){function GameGlobal(){}GameGlobal.start=function(main,orientationMode,gameId,isFullScreen,defaultW,defaultH){if(orientationMode===void 0){orientationMode=egret.OrientationMode.PORTRAIT}if(gameId===void 0){gameId=0}if(isFullScreen===void 0){isFullScreen=false}if(defaultW===void 0){defaultW=720}if(defaultH===void 0){defaultH=1280}GameGlobal.baseLayer=main;main.stage.orientation=orientationMode;lz.GameConfig.gameId=gameId;GameGlobal.isFullScreen=isFullScreen;if(GameGlobal.isFullScreen){GameGlobal.screenWidth=main.stage.stageWidth;GameGlobal.screenHeight=main.stage.stageHeight}else{GameGlobal.screenWidth=orientationMode==egret.OrientationMode.PORTRAIT?defaultW:defaultH;GameGlobal.screenHeight=orientationMode==egret.OrientationMode.PORTRAIT?defaultH:defaultW}lz.PlatformUtil.init()};GameGlobal.init=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){lz.SoundManager.init();lz.KeyBoardController.getInstance();return[2]})})};GameGlobal.initGame=function(main){GameGlobal.baseLayer=main;main.touchEnabled=false;GameGlobal.gameLayer=new eui.UILayer;GameGlobal.gameLayer.name="gameLayer";main.addChild(GameGlobal.gameLayer);GameGlobal.gameLayer.touchThrough=true;GameGlobal.gameLayer.touchEnabled=false;GameGlobal.uiLayer=new eui.UILayer;GameGlobal.uiLayer.name="uiLayer";main.addChild(GameGlobal.uiLayer);GameGlobal.uiLayer.touchEnabled=false;GameGlobal.uiLayer.touchThrough=true;GameGlobal.uiLayer.$hitTest=function(){return null};GameGlobal.popLayer=new eui.UILayer;GameGlobal.popLayer.name="popLayer";main.addChild(GameGlobal.popLayer);GameGlobal.popLayer.touchThrough=true;GameGlobal.popLayer.touchEnabled=false;GameGlobal.popLayer.touchChildren=true;lz.PopupManager.getInstance().init(GameGlobal.popLayer);GameGlobal.tipsLayer=new eui.UILayer;GameGlobal.tipsLayer.name="tipsLayer";main.addChild(GameGlobal.tipsLayer);GameGlobal.tipsLayer.touchEnabled=false;GameGlobal.tipsLayer.touchThrough=true;GameGlobal.guideLayer=new eui.UILayer;GameGlobal.guideLayer.name="guideLayer";main.addChild(GameGlobal.guideLayer);GameGlobal.guideLayer.touchThrough=true;GameGlobal.guideLayer.touchEnabled=false;GameGlobal.topLayer=new eui.UILayer;GameGlobal.topLayer.name="topLayer";main.addChild(GameGlobal.topLayer);GameGlobal.topLayer.touchThrough=true;GameGlobal.topLayer.touchEnabled=false;GameGlobal.toastLayer=new eui.UILayer;GameGlobal.toastLayer.name="toastLayer";main.addChild(GameGlobal.toastLayer);GameGlobal.toastLayer.touchThrough=true;GameGlobal.toastLayer.touchEnabled=false;GameGlobal.guideLayer1=new eui.Group;GameGlobal.guideLayer1.name="guideLayer1";GameGlobal.guideLayer.addChild(GameGlobal.guideLayer1);GameGlobal.guideLayer1.touchEnabled=false;GameGlobal.guideLayer2=new eui.Group;GameGlobal.guideLayer2.name="guideLayer2";GameGlobal.guideLayer.addChild(GameGlobal.guideLayer2);GameGlobal.guideLayer2.touchEnabled=false;GameGlobal.guideLayer2.touchThrough=true;GameGlobal.guideLayer3=new eui.Group;GameGlobal.guideLayer3.name="guideLayer3";GameGlobal.guideLayer.addChild(GameGlobal.guideLayer3);GameGlobal.loadingLayer=new eui.UILayer;GameGlobal.loadingLayer.name="loadingLayer";GameGlobal.loadingLayer.touchEnabled=GameGlobal.loadingLayer.touchChildren=false;main.addChild(GameGlobal.loadingLayer);GameGlobal.loadingLayer.touchThrough=true;lz.UpdateManager.init();lz.UpdateManager.start();GameGlobal.isComplete=true};GameGlobal.delGuide=function(){GameGlobal.guideLayer.visible=false;GameGlobal.guideLayer3.removeChildren();GameGlobal.guideLayer1.removeChildren();GameGlobal.guideLayer.removeChildren()};GameGlobal.lock=function(){if(!GameGlobal.lockLayer){GameGlobal.lockLayer=new eui.UILayer;GameGlobal.lockLayer.name="_lockLayer";GameGlobal.lockLayer.width=GameGlobal.screenWidth;GameGlobal.loadingLayer.height=GameGlobal.screenHeight;GameGlobal.lockLayer.touchEnabled=true;GameGlobal.baseLayer.addChild(GameGlobal.lockLayer)}GameGlobal.isLock=true;GameGlobal.lockLayer.visible=true};GameGlobal.unLock=function(){GameGlobal.isLock=false;if(GameGlobal.lockLayer)GameGlobal.lockLayer.visible=false};GameGlobal.fontFamily="Microsoft YaHei";GameGlobal.isPauseGame=false;GameGlobal.skipGuide=false;GameGlobal.isGuide=false;GameGlobal.screenWidth=1280;GameGlobal.screenHeight=720;GameGlobal.isInPad=false;GameGlobal.isComplete=false;GameGlobal.isFullScreen=false;GameGlobal.isInVoice=false;GameGlobal.microphoneState=0;GameGlobal.speakerState=0;GameGlobal.offsetX=0;GameGlobal.offsetY=0;GameGlobal.isLock=false;return GameGlobal}();lz.GameGlobal=GameGlobal;__reflect(GameGlobal.prototype,"lz.GameGlobal")})(lz||(lz={}));var lz;(function(lz){var PoolGlobal=function(){function PoolGlobal(){this.bitmapPool=new lz.ObjPool;this.uiLabelPool=new lz.ObjPool;this.renderTexturePool=new lz.ObjPool;this.msgPool=new lz.ObjPool}PoolGlobal.getInstance=function(){if(PoolGlobal.instance==null){PoolGlobal.instance=new PoolGlobal}return PoolGlobal.instance};return PoolGlobal}();lz.PoolGlobal=PoolGlobal;__reflect(PoolGlobal.prototype,"lz.PoolGlobal")})(lz||(lz={}));var lz;(function(lz){var LoaderItem=function(){function LoaderItem(url,callFunction,thisObject,isCache){this.isCache=false;this.url=url;this.callFunction=callFunction;this.thisObject=thisObject;this.isCache=isCache}return LoaderItem}();lz.LoaderItem=LoaderItem;__reflect(LoaderItem.prototype,"lz.LoaderItem")})(lz||(lz={}));var lz;(function(lz){var LoadImage=function(_super){__extends(LoadImage,_super);function LoadImage(){var _this=_super.call(this)||this;_this._list=[];_this._isLoad=false;_this._cacheDic={};_this._errorTimes=0;_this._imageLoad=new egret.ImageLoader;_this._imageLoad.crossOrigin="anonymous";_this._imageLoad.addEventListener(egret.Event.COMPLETE,_this.onLoadComplete,_this);_this._imageLoad.addEventListener(egret.IOErrorEvent.IO_ERROR,_this.onLoadError,_this);return _this}LoadImage.getInstance=function(){if(LoadImage.instance==null){LoadImage.instance=new LoadImage}return LoadImage.instance};LoadImage.prototype.load=function(url,callFunction,thisObject,isCache){if(callFunction===void 0){callFunction=null}if(isCache===void 0){isCache=false}if(typeof url=="string"){if(this._cacheDic[url]&&callFunction){callFunction.call(thisObject,this._cacheDic[url]);return}var item=new lz.LoaderItem(url,callFunction,thisObject,isCache);this.loadItem(item)}else{for(var i=0;i<url.length;i++){var lItem=new lz.LoaderItem(url[0],null,null,isCache);if(i==url.length-1){lItem.callFunction=callFunction;lItem.thisObject=thisObject}this.loadItem(lItem)}}};LoadImage.prototype.loadItem=function(item){if(this._isLoad){this._list.push(item)}else{this._errorTimes=0;this._isLoad=true;this._currentItem=item;this._imageLoad.load(item.url)}};LoadImage.prototype.onLoadComplete=function(event){if(this._currentItem){var texture=new egret.Texture;texture.bitmapData=event.currentTarget.data;if(this._currentItem.callFunction){this._currentItem.callFunction.call(this._currentItem.thisObject,texture)}if(this._currentItem.isCache){this._cacheDic[this._currentItem.url]=texture}}this.checkLoad()};LoadImage.prototype.checkLoad=function(){this._isLoad=false;if(this._list.length){var item=this._list.shift();this.loadItem(item)}};LoadImage.prototype.onLoadError=function(e){this._errorTimes++;lz.Log.out(this,"onLoadError"+this._errorTimes);if(this._errorTimes<=3){this.loadItem(this._currentItem)}else{this.checkLoad()}};return LoadImage}(egret.EventDispatcher);lz.LoadImage=LoadImage;__reflect(LoadImage.prototype,"lz.LoadImage")})(lz||(lz={}));var lz;(function(lz){var LoadURL=function(_super){__extends(LoadURL,_super);function LoadURL(){var _this=_super.call(this)||this;_this._list=[];_this._isLoad=false;_this._errorTimes=0;_this._loader=new egret.URLLoader;_this._request=new egret.URLRequest;_this._loader.dataFormat=egret.URLLoaderDataFormat.TEXTURE;_this._loader.addEventListener(egret.Event.COMPLETE,_this.onLoadComplete,_this);_this._loader.addEventListener(egret.IOErrorEvent.IO_ERROR,_this.onLoadError,_this);return _this}LoadURL.getInstance=function(){if(LoadURL.instance==null){LoadURL.instance=new LoadURL}return LoadURL.instance};LoadURL.prototype.load=function(url,callFunction,thisObject){if(callFunction===void 0){callFunction=null}if(typeof url=="string"){var item=new lz.LoaderItem(url,callFunction,thisObject,false);this.loadItem(item)}else{for(var i=0;i<url.length;i++){var lItem=new lz.LoaderItem(url[0],null,null,false);if(i==url.length-1){lItem.callFunction=callFunction;lItem.thisObject=thisObject}this.loadItem(lItem)}}};LoadURL.prototype.loadItem=function(item){if(this._isLoad){this._list.push(item)}else{this._errorTimes=0;this._isLoad=true;this._currentItem=item;this._request.url=item.url;this._loader.load(this._request)}};LoadURL.prototype.onLoadComplete=function(event){if(this._currentItem){var texture=this._loader.data;if(this._currentItem.callFunction){this._currentItem.callFunction.call(this._currentItem.thisObject,texture)}}this.checkLoad()};LoadURL.prototype.checkLoad=function(){this._isLoad=false;if(this._list.length){var item=this._list.shift();this.loadItem(item)}};LoadURL.prototype.onLoadError=function(e){this._errorTimes++;lz.Log.out(this,"onLoadError"+this._errorTimes);if(this._errorTimes<=3){this.loadItem(this._currentItem)}else{this.checkLoad()}};return LoadURL}(egret.EventDispatcher);lz.LoadURL=LoadURL;__reflect(LoadURL.prototype,"lz.LoadURL")})(lz||(lz={}));var lz;(function(lz){var Log=function(){function Log(){}Log.out=function(object){var arg=[];for(var _i=1;_i<arguments.length;_i++){arg[_i-1]=arguments[_i]}if(true||lz.GameConfig.debug){console.log("["+egret.getQualifiedClassName(object)+"] "+arg)}};return Log}();lz.Log=Log;__reflect(Log.prototype,"lz.Log")})(lz||(lz={}));var lz;(function(lz){var BridgeManager=function(){function BridgeManager(){this.init()}BridgeManager.getInstance=function(){if(BridgeManager.instance==null){BridgeManager.instance=new BridgeManager}return BridgeManager.instance};BridgeManager.prototype.init=function(){egret.ExternalInterface.addCallback(lz.BridgeConfig.NATIVE_CALL_EGRET,function(message){console.log("Native-callback---"+message);var o=JSON.parse(message);if(o){lz.GameDispatcher.getInstance().dispatchEventWith(o.name,false,o);lz.Facade.sendNotification(lz.GameFrameEvent.NATIVE_CALLBACK,0)}})};BridgeManager.prototype.callNative=function(name,id){var params=[];for(var _i=2;_i<arguments.length;_i++){params[_i-2]=arguments[_i]}var o={};o["name"]=name;o["id"]=id;for(var i=0;i<Math.floor(params.length/2);i++){o[params[i*2]]=params[i*2+1]}o["json"]=1;var str=JSON.stringify(o);lz.Log.out(this,"调用原生----"+str);egret.ExternalInterface.call(lz.BridgeConfig.EGRET_CALL_NATIVE,str)};return BridgeManager}();lz.BridgeManager=BridgeManager;__reflect(BridgeManager.prototype,"lz.BridgeManager")})(lz||(lz={}));var lz;(function(lz){var LocalDataManager=function(){function LocalDataManager(){}LocalDataManager.setValue=function(key,data){try{var ld=LocalDataManager.getData();if(!ld){ld={}}ld[key]=data;var str=JSON.stringify(ld);egret.localStorage.setItem(this.key,str)}catch(error){}};LocalDataManager.getValue=function(key){try{var data=LocalDataManager.getData();return data[key]}catch(error){}return null};LocalDataManager.getData=function(){try{var str=egret.localStorage.getItem(LocalDataManager.key);var data=JSON.parse(str);return data}catch(error){}return null};Object.defineProperty(LocalDataManager,"key",{get:function(){if(!this._key){this._key=lz.GameConfig.gameName}return this._key},enumerable:true,configurable:true});return LocalDataManager}();lz.LocalDataManager=LocalDataManager;__reflect(LocalDataManager.prototype,"lz.LocalDataManager")})(lz||(lz={}));var lz;(function(lz){var WindowPostion;(function(WindowPostion){WindowPostion[WindowPostion["Center"]=0]="Center";WindowPostion[WindowPostion["TopCenter"]=1]="TopCenter";WindowPostion[WindowPostion["BottomCenter"]=2]="BottomCenter"})(WindowPostion=lz.WindowPostion||(lz.WindowPostion={}));var PopupLayer=function(_super){__extends(PopupLayer,_super);function PopupLayer(){var _this=_super.call(this)||this;_this._rect=new eui.Rect;_this._rect.width=lz.GameGlobal.baseLayer.stage.stageWidth;_this._rect.height=lz.GameGlobal.baseLayer.stage.stageHeight;_this._rect.fillColor=0;_this._rect.fillAlpha=.65;_this.addChild(_this._rect);_this.touchEnabled=false;_this.visible=false;return _this}PopupLayer.prototype.close=function(){this.touchEnabled=false;this._rect.visible=false;this.visible=false;this.touchThrough=true};PopupLayer.prototype.open=function(value){if(value===void 0){value=true}this.touchEnabled=value;this._rect.visible=value;this._rect.width=lz.GameGlobal.baseLayer.stage.stageWidth;this._rect.height=lz.GameGlobal.baseLayer.stage.stageHeight;this.visible=true;this.touchThrough=!value};PopupLayer.prototype.clear=function(){for(var i=this.numChildren-1;i>=0;i--){if(this.getChildAt(i)!=this._rect){this.removeChildAt(i)}else{break}}while(this.numChildren>0&&this.getChildAt(0)!=this._rect){this.removeChildAt(0)}};return PopupLayer}(eui.UILayer);lz.PopupLayer=PopupLayer;__reflect(PopupLayer.prototype,"lz.PopupLayer");var PopupManager=function(_super){__extends(PopupManager,_super);function PopupManager(){return _super.call(this)||this}PopupManager.prototype.clear=function(){this._popLayer1.clear();this._popLayer1.close();this._popLayer2.clear();this._popLayer2.close();this._popLayer3.clear();this._popLayer3.close();this._alertLayer.clear();this._alertLayer.close()};PopupManager.getInstance=function(){if(PopupManager._instance==null)PopupManager._instance=new PopupManager;return PopupManager._instance};PopupManager.prototype.init=function(baseLayer){this._popLayer1=new PopupLayer;this._popLayer1.name="pop1";baseLayer.addChild(this._popLayer1);this._popLayer1.close();this._popLayer2=new PopupLayer;this._popLayer2.name="pop2";baseLayer.addChild(this._popLayer2);this._popLayer2.close();this._popLayer3=new PopupLayer;this._popLayer3.name="pop3";baseLayer.addChild(this._popLayer3);this._popLayer3.close();this._alertLayer=new PopupLayer;this._alertLayer.name="alert";baseLayer.addChild(this._alertLayer);this._alertLayer.close()};PopupManager.addPop=function(display,modal){if(modal===void 0){modal=true}PopupManager.getInstance()._popLayer1.addChild(display);PopupManager.getInstance()._popLayer1.open(modal)};PopupManager.delAllPop=function(){PopupManager.getInstance().clear()};PopupManager.delPop=function(display,zoom){if(zoom===void 0){zoom=true}PopupManager.getInstance()._popLayer1.clear();PopupManager.getInstance()._popLayer1.close()};PopupManager.addPop2=function(display,modal){if(modal===void 0){modal=true}PopupManager.getInstance()._popLayer2.addChild(display);PopupManager.getInstance()._popLayer2.open(modal)};PopupManager.delPop2=function(display,zoom){if(zoom===void 0){zoom=true}PopupManager.getInstance()._popLayer2.clear();PopupManager.getInstance()._popLayer2.close()};PopupManager.addPop3=function(display,modal){if(modal===void 0){modal=true}PopupManager.getInstance()._popLayer3.addChild(display);PopupManager.getInstance()._popLayer3.open(modal)};PopupManager.delPop3=function(display,zoom){if(zoom===void 0){zoom=true}PopupManager.getInstance()._popLayer3.clear();PopupManager.getInstance()._popLayer3.close()};PopupManager.onZoom=function(display,zoomed){if(zoomed){display.horizontalCenter=0;display.verticalCenter=0;display.scaleX=0;display.scaleY=0}};PopupManager.addAlert=function(display,zoomed){if(zoomed===void 0){zoomed=false}this.onZoom(display,zoomed);PopupManager.getInstance()._alertLayer.clear();PopupManager.getInstance()._alertLayer.addChild(display);PopupManager.getInstance()._alertLayer.open()};PopupManager.delAlert=function(display,zoom){if(zoom===void 0){zoom=true}if(display&&display.parent){PopupManager.getInstance()._alertLayer.removeChild(display);PopupManager.getInstance()._alertLayer.close()}};PopupManager.hasAlert=function(clsName){if(PopupManager.getInstance()._alertLayer.numChildren>0){for(var i=0;i<PopupManager.getInstance()._alertLayer.numChildren;i++){if(egret.is(PopupManager.getInstance()._alertLayer.getChildAt(i),clsName)){return true}}}return false};PopupManager.hasPop1=function(clsName){if(PopupManager.getInstance()._popLayer1.numChildren>0){for(var i=0;i<PopupManager.getInstance()._popLayer1.numChildren;i++){if(egret.is(PopupManager.getInstance()._popLayer1.getChildAt(i),clsName)){return true}}}return false};PopupManager.prototype.center=function(display){display.x=(lz.GameGlobal.screenWidth-display.width)/2;display.y=(lz.GameGlobal.screenHeight-display.height)/2};PopupManager.prototype.bottomcenter=function(display){display.x=(lz.GameGlobal.screenWidth-display.width)/2;display.y=lz.GameGlobal.screenHeight-display.height};return PopupManager}(egret.EventDispatcher);lz.PopupManager=PopupManager;__reflect(PopupManager.prototype,"lz.PopupManager")})(lz||(lz={}));var lz;(function(lz){var SoundManager=function(){function SoundManager(){}Object.defineProperty(SoundManager,"soundSwitch",{get:function(){return this._soundSwitch},set:function(s){this._soundSwitch=s;lz.LocalDataManager.setValue(lz.BaseSettingGlobal.SOUND,s?lz.BaseSettingGlobal.SETTING_ON:lz.BaseSettingGlobal.SETTING_OFF);if(s)this.playBackgroundMusic();else this.pauseBackgroundMusic()},enumerable:true,configurable:true});Object.defineProperty(SoundManager,"musicSwitch",{get:function(){return this._musicSwitch},set:function(m){this._musicSwitch=m;lz.LocalDataManager.setValue(lz.BaseSettingGlobal.MUSIC,m?lz.BaseSettingGlobal.SETTING_ON:lz.BaseSettingGlobal.SETTING_OFF)},enumerable:true,configurable:true});SoundManager.init=function(){this.callBackDic={};this._soundEffectDic={};var str=lz.LocalDataManager.getValue(lz.BaseSettingGlobal.SOUND);if(!str||str.length<1){lz.LocalDataManager.setValue(lz.BaseSettingGlobal.SOUND,lz.BaseSettingGlobal.SETTING_ON)}if(lz.LocalDataManager.getValue(lz.BaseSettingGlobal.SOUND)==lz.BaseSettingGlobal.SETTING_ON)SoundManager._soundSwitch=true;else SoundManager._soundSwitch=false;var str2=lz.LocalDataManager.getValue(lz.BaseSettingGlobal.MUSIC);if(!str2||str2.length<1){lz.LocalDataManager.setValue(lz.BaseSettingGlobal.MUSIC,lz.BaseSettingGlobal.SETTING_ON)}if(lz.LocalDataManager.getValue(lz.BaseSettingGlobal.MUSIC)==lz.BaseSettingGlobal.SETTING_ON)SoundManager._musicSwitch=true;else SoundManager._musicSwitch=false};SoundManager.onActive=function(){if(SoundManager.soundSwitch){SoundManager.playBackgroundMusic()}};SoundManager.onDeActive=function(){this.pauseBackgroundMusic()};SoundManager.insertBackground=function(sound,isContinue){if(isContinue===void 0){isContinue=true}return __awaiter(this,void 0,void 0,function(){var ns,musicFlag;return __generator(this,function(_a){switch(_a.label){case 0:return[4,RES.getResAsync(sound)];case 1:ns=_a.sent();if(ns!=null){this.pauseBackgroundMusic();SoundManager.bgMusic=ns;SoundManager.bgMusicChannel=SoundManager.bgMusic.play(0,1);if(isContinue){SoundManager.bgMusicChannel.once(egret.Event.SOUND_COMPLETE,SoundManager.insertComplete,SoundManager)}musicFlag=lz.LocalDataManager.getValue(lz.BaseSettingGlobal.VOLUME);SoundManager.bgMusicChannel.volume=+musicFlag}return[2]}})})};SoundManager.insertComplete=function(event){SoundManager.setBackground(SoundManager.bgMusicUrl)};SoundManager.setBackground=function(sound,force){if(force===void 0){force=false}return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){switch(_a.label){case 0:if(!(SoundManager.bgMusicUrl!=sound||force==true))return[3,2];SoundManager.bgMusicUrl=sound;SoundManager.onStage(null);return[4,SoundManager.playBackgroundMusic()];case 1:_a.sent();_a.label=2;case 2:return[2]}})})};SoundManager.onStage=function(event){var str=lz.LocalDataManager.getValue(lz.BaseSettingGlobal.VOLUME);if(!str||str.length<1){lz.LocalDataManager.setValue(lz.BaseSettingGlobal.VOLUME,lz.BaseSettingGlobal.SETTING_ON)}};SoundManager.pauseBackgroundMusic=function(){if(SoundManager.bgMusicChannel!=null){SoundManager.bgMusicChannel.stop();SoundManager.bgMusicChannel=null}};SoundManager.playBackgroundMusic=function(){return __awaiter(this,void 0,void 0,function(){var _a,musicFlag;return __generator(this,function(_b){switch(_b.label){case 0:if(!SoundManager.soundSwitch||!SoundManager.bgMusicUrl){return[2]}this.pauseBackgroundMusic();_a=SoundManager;return[4,RES.getResAsync(SoundManager.bgMusicUrl)];case 1:_a.bgMusic=_b.sent();if(SoundManager.bgMusic){SoundManager.bgMusicChannel=SoundManager.bgMusic.play();musicFlag=lz.LocalDataManager.getValue(lz.BaseSettingGlobal.VOLUME);SoundManager.bgMusicChannel.volume=1}return[2]}})})};SoundManager.playSingleSound=function(value){if(this._musicSwitch==true){if(this._singleSoundUrl!=value){this._singleSoundUrl=value;this._singleSound=RES.getRes(value);if(this._singleSound){this._singleSoundCannel=this._singleSound.play(0,1)}else{console.log("error- no found "+value)}}return this._singleSoundCannel}};SoundManager.disposeSingleSound=function(){if(this._singleSound){this._singleSound.close();this._singleSound=null}if(this._singleSoundCannel){this._singleSoundCannel.stop();this._singleSoundCannel=null}};SoundManager.playSound=function(value,callBack,thisObject,param){if(callBack===void 0){callBack=null}if(thisObject===void 0){thisObject=null}if(param===void 0){param=null}if(this._musicSwitch==true){var channel=void 0;var sound=RES.getRes(value);if(sound!=null){if(this._soundEffectTimes<this.soundEffectMax){var times=+this._soundEffectDic[value];if(!times){times=0}if(times>=this.soundEffectSingleMax){return null}times++;this._soundEffectDic[value]=times;channel=sound.play(0,1);this.callBackDic[channel.hashCode]={c:callBack,t:thisObject,p:param,k:value};channel.addEventListener(egret.Event.SOUND_COMPLETE,this.effectPlayEnd,this)}}else{RES.createGroup(value+"mp3",[value],true);RES.loadGroup(value+"mp3")}return channel}};SoundManager.effectPlayEnd=function(e){var channel=e.target;channel.removeEventListener(egret.Event.SOUND_COMPLETE,this.effectPlayEnd,this);if(channel){var obj=this.callBackDic[channel.hashCode];if(obj){var callBack=obj.c;var thisObject=obj.t;var key=obj.k;if(callBack&&thisObject){callBack.call(thisObject,obj.p);delete this.callBackDic[channel.hashCode]}var times=+this._soundEffectDic[key];if(times&&times>0){times--}else{times=0}this._soundEffectDic[key]=times}channel.stop();channel=null}};SoundManager.bgSoundValue="";SoundManager._soundEffectDic={};SoundManager._soundEffectTimes=0;SoundManager._isbgMusicPlay=false;SoundManager.soundEffectMax=20;SoundManager.soundEffectSingleMax=2;return SoundManager}();lz.SoundManager=SoundManager;__reflect(SoundManager.prototype,"lz.SoundManager")})(lz||(lz={}));var lz;(function(lz){var TimerVo=function(){function TimerVo(){}return TimerVo}();lz.TimerVo=TimerVo;__reflect(TimerVo.prototype,"lz.TimerVo");var TimerManager=function(){function TimerManager(){this._count=0;this._key=0;this._delay=1e3;this._timerDic={}}TimerManager.getInstance=function(){if(this._instance==null){this._instance=new TimerManager}return this._instance};TimerManager.prototype.registerTimer=function(callBack,thisObject,delay,repeatCount,isAtOnce){if(delay===void 0){delay=1e3}if(repeatCount===void 0){repeatCount=0}if(isAtOnce===void 0){isAtOnce=true}if(delay<20){delay=20}++this._count;this._delay=this._delay>delay?delay:this._delay;var vo=new TimerVo;vo.callBack=callBack;vo.thisObject=thisObject;vo.delay=delay;vo.key=++this._key;vo.repeatCount=repeatCount;if(isAtOnce){callBack.call(thisObject)}vo.lastTime=egret.getTimer();this._timerDic[vo.key]=vo;this.startTimer();return vo.key};TimerManager.prototype.removeTimer=function(key){if(this._timerDic[key]){--this._count;delete this._timerDic[key]}if(this._count<1){this.stopTimer()}};TimerManager.prototype.startTimer=function(){if(!this._timer){this._timer=new egret.Timer(this._delay);this._timer.addEventListener(egret.TimerEvent.TIMER,this.onTimerHandler,this)}if(this._timer.delay!=this._delay){this._timer.delay=this._delay}if(!this._timer.running){this._timer.start()}};TimerManager.prototype.stopTimer=function(){if(this._timer){this._timer.stop();this._count=0}};TimerManager.prototype.onTimerHandler=function(e){if(e===void 0){e=null}for(var key in this._timerDic){var vo=this._timerDic[key];var t=egret.getTimer();if(vo){if(t-vo.lastTime>=vo.delay){vo.callBack.call(vo.thisObject);vo.lastTime=t;if(vo.repeatCount>0){--vo.repeatCount;if(vo.repeatCount==0){this.removeTimer(vo.key)}}}}}};TimerManager._instance=null;return TimerManager}();lz.TimerManager=TimerManager;__reflect(TimerManager.prototype,"lz.TimerManager")})(lz||(lz={}));var lz;(function(lz){var ToggleGroupManager=function(_super){__extends(ToggleGroupManager,_super);function ToggleGroupManager(list,isSwap){if(isSwap===void 0){isSwap=false}var _this=_super.call(this)||this;_this._groupList=[];_this._isSwap=isSwap;_this.setList(list);return _this}ToggleGroupManager.prototype.changeHandler=function(e){var toggleButton=e.target;var index=this.selectedIndexA;if(toggleButton){if(toggleButton.currentState=="up"){if(this.selectedItem){this.selectedItem.currentState="up";if(this._isSwap){toggleButton.parent.swapChildren(toggleButton,this.selectedItem)}}this.selectedItem=toggleButton;toggleButton.currentState="down"}if(index!=this.selectedIndexA){var eve=new egret.Event(egret.Event.CHANGE);this.dispatchEvent(eve)}else{this.dispatchEvent(e)}}};ToggleGroupManager.prototype.setList=function(list){for(var key in list){this.addItem(list[key])}};ToggleGroupManager.prototype.addItem=function(item){if(egret.is(item,"eui.Button")){item.addEventListener(egret.TouchEvent.TOUCH_TAP,this.changeHandler,this)}this._groupList.push(item)};ToggleGroupManager.prototype.removeAll=function(){this.selectedItem=null;var eve=new egret.Event(egret.Event.CHANGE);this.dispatchEvent(eve)};Object.defineProperty(ToggleGroupManager.prototype,"selectedIndexA",{get:function(){return this.groupList.indexOf(this.selectedItem)},set:function(value){if(value==-1){var sItem=this.selectedItem;this.selectedItem=null;if(sItem){sItem.currentState="up"}return}if(this.selectedItem){this.selectedItem.currentState="up"}var item=this.groupList[value];if(item){item.currentState="down";this.selectedItem=item}var eve=new egret.Event(egret.Event.CHANGE);this.dispatchEvent(eve)},enumerable:true,configurable:true});Object.defineProperty(ToggleGroupManager.prototype,"groupList",{get:function(){return this._groupList},enumerable:true,configurable:true});Object.defineProperty(ToggleGroupManager.prototype,"length",{get:function(){return this._groupList.length},enumerable:true,configurable:true});return ToggleGroupManager}(egret.EventDispatcher);lz.ToggleGroupManager=ToggleGroupManager;__reflect(ToggleGroupManager.prototype,"lz.ToggleGroupManager")})(lz||(lz={}));var lz;(function(lz){var UpdateManager=function(){function UpdateManager(){}UpdateManager.start=function(){this._started=true};UpdateManager.stop=function(){this._started=false};UpdateManager.init=function(){this._lastDelta=egret.getTimer();egret.startTick(this.update,this)};UpdateManager.update=function(timeStamp){var delta=timeStamp-this._lastDelta;this._lastDelta=timeStamp;if(this._started){for(var i=this._dicupdateable.length-1;i>=0;i--){if(this._dicupdateable[i].deleted){this._dicupdateable.splice(i,1)}else{this._dicupdateable[i].update(delta)}}}return false};UpdateManager.addUpdateable=function(up){var index=this._dicupdateable.indexOf(up);up.deleted=false;if(index==-1){this._dicupdateable.push(up)}};UpdateManager.delUpdateable=function(up){var index=this._dicupdateable.indexOf(up);if(index>-1){this._dicupdateable[index].deleted=true}};UpdateManager._dicupdateable=[];UpdateManager._started=false;return UpdateManager}();lz.UpdateManager=UpdateManager;__reflect(UpdateManager.prototype,"lz.UpdateManager")})(lz||(lz={}));var lz;(function(lz){var XMLManager=function(){function XMLManager(){this._dicData={}}XMLManager.getInstance=function(){if(XMLManager._instance==null)XMLManager._instance=new XMLManager;return XMLManager._instance};XMLManager.prototype.getDataByName=function(baseName){return this._dicData[baseName]};XMLManager.prototype.readJsZipJson=function(data,type){if(type===void 0){type=1}try{var config=void 0;if(type==1){this.jsZip=new JSZip(data);config=JSON.parse(this._jsZip.file("all.json").asText())}else{config=data}for(var key in config){var cls=egret.getDefinitionByName(key+"Vo");if(!cls){lz.Log.out(this,"parse error "+key+"Vo is undefind");continue}var infoAry=config[key];var infoData={};var vo=null;for(var i=0;i<infoAry.length;++i){vo=new cls(infoAry[i]);infoData[vo.ID]=vo}this._dicData[key]=infoData}}catch(e){lz.Log.out(this,"parse error "+e)}};Object.defineProperty(XMLManager.prototype,"jsZip",{get:function(){return this._jsZip},set:function(v){this._jsZip=v},enumerable:true,configurable:true});return XMLManager}();lz.XMLManager=XMLManager;__reflect(XMLManager.prototype,"lz.XMLManager")})(lz||(lz={}));var lz;(function(lz){var Facade=function(){function Facade(){}Facade.sendNotification=function(notificationName,obj,obj2){if(obj===void 0){obj=null}if(obj2===void 0){obj2=null}var arr=Facade._dicmediator[notificationName];if(arr!=null){for(var i=0;i<arr.length;i++){arr[i].executeNotification(notificationName,obj,obj2)}}};Facade.registerNotifListeners=function(mediator){if(mediator.isRegister){return}mediator.isRegister=true;var notifications=mediator.notificationListeners();var length=notifications.length;for(var i=0;i<length;i++){var arr=Facade._dicmediator[notifications[i]];if(arr!=null){arr.push(mediator)}else{arr=new Array;arr.push(mediator);Facade._dicmediator[notifications[i]]=arr}}};Facade.removeNotifListeners=function(mediator){mediator.isRegister=false;var notifications=mediator.notificationListeners();var length=notifications.length;for(var i=0;i<length;i++){var all=Facade._dicmediator;var arr=Facade._dicmediator[notifications[i]];if(arr!=null){for(var j=arr.length-1;j>=0;j--){if(arr[j]==mediator){arr.splice(j,1)}}}}};Facade._dicmediator=new Array;return Facade}();lz.Facade=Facade;__reflect(Facade.prototype,"lz.Facade")})(lz||(lz={}));var lz;(function(lz){var GameDispatcher=function(_super){__extends(GameDispatcher,_super);function GameDispatcher(){return _super.call(this)||this}GameDispatcher.getInstance=function(){if(GameDispatcher.instance==null){GameDispatcher.instance=new GameDispatcher}return GameDispatcher.instance};return GameDispatcher}(egret.EventDispatcher);lz.GameDispatcher=GameDispatcher;__reflect(GameDispatcher.prototype,"lz.GameDispatcher")})(lz||(lz={}));var lz;(function(lz){var Mediator=function(){function Mediator(){}Mediator.prototype.notificationListeners=function(){return[]};Mediator.prototype.executeNotification=function(notificationName,obj){};return Mediator}();lz.Mediator=Mediator;__reflect(Mediator.prototype,"lz.Mediator",["lz.IMediator"])})(lz||(lz={}));var lz;(function(lz){var HttpRequest=function(){function HttpRequest(){}HttpRequest.getInstance=function(){if(HttpRequest.instance==null){HttpRequest.instance=new HttpRequest}return HttpRequest.instance};HttpRequest.prototype.post=function(api,params,httpUrl,times){if(httpUrl===void 0){httpUrl=null}if(times===void 0){times=0}return __awaiter(this,void 0,void 0,function(){var httpRequest,url,urlParam,promise;return __generator(this,function(_a){httpRequest=new egret.HttpRequest;httpRequest.timeout=HttpRequest.timeout;httpRequest.responseType=egret.HttpResponseType.TEXT;url=lz.GameConfig.httpURL+api;if(httpUrl){url=httpUrl+api}httpRequest.open(url,egret.HttpMethod.POST);if(this.token){params.token=this.token}params.pid=lz.PlatformUtil.pid();urlParam=JSON.stringify(params);promise=new Promise(function(resolve,reject){var _this=this;httpRequest.send(urlParam);httpRequest.once(egret.Event.COMPLETE,function(event){var responseStr=event.currentTarget.response;var resultData;if(responseStr&&responseStr.length){resultData=JSON.parse(event.currentTarget.response)}else{resultData.code=-1;resultData.msg="--- Protocol returns to null ---";lz.Log.out(_this,api," Protocol returns to null ")}if(resultData.code!=200&&false){lz.PlatformUtil.aldSendEvent("通信数据错误",{"协议号":api,msg:resultData.msg})}resolve(resultData)},this);httpRequest.once(egret.IOErrorEvent.IO_ERROR,function(event){var errorData={};errorData["code"]=-1;errorData["msg"]="--- IO_ERROR ---";if(false){lz.PlatformUtil.aldSendEvent("通信数据错误",{"协议号":api,msg:event})}reject(JSON.stringify(errorData))},this)});return[2,promise.then(function(result){return result}).catch(function(error){times++;if(times<3){return lz.HttpRequest.getInstance().post(api,params,null,times)}else{return error}})]})})};HttpRequest.prototype.get=function(api,httpUrl){if(httpUrl===void 0){httpUrl=null}return __awaiter(this,void 0,void 0,function(){var httpRequest,url,promise;return __generator(this,function(_a){httpRequest=new egret.HttpRequest;httpRequest.responseType=egret.HttpResponseType.TEXT;url=lz.GameConfig.httpURL+api;if(httpUrl){url=httpUrl+api}httpRequest.open(url,egret.HttpMethod.GET);httpRequest.setRequestHeader("Content-Type","text/plain;charset=utf-8");promise=new Promise(function(resolve,reject){var _this=this;httpRequest.send();httpRequest.addEventListener(egret.Event.COMPLETE,function(event){var responseStr=event.currentTarget.response;var resultData;if(responseStr&&responseStr.length){resultData=JSON.parse(event.currentTarget.response)}else{resultData.code=-1;resultData.msg="--- Protocol returns to null ---";lz.Log.out(_this,api," Protocol returns to null ")}resolve(resultData)},this);httpRequest.addEventListener(egret.IOErrorEvent.IO_ERROR,function(event){reject(event)},this)});return[2,promise.then(function(result){return result}).catch(function(error){return error})]})})};HttpRequest.timeout=1e4;return HttpRequest}();lz.HttpRequest=HttpRequest;__reflect(HttpRequest.prototype,"lz.HttpRequest")})(lz||(lz={}));var lz;(function(lz){var NET_STATE;(function(NET_STATE){NET_STATE[NET_STATE["NULL"]=0]="NULL";NET_STATE[NET_STATE["CONNECTING"]=1]="CONNECTING";NET_STATE[NET_STATE["CONNECTED"]=2]="CONNECTED";NET_STATE[NET_STATE["DISCONNECT"]=3]="DISCONNECT";NET_STATE[NET_STATE["ERROR"]=4]="ERROR"})(NET_STATE=lz.NET_STATE||(lz.NET_STATE={}));var SocketEvent=function(){function SocketEvent(){}SocketEvent.SOCKET_STATE_CHANGE="SocketEvent_State_Change";return SocketEvent}();lz.SocketEvent=SocketEvent;__reflect(SocketEvent.prototype,"lz.SocketEvent");var Socket=function(){function Socket(){this._netState=NET_STATE.NULL;this._key="C3C7975FAA7C1885570D4D8C7441E5F8";this._i=1;this._isNeedMd5=false}Socket.getInstance=function(){if(Socket.instance==null){Socket.instance=new Socket}return Socket.instance};Socket.prototype.init=function(url,port,msgTemplate){if(port===void 0){port=0}if(msgTemplate===void 0){msgTemplate={}}return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){this._url=url;this._port=port;this._msgTemplate=msgTemplate;this.netState=NET_STATE.NULL;this.socket=new egret.WebSocket;this.socket.type=egret.WebSocket.TYPE_STRING;this.socket.addEventListener(egret.ProgressEvent.SOCKET_DATA,this.onReceiveMessage,this);this.socket.addEventListener(egret.Event.CLOSE,this.onSocketClose,this);this.socket.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onSocketError,this);return[2]})})};Socket.prototype.connect=function(){return __awaiter(this,void 0,void 0,function(){var socket,self,promise;return __generator(this,function(_a){this.netState=NET_STATE.CONNECTING;socket=this.socket;self=this;promise=new Promise(function(resolve,reject){var _this=this;if(self._port!=0){socket.connect(self._url,self._port)}else{socket.connectByUrl(self._url)}socket.addEventListener(egret.Event.CONNECT,function(event){lz.Log.out(_this,"socket connect success",event);self.netState=NET_STATE.CONNECTED;resolve(event)},this);socket.addEventListener(egret.IOErrorEvent.IO_ERROR,function(event){lz.Log.out(_this,"socket connect failue",event);self.netState=NET_STATE.DISCONNECT;reject(event)},this)});return[2,promise.then(function(result){return true}).catch(function(error){lz.Log.out(this,error);return false})]})})};Socket.prototype.onSocketClose=function(event){lz.Wait.hide("SOCKET_CLOSE");lz.Log.out(this,"------socket已经关闭：",event);this.netState=NET_STATE.DISCONNECT};Socket.prototype.onSocketError=function(event){lz.Wait.hide("SOCKET_ERROR");lz.Log.out(this,"------socket报IO错误：",event);this.netState=NET_STATE.ERROR};Socket.prototype.onReceiveMessage=function(event){var msg=this.socket.readUTF();var data=JSON.parse(msg);lz.Wait.hide("SOCKET_DATA="+data.msgid);if(lz.GameConfig.debug){console.log("socket收到数据，id="+data.msgid,data)}var errorMsg=data["msg"];if(data["code"]!=0&&errorMsg&&errorMsg.length>0){lz.MessageBox.show(errorMsg)}lz.GameDispatcher.getInstance().dispatchEventWith(data["msgid"],false,data)};Socket.prototype.send=function(msgid,data,isLock){if(isLock===void 0){isLock=true}return __awaiter(this,void 0,void 0,function(){var msg,json;return __generator(this,function(_a){if(isLock){lz.Wait.show("SOCKET_SEND="+msgid)}if(this.socket.connected==false){if(this.netState==NET_STATE.DISCONNECT){}}if(this.socket.connected==false){return[2,false]}if(this._msgTemplate){msg=this._msgTemplate}msg["msgid"]=msgid;msg["data"]=data;msg["index"]=this.autoI;json=JSON.stringify(msg);if(lz.GameConfig.debug){console.log("socket发送数据，id="+msgid,data)}if(this.isNeedMd5){json=this._md5.hex_md5(json+this._key)+"|"+json}this.socket.writeUTF(JSON.stringify(msg));this.socket.flush();return[2,true]})})};Socket.prototype.close=function(){console.log("关闭");this.socket.close()};Object.defineProperty(Socket.prototype,"autoI",{get:function(){return this._i++},enumerable:true,configurable:true});Object.defineProperty(Socket.prototype,"netState",{get:function(){return this._netState},set:function(v){if(this._netState!=v){this._netState=v;lz.GameDispatcher.getInstance().dispatchEventWith(SocketEvent.SOCKET_STATE_CHANGE)}},enumerable:true,configurable:true});Object.defineProperty(Socket.prototype,"isNeedMd5",{get:function(){return this._isNeedMd5},set:function(v){this._isNeedMd5=v},enumerable:true,configurable:true});return Socket}();lz.Socket=Socket;__reflect(Socket.prototype,"lz.Socket")})(lz||(lz={}));var lz;(function(lz){var HttpGlobal=function(){function HttpGlobal(){}HttpGlobal.makeRequestObject=function(action,params){var o=new Object;o["action"]=action;for(var i=0;i<Math.floor(params.length/2);i++){o[params[i*2]]=params[i*2+1]}return o};HttpGlobal.makeRequest=function(action,isPost,success,fail){if(success===void 0){success=null}if(fail===void 0){fail=null}var params=[];for(var _i=4;_i<arguments.length;_i++){params[_i-4]=arguments[_i]}if(isPost){var o=this.makeRequestObject(action,params);if(o){lz.HttpManager.getInstance().request(action,isPost,o,success,fail)}}else{lz.HttpManager.getInstance().request(action,isPost,null,success,fail)}};HttpGlobal.COMMAND_TIMEGOLD="user/timegold";HttpGlobal.COMMAND_GAMEGOLD="user/gamegold";HttpGlobal.COMMAND_GETGOLD="user/getgold";HttpGlobal.COMMAND_GAMEDATA="user/gamedata";HttpGlobal.COMMAND_GOLDSTATE="user/goldstate";HttpGlobal.COMMAND_MOREGAME="platform/recommendgame";HttpGlobal.COMMAND_WXLOGIN="login/wxminilogin";HttpGlobal.COMMAND_WXMINIGAME_LOGIN="login/minigamelogin";HttpGlobal.COMMAND_MINIGAME_GETGOLD="user/minigetgold";HttpGlobal.COMMAND_MINIGAME_GAMEGOLD="user/minigamegold";HttpGlobal.COMMAND_CONTEND_GETGAMEDATA="contend/game/getGameData";HttpGlobal.COMMAND_CONTEND_GETPLAYLIST="contend/game/getPayList";HttpGlobal.COMMAND_CONTEND_GETGAMEITEM="contend/game/getGameItem";HttpGlobal.COMMAND_CONTEND_GETRANKLIST="contend/user/getUserRankData";HttpGlobal.COMMAND_CONTEND_PAYITEM="contend/user/payItem";HttpGlobal.COMMAND_CONTEND_PAYANDUSE="contend/user/payUseItem";HttpGlobal.COMMAND_CONTEND_USEITEM="contend/user/useItem";HttpGlobal.COMMAND_CONTEND_UPDATEGAMEDATA="contend/user/updateGameData";HttpGlobal.COMMAND_CONTEND_UPDAYEANDRESULT="contend/user/synchGameData";HttpGlobal.COMMAND_CONTEND_PAY="contend/user/pay";return HttpGlobal}();lz.HttpGlobal=HttpGlobal;__reflect(HttpGlobal.prototype,"lz.HttpGlobal")})(lz||(lz={}));var lz;(function(lz){var HttpManager=function(){function HttpManager(){this._reqID=0;this.errorTimes=0;this.locked=false;this.packageArray=[];this.completeCall=[];if(lz.GameConfig.isCross){this.loader=new lz.JsonpRequest}else{this.loader=new lz.HttpRequestX}this.loader.onComplete=this.onComplete.bind(this);this.loader.onRequestError=this.onRequestError.bind(this)}HttpManager.getInstance=function(){if(HttpManager._instance==null)HttpManager._instance=new HttpManager;return HttpManager._instance};HttpManager.prototype.request=function(action,isPost,params,success,fail){var ps="";this._paramsArray=[];if(params!=null){for(var s in params){this._paramsArray.push(s+"="+params[s])}}var pk=new lz.HttpPackage;pk.reqId=this._reqID++;pk.isPost=isPost;pk.senddata=params;pk.action=action;pk.success=success;pk.fail=fail;ps=this._paramsArray.join("&");pk.host=lz.GameConfig.httpURL+action;pk.params=ps;this.packageArray.push(pk);this.startPackage()};HttpManager.prototype.startPackage=function(){if(this.locked==false){if(this.packageArray.length>0){var p=this.packageArray.shift();this.start(p)}}};HttpManager.prototype.start=function(p){if(this._timeOut){egret.clearTimeout(this._timeOut)}this._timeOut=egret.setTimeout(this.timeOutHandler,this,2e4);this.locked=true;this.loader.id=p.reqId;this.loader.isPost=p.isPost;this.loader.action=p.action;this.loader.senddata=p.senddata;this.success=p.success;this.fail=p.fail;this.loader.getURL(p.host,p.params)};HttpManager.prototype.timeOutHandler=function(){lz.Wait.hide("HTTP_TIMEOUT");var ld=this.loader;console.log("网络连接超时");this.reset();if(ld.action==lz.HttpGlobal.COMMAND_GAMEGOLD){}if(this.fail){this.fail(999)}};HttpManager.prototype.onRequestError=function(action,response){lz.Wait.hide("HTTP_ERROR");if(this.fail){this.fail(action)}console.log("消息发送失败-------\x3e"+action);this.errorTimes++;if(this.errorTimes>5){}else{this.reset()}};HttpManager.prototype.reset=function(){this.locked=false};HttpManager.prototype.onComplete=function(request){lz.Wait.hide("HTTP_DATA");if(this._timeOut){egret.clearTimeout(this._timeOut)}this.errorTimes=0;var data=request.recvdata;var code=data.code;if(code>0){lz.MessageBox.show(data.msg)}else{}if(this.success){this.success(request)}this.locked=false;this.startPackage()};return HttpManager}();lz.HttpManager=HttpManager;__reflect(HttpManager.prototype,"lz.HttpManager")})(lz||(lz={}));var lz;(function(lz){var BitmapAnimation=function(_super){__extends(BitmapAnimation,_super);function BitmapAnimation(){var _this=_super.call(this)||this;_this._loop=true;_this._fps=30;_this._delta=1e3/_this._fps;_this._passed=0;_this._current=1;_this._max=1;_this._repeatcount=0;_this._sourceArr=[];_this._repeatTimes=0;_this._extension="_png";_this._isPlayback=false;_this._attackFrame=-1;_this._isCache=false;_this._roationVal=0;_this.pixelHitTest=true;_this.touchEnabled=false;return _this}Object.defineProperty(BitmapAnimation.prototype,"loop",{set:function(value){this._loop=value},enumerable:true,configurable:true});Object.defineProperty(BitmapAnimation.prototype,"fps",{set:function(value){this._fps=value;this._delta=1e3/this._fps},enumerable:true,configurable:true});Object.defineProperty(BitmapAnimation.prototype,"max",{set:function(value){this._max=value;this._current=1;this._repeatcount=0;this._passed=0;if(this._max==1){this.pause=true;this.onLoopComplete();this.dispatchEventWith(BitmapAnimation.LOOP_COMPLETE)}else{this.pause=false}},enumerable:true,configurable:true});Object.defineProperty(BitmapAnimation.prototype,"prefix",{set:function(value){this._prefix=value;this._current=1;this._repeatcount=0;this._passed=0;if(this._max==1){this.pause=true}else{this.pause=false}this.reload()},enumerable:true,configurable:true});BitmapAnimation.prototype.sourceArr=function(value,attackFrame){if(attackFrame===void 0){attackFrame=-1}this._sourceArr=value;this.max=this._sourceArr.length;if(attackFrame>0){this._attackFrame=attackFrame}else{this._attackFrame=-1}this.reload()};Object.defineProperty(BitmapAnimation.prototype,"extension",{set:function(value){this._extension=value},enumerable:true,configurable:true});Object.defineProperty(BitmapAnimation.prototype,"isPlayback",{set:function(value){this._isPlayback=value;this._current=this._max;this.reload()},enumerable:true,configurable:true});Object.defineProperty(BitmapAnimation.prototype,"repeatTimes",{get:function(){return this._repeatTimes},set:function(value){if(value<0){value=0}if(value==1){this.loop=false}else{this._repeatTimes=value}},enumerable:true,configurable:true});Object.defineProperty(BitmapAnimation.prototype,"current",{get:function(){return this._current},enumerable:true,configurable:true});Object.defineProperty(BitmapAnimation.prototype,"roationVal",{set:function(value){this._roationVal=value},enumerable:true,configurable:true});Object.defineProperty(BitmapAnimation.prototype,"isCache",{get:function(){return this._isCache},set:function(v){this._isCache=v},enumerable:true,configurable:true});BitmapAnimation.prototype.reload=function(){var _this=this;if(this._current<1){this._current=1}if(this._sourceArr.length){var res_1=this._sourceArr[this._current-1];if(typeof res_1==="string"){if(BitmapAnimation.isAddExtension){res_1+=this._extension}if(RES.hasRes(res_1)){this.source=res_1}else{if(lz.ImgLoaderUtil.imgDic[res_1]){this.source=lz.ImgLoaderUtil.imgDic[res_1]}else{lz.ImgLoaderUtil.getImgByUrl(res_1).then(function(imgRsp){if(!imgRsp.isSucc){return}else{var texture=imgRsp.texture;if(_this.isCache){lz.ImgLoaderUtil.imgDic[res_1]=texture}_this.source=texture}})}}}else{this.source=res_1}}else if(this._prefix&&this._prefix.length>0){this.source=this._prefix+"_"+this._current+this._extension}else{this.pause=true;return}};BitmapAnimation.prototype.setAttackFrame=function(frame,callBack,thisObject){this._callBack=callBack;this._attackFrame=frame;this._callBackObj=thisObject};BitmapAnimation.prototype.onLoopComplete=function(){};BitmapAnimation.prototype.update=function(delta){if(this.pause==false){this._passed+=delta;if(this._passed>=this._delta){var passedcount=Math.floor(this._passed/this._delta);this._passed=this._passed%this._delta;var current=this._current;if(this._isPlayback){current-=passedcount}else{current+=passedcount}if(current!=this._current){var oldVal=this._current;this._current=current;if(this._current>this._max||this._current<1){if(this._loop)this._current=this._isPlayback?this._max:current%this._max;else this._current=this._isPlayback?1:this._max}this.reload();if(this._current-1==this._attackFrame&&oldVal!=this._current){if(this._callBack){this._callBackObj(this._callBackObj)}this.dispatchEventWith(BitmapAnimation.ATTACK_FRAME)}}if(current>this._max||current<1){this._repeatcount++;if(this._loop){if(this.repeatTimes>0&&this._repeatcount>=this.repeatTimes){this.pause=true;this.onLoopComplete();this.dispatchEventWith(BitmapAnimation.LOOP_COMPLETE)}}else{this.pause=true;this.onLoopComplete();this.dispatchEventWith(BitmapAnimation.LOOP_COMPLETE)}}}}if(Math.abs(this._roationVal)>0){this.rotation+=this._roationVal}};BitmapAnimation.isAddExtension=false;BitmapAnimation.LOOP_COMPLETE="BitmapAnimation_Loop_Complete";BitmapAnimation.ATTACK_FRAME="BitmapAnimation_Attack_Frame";return BitmapAnimation}(lz.Updateable);lz.BitmapAnimation=BitmapAnimation;__reflect(BitmapAnimation.prototype,"lz.BitmapAnimation")})(lz||(lz={}));var lz;(function(lz){var HttpRequestX=function(){function HttpRequestX(){this.isPost=true;this.httpReq=new egret.HttpRequest;this.httpReq.addEventListener(egret.Event.COMPLETE,this.onHttpComplete,this);this.httpReq.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onHttpError,this)}HttpRequestX.prototype.getURL=function(url,params){this.url=url;this.httpReq.responseType=egret.HttpResponseType.TEXT;this.httpReq.setRequestHeader("Content-Type","application/x-www-form-urlencoded");if(this.isPost){this.httpReq.open(url,egret.HttpMethod.POST)}else{this.httpReq.open(url,egret.HttpMethod.GET)}this.httpReq.send(params)};HttpRequestX.prototype.onHttpError=function(event){if(this.onRequestError){this.onRequestError(this.action,event.data)}};HttpRequestX.prototype.onHttpComplete=function(event){if(this.onComplete){this.recvdata=JSON.parse(this.httpReq.response);this.onComplete(this)}};return HttpRequestX}();lz.HttpRequestX=HttpRequestX;__reflect(HttpRequestX.prototype,"lz.HttpRequestX",["lz.IRequest"])})(lz||(lz={}));var lz;(function(lz){var JsonpRequest=function(_super){__extends(JsonpRequest,_super);function JsonpRequest(){var _this=_super.call(this)||this;_this.isPost=false;return _this}JsonpRequest.prototype.getURL=function(url){var _this=this;this.url=url;lz.HttpManager.getInstance().completeCall["call_"+this.id.toString()]=function(data){_this.recvdata=data;if(_this.onComplete){_this.recvdata=data;_this.onComplete(_this)}delete lz.HttpManager.getInstance().completeCall[_this.id];document.body.removeChild(_this.script)};this.script=document.createElement("script");this.script.src=url+"?callback=HttpManager.completeCall.call_"+this.id.toString();document.body.appendChild(this.script)};return JsonpRequest}(egret.EventDispatcher);lz.JsonpRequest=JsonpRequest;__reflect(JsonpRequest.prototype,"lz.JsonpRequest",["lz.IRequest"])})(lz||(lz={}));var lz;(function(lz){var RequestFun=function(){function RequestFun(){}RequestFun.choiceMode=function(modeid,success,fail){lz.HttpGlobal.makeRequest(lz.HttpGlobal.COMMAND_CONTEND_PAY,true,success,fail,"gameid",lz.GameConfig.gameId,"modeid",modeid)};return RequestFun}();lz.RequestFun=RequestFun;__reflect(RequestFun.prototype,"lz.RequestFun")})(lz||(lz={}));var lz;(function(lz){var POLYGON_TYPE;(function(POLYGON_TYPE){POLYGON_TYPE[POLYGON_TYPE["CIRCLE"]=0]="CIRCLE";POLYGON_TYPE[POLYGON_TYPE["SEGMENT"]=1]="SEGMENT";POLYGON_TYPE[POLYGON_TYPE["POLY"]=2]="POLY"})(POLYGON_TYPE=lz.POLYGON_TYPE||(lz.POLYGON_TYPE={}));var BasePolygon=function(_super){__extends(BasePolygon,_super);function BasePolygon(){var _this=_super.call(this)||this;_this._borderColor=2070193;_this._isShowBorder=false;_this._isShowVertex=false;_this._anchorType=5;_this._polygonType=POLYGON_TYPE.POLY;_this._rotation=0;return _this}BasePolygon.prototype.getCollisionPoly=function(){return this._vertexList};BasePolygon.prototype.isCircle=function(){return this._polygonType==POLYGON_TYPE.CIRCLE};BasePolygon.prototype.getPos=function(){return new egret.Point(this.x,this.y)};BasePolygon.prototype.changeBorderColor=function(c){if(this._borderColor==c)return;this._borderColor=c;this.checkHitBorder()};BasePolygon.prototype.checkHitBorder=function(){this.graphics.clear();if(!this._isShowBorder){return}if(this._borderColor>=0){this.graphics.lineStyle(5,this._borderColor)}if(!this._vertexList){lz.Log.out(this,"ERROR------\x3e undefind vertexList");return}switch(this._polygonType){case POLYGON_TYPE.CIRCLE:this.graphics.beginFill(this._borderColor);this.graphics.drawCircle(this._initialVertex[0].x,this._initialVertex[0].y,this._initialVertex[1].x);this.graphics.endFill();break;case POLYGON_TYPE.SEGMENT:this.graphics.lineStyle(2,this._borderColor);this.graphics.moveTo(this._initialVertex[0].x,this._initialVertex[0].y);this.graphics.lineTo(this._initialVertex[1].x,this._initialVertex[1].y);break;case POLYGON_TYPE.POLY:for(var i=0;i<this._vertexList.length;i++){if(!i)this.graphics.moveTo(this.anchorOffsetX+this._initialVertex[0].x,this.anchorOffsetY+this._initialVertex[0].y);this.graphics.lineTo(this.anchorOffsetX+this._initialVertex[i].x,this.anchorOffsetY+this._initialVertex[i].y)}break;default:console.error("polygonType err");return}};BasePolygon.prototype.checkVertexInfo=function(){if(!this._isShowVertex){if(this._vertexSp){this._vertexSp.removeChildren()}return}if(!this._vertexSp){this._vertexSp=new egret.Sprite;this.addChild(this._vertexSp)}this._vertexSp.removeChildren();for(var i=0;i<this._vertexList.length;i++){var pnum=new egret.TextField;pnum.x=this.anchorOffsetX+this._initialVertex[i].x;pnum.y=this.anchorOffsetY+this._initialVertex[i].y-20;pnum.size=16;pnum.text="("+i+":"+Math.floor(this._vertexList[i].x)+","+Math.floor(this._vertexList[i].y)+")";pnum.anchorOffsetX=pnum.width/2;pnum.anchorOffsetY=pnum.height/2;this._vertexSp.addChild(pnum)}};Object.defineProperty(BasePolygon.prototype,"rotation",{get:function(){return this._rotation},set:function(rotation){if(this._rotation!=rotation){this._rotation=rotation;egret.superSetter(BasePolygon,this,"rotation",rotation);if(!this._vertexList){lz.Log.out(this,"ERROR------\x3e undefind vertexList");return}this._vertexList=lz.DisplayUtils.getVertexList(this._initialVertex,this.rotation);this.checkVertexInfo()}},enumerable:true,configurable:true});Object.defineProperty(BasePolygon.prototype,"vertexList",{set:function(v){this._vertexList=v;this._initialVertex=v},enumerable:true,configurable:true});Object.defineProperty(BasePolygon.prototype,"polygonType",{set:function(value){this._polygonType=value},enumerable:true,configurable:true});Object.defineProperty(BasePolygon.prototype,"anchorType",{get:function(){return this._anchorType},set:function(value){this._anchorType=value;lz.DisplayUtils.setAnchorByType(this,value)},enumerable:true,configurable:true});Object.defineProperty(BasePolygon.prototype,"isShowBorder",{set:function(b){if(this._isShowBorder!=b){this._isShowBorder=b;this.checkHitBorder()}},enumerable:true,configurable:true});Object.defineProperty(BasePolygon.prototype,"isShowVertex",{set:function(b){if(this._isShowVertex!=b){this._isShowVertex=b;this.checkVertexInfo()}},enumerable:true,configurable:true});return BasePolygon}(egret.Sprite);lz.BasePolygon=BasePolygon;__reflect(BasePolygon.prototype,"lz.BasePolygon",["lz.IPolygon"])})(lz||(lz={}));var SAT;(function(SAT){var POLYDIR;(function(POLYDIR){POLYDIR[POLYDIR["CLOCKWISE"]=-1]="CLOCKWISE";POLYDIR[POLYDIR["INALINE"]=0]="INALINE";POLYDIR[POLYDIR["ANTICLOCKWISE"]=1]="ANTICLOCKWISE"})(POLYDIR||(POLYDIR={}));var IntersectionStruct=function(){function IntersectionStruct(){this.intersectionindex=-1;this.intersectionpoint=new egret.Point(0,0)}return IntersectionStruct}();__reflect(IntersectionStruct.prototype,"IntersectionStruct");function isConcavePoly(p){if(p.length<=3)return false;return getNextConcaveIndex(p,0)>=0}SAT.isConcavePoly=isConcavePoly;function onSeparateConcavePoly(p){var szlist=[];if(!isAntiClockDir(p)){conversPoly(p)}_separateConcavePoly(p,szlist,0);return szlist}SAT.onSeparateConcavePoly=onSeparateConcavePoly;function getNextConcaveIndex(p,starindex){if(starindex===void 0){starindex=0}if(p.length<=3)return-1;var curdir=0;var nextpos=0;var nmax=p.length+starindex;for(var i=starindex;i<nmax;i++){curdir=getMutiPtClockDir(p[(i+p.length)%p.length],p[(i-1+p.length)%p.length],p[(i+1+p.length)%p.length]);if(curdir==POLYDIR.ANTICLOCKWISE)return i%p.length}return-1}SAT.getNextConcaveIndex=getNextConcaveIndex;function getAllConcaveIndex(p,starindex){if(starindex===void 0){starindex=0}if(p.length<=3)return[];var szlist=[];var curdir=0;var nextpos=0;var nmax=p.length+starindex;for(var i=starindex;i<nmax;i++){curdir=getMutiPtClockDir(p[(i+p.length)%p.length],p[(i-1+p.length)%p.length],p[(i+1+p.length)%p.length]);if(curdir==POLYDIR.ANTICLOCKWISE){szlist.push(i%p.length)}}return szlist}SAT.getAllConcaveIndex=getAllConcaveIndex;function _separateConcavePoly(p,szlist,startindex){if(p.length<=3){szlist.push(p);return}var nextconcaveindex=getNextConcaveIndex(p,startindex);startindex=nextconcaveindex+1;if(nextconcaveindex<0){szlist.push(p);return}var intersectionst=new IntersectionStruct;if(getSplitPointByRgnBCInter(p,nextconcaveindex,intersectionst)){var szleft=[];var szright=[];splitPolyByIntersection(p,nextconcaveindex,intersectionst,szleft,szright);_separateConcavePoly(szleft,szlist,startindex);_separateConcavePoly(szright,szlist,startindex);return}szlist.push(p)}function splitPolyByIntersection(p,concaveindex,intersectionst,szleft,szright){if(concaveindex<0||concaveindex>=p.length)return false;if(intersectionst.intersectionindex<0||intersectionst.intersectionindex>=p.length)return false;var i=0;if(concaveindex<=intersectionst.intersectionindex+1){for(i=intersectionst.intersectionindex;i<=concaveindex+p.length;i++){var pn1=p[i%p.length];szleft.push(pn1)}}else{for(i=intersectionst.intersectionindex;i<=concaveindex;i++){var pn2=p[i];szleft.push(pn2)}}if(concaveindex<=intersectionst.intersectionindex){for(i=concaveindex;i<=intersectionst.intersectionindex;i++){var pn3=p[i];szright.push(pn3)}}else{for(i=concaveindex;i<=intersectionst.intersectionindex+p.length;i++){var pn4=p[i%p.length];szright.push(pn4)}}if(p[intersectionst.intersectionindex].x!=intersectionst.intersectionpoint.x&&p[intersectionst.intersectionindex].y!=intersectionst.intersectionpoint.y){szleft.push(intersectionst.intersectionpoint);szright.push(intersectionst.intersectionpoint)}return true}function getSplitPointByRgnBCInter(p,concaveindex,intersectionst){if(p.length<=3)return false;var preindex,nextindex;preindex=concaveindex>0?concaveindex-1:p.length-1;nextindex=concaveindex<p.length-1?concaveindex+1:0;var ret1=0;var ret2=0;var A=[];var B=[];var C=[];var D=[];var A1=[];var B1=[];var C1=[];var D1=[];var nmax=0;nmax=nextindex<=preindex?preindex:preindex+p.length;var ncur=0;for(var i=nextindex;i<=nmax;i++){ncur=i%p.length;ret1=getMutiPtClockDir(p[concaveindex],p[preindex],p[ncur]);ret2=getMutiPtClockDir(p[concaveindex],p[nextindex],p[ncur]);if(ret1<0&&ret2>0){A.push(ncur)}else if(ret1>=0&&ret2>=0){B.push(ncur)}else if(ret1<=0&&ret2<0){C.push(ncur)}else if(ret1>0&&ret2<0){D.push(ncur)}}visibleRegionPtSet(p,concaveindex,A,A1);B1=B.concat();D1=D.concat();visibleRegionPtSet(p,concaveindex,C,C1);if(A1.length>0){var setA=[];var setB=[];setSplitByRegion(p,A1,setA,setB);if(setB.length>0){intersectionst.intersectionindex=getBestIntersectionPt(p,concaveindex,setB)}else{intersectionst.intersectionindex=getBestIntersectionPt(p,concaveindex,setA)}if(intersectionst.intersectionindex<0||intersectionst.intersectionindex>=p.length){return false}intersectionst.intersectionpoint=p[intersectionst.intersectionindex];return true}if(B1.length<1||C1.length<1){console.warn("BC分区为空错误");return false}var mid=0;var left=0;var right=0;mid=concaveindex;left=B1[B1.length-1];right=C1[0];var d1=new egret.Point(p[right].x-p[left].x,p[right].y-p[left].y);var d00=new egret.Point(p[concaveindex].x-p[preindex].x,p[concaveindex].y-p[preindex].y);var d01=new egret.Point(p[concaveindex].x-p[nextindex].x,p[concaveindex].y-p[nextindex].y);var d0=new egret.Point((d00.x+d01.x)/2,(d00.y+d01.y)/2);var crosspt=new egret.Point(0,0);if(getCrossByRadialAndSegment(p[concaveindex],d0,p[left],d1,crosspt)!=1)return false;intersectionst.intersectionindex=left;intersectionst.intersectionpoint=crosspt;return true}function getMutiPtClockDir(op,sp,ep){var ret=(op.x-sp.x)*(ep.y-op.y)-(ep.x-op.x)*(op.y-sp.y);return ret>0?POLYDIR.ANTICLOCKWISE:ret<0?POLYDIR.CLOCKWISE:POLYDIR.INALINE}function getMutiPtClockDirByIndex(p,index){if(p.length<=2)return POLYDIR.INALINE;return getMutiPtClockDir(p[index%p.length],p[(index+p.length-1)%p.length],p[(index+1)%p.length])}function isAntiClockDir(p){if(p.length<=2)return true;var n=0;var count=0;var nextindex=0;var nextindex2=0;for(var i=1;i<p.length;i++){nextindex=(i+1)%p.length;nextindex2=(i+2)%p.length;n=(p[nextindex].x-p[i].x)*(p[nextindex2].y-p[nextindex].y);n-=(p[nextindex].y-p[i].y)*(p[nextindex2].x-p[nextindex].x);if(n<0)count--;else if(n>0)count++}return count<=0}function conversPoly(p){var count=p.length;var i=-1;while(++i<count/2){var pn1,pn2;pn1=p[i];pn2=p[count-i-1];p[i]=pn2;p[count-i-1]=pn1}}function isVectorInsection(p0,d0,p1,d1){var e=new egret.Point(p1.x-p0.x,p1.y-p0.y);var kross=d0.x*d1.y-d0.y*d1.x;var sqrKross=kross*kross;var sqrLen0=d0.x*d0.x+d0.y*d0.y;var sqrLen1=d1.x*d1.x+d1.y*d1.y;var sqrEpsilon=.01;if(sqrKross>sqrEpsilon*sqrLen0*sqrLen1){var s=(e.x*d1.y-e.y*d1.x)/kross;if(s<0||s>1){return 0}var t=(e.x*d0.y-e.y*d0.x)/kross;if(t<0||t>1){return 0}return 1}return 0}function isVisiblePtToConcave(p,index1,index2){var nextindex=0;for(var i=0;i<p.length;i++){nextindex=i>=p.length-1?0:i+1;if(i==index1||i==index2||nextindex==index1||nextindex==index2)continue;if(isVectorInsection(p[index1],p[index2],p[i],p[nextindex]))return false}return true}function visibleRegionPtSet(p,concaveindex,region,region1){var i=-1;while(++i<region.length){if(isVisiblePtToConcave(p,concaveindex,region[i])){region1.push(region[i])}}}function setSplitByRegion(p,region1,setA,setB){var i=-1;while(++i<region1.length){if(getMutiPtClockDirByIndex(p,region1[i])){setA.push(region1[i])}else{setB.push(region1[i])}}}function normalizeVector2(v){var n=Math.sqrt(v.x*v.x+v.y*v.y);if(n<=0)return;v.x=v.x/n;v.y=v.y/n}function dotVector2(v0,v1){return v0.x*v1.x+v0.y*v1.y}function getBestIntersectionPt(p,concaveindex,ptsets){if(ptsets.length<1)return-1;var bestindex=-1;var preindex,nextindex;preindex=(p.length+concaveindex-1)%p.length;nextindex=(p.length+concaveindex+1)%p.length;var d00=new egret.Point;var d01=new egret.Point;d00.x=p[concaveindex].x-p[preindex].x;d00.y=p[concaveindex].y-p[preindex].y;d01.x=p[concaveindex].x-p[nextindex].x;d01.y=p[concaveindex].y-p[nextindex].y;normalizeVector2(d00);normalizeVector2(d01);var fLen=-1;var i=-1;while(++i<ptsets.length){var tp=new egret.Point;tp=p[ptsets[i]];var dp=new egret.Point;dp.x=tp.x-p[concaveindex].x;dp.y=tp.y-p[concaveindex].y;normalizeVector2(dp);var nTemLen=Math.abs(dotVector2(d00,dp));if(nTemLen>fLen){bestindex=ptsets[i]}}return bestindex}function getCrossByRadialAndSegment(p0,d0,p1,d1,crosspt){var e=new egret.Point(p1.x-p0.x,p1.y-p0.y);var kross=d0.x*d1.y-d0.y*d1.x;var sqrKross=kross*kross;var sqrLen0=d0.x*d0.x+d0.y*d0.y;var sqrLen1=d1.x*d1.x+d1.y*d1.y;var sqrEpsilon=.01;if(sqrKross>sqrEpsilon*sqrLen0*sqrLen1){var s=(e.x*d1.y-e.y*d1.x)/kross;if(s<0){return 0}var t=(e.x*d0.y-e.y*d0.x)/kross;if(t<0||t>1){return 0}var pt=new egret.Point(d0.x*s,d0.y*s);crosspt.x=p0.x+pt.x;crosspt.y=p0.y+pt.y;return 1}return 0}function GetPosRelationToLine(sp,ep,dp){return dp.x*(ep.y-sp.y)+dp.y*(sp.x-ep.x)+sp.y*ep.x-sp.x*ep.y}})(SAT||(SAT={}));var SAT_SIMPLE;(function(SAT_SIMPLE){function sat(p1,p2){if(p1.length<3||p2.length<3)return 0;var szaxis=[];szaxis=getUniqueAxis(p1,szaxis);szaxis=getUniqueAxis(p2,szaxis);var i;var extreme1,extreme2=new egret.Point;for(i=0;i<szaxis.length;i++){extreme1=getProjection(p1,szaxis[i]);extreme2=getProjection(p2,szaxis[i]);if(!overlap(extreme1,extreme2))return 0}return 1}SAT_SIMPLE.sat=sat;function dot(v1,v2){return v1.x*v2.x+v1.y*v2.y}SAT_SIMPLE.dot=dot;function normalize(vf){var v=new egret.Point(vf.x,vf.y);var n=Math.sqrt(v.x*v.x+v.y*v.y);if(!n)return v;v.x/=n;v.y/=n;return v}SAT_SIMPLE.normalize=normalize;function perp(vf){var v=new egret.Point(vf.x,vf.y);var t=v.x;v.x=v.y;v.y=-t;return v}SAT_SIMPLE.perp=perp;function getUniqueAxis(p,curaxis){if(curaxis===void 0){curaxis=[]}var i,j=0;var b=false;var nor=new egret.Point;var segment=new egret.Point;for(i=0;i<p.length;i++){if(i>=p.length-1){segment.x=p[0].x-p[i].x;segment.y=p[0].y-p[i].y}else{segment.x=p[i+1].x-p[i].x;segment.y=p[i+1].y-p[i].y}nor=perp(normalize(segment));if(nor.x<=0){if(nor.x==0){if(nor.y<0)nor.y*=-1}else{nor.x*=-1;nor.y*=-1}}b=true;for(j=0;j<curaxis.length;j++){if(curaxis[j].x!=nor.x)continue;if(curaxis[j].y!=nor.y)continue;b=false;break}if(!b)continue;curaxis.push(nor)}return curaxis}function overlap(s1,s2){if(s1.x>s2.y)return 0;if(s1.y<s2.x)return 0;if((s1.x-s2.x)*(s2.x-s2.y)<0)return 1;return 1}function getProjection(p,axis){var ret=new egret.Point;var n,min,max=0;min=dot(p[0],axis);max=min;for(var i=1;i<p.length;i++){n=dot(p[i],axis);if(n<min)min=n;if(n>max)max=n}ret.x=min;ret.y=max;return ret}})(SAT_SIMPLE||(SAT_SIMPLE={}));var SAT;(function(SAT){function sat(pos1,pos2,p1,p2,iscircle1,iscircle2){if(iscircle1===void 0){iscircle1=false}if(iscircle2===void 0){iscircle2=false}if(p1.length<1||p2.length<1)return false;var ismuti1=p1[0].constructor.name=="Array";var ismuti2=p2[0].constructor.name=="Array";if(!ismuti1&&!ismuti2){return convexsat(pos1,pos2,p1,p2,iscircle1,iscircle2)}var i=0;var j=0;if(ismuti1&&ismuti2){for(i=0;i<p1.length;i++){for(j=0;j<p1.length;j++){if(convexsat(pos1,pos2,p1[i],p2[j],iscircle1,iscircle2))return true}}return false}if(ismuti1){for(i=0;i<p1.length;i++){if(convexsat(pos1,pos2,p1[i],p2,iscircle1,iscircle2))return true}return false}for(i=0;i<p2.length;i++){if(convexsat(pos1,pos2,p1,p2[i],iscircle1,iscircle2)){return true}}return false}SAT.sat=sat;function convexsat(pos1,pos2,p1,p2,iscircle1,iscircle2){if(iscircle1===void 0){iscircle1=false}if(iscircle2===void 0){iscircle2=false}if(p1.length<1||p2.length<1)return false;if(iscircle1&&iscircle2)return circleHit(pos1,pos2,p1,p2);var szaxis=[];if(iscircle1&&iscircle2){var segment=new egret.Point(pos1.x-pos2.x,pos1.y-pos2.y);szaxis.push(perp(normalize(segment)))}else{if(!iscircle1){szaxis=getUniqueAxis(p1,szaxis)}if(!iscircle2){szaxis=getUniqueAxis(p2,szaxis)}}var i;var extreme1,extreme2=new egret.Point;for(i=0;i<szaxis.length;i++){if(iscircle1){extreme1=getCircleProjection(pos1,p1,szaxis[i])}else{extreme1=getProjection(pos1,p1,szaxis[i])}if(iscircle2){extreme2=getCircleProjection(pos2,p2,szaxis[i])}else{extreme2=getProjection(pos2,p2,szaxis[i])}if(!overlap(extreme1,extreme2)){return false}}return true}function circleHit(pos1,pos2,p1,p2){if(p1.length!=2||p2.length!=2)return false;var dis2=Math.pow(p1[0].x+pos1.x-(p2[0].x+pos2.x),2)+Math.pow(p1[0].y+pos1.y-(p2[0].y+pos2.y),2);var rd=Math.pow(p1[1].x+p2[1].x,2);return dis2<rd}SAT.circleHit=circleHit;function getPolyBound(p){if(p.length<1)return[0,0,0,0];var szpt=[p[0].x,p[0].y,p[0].x,p[0].y];for(var i=0;i<p.length;i++){if(p[i].x<szpt[0])szpt[0]=p[i].x;if(p[i].y<szpt[1])szpt[1]=p[i].y;if(p[i].x>szpt[2])szpt[2]=p[i].x;if(p[i].y>szpt[3])szpt[3]=p[i].y}return szpt}SAT.getPolyBound=getPolyBound;function getCircleBound(p){if(p.length!=2)return[0,0,0,0];var szpt=[p[0].x-p[1].x,p[0].y-p[1].x,p[0].x+p[1].x,p[0].y+p[1].x];return szpt}SAT.getCircleBound=getCircleBound;function boundHit(pos1,pos2,p1,p2){if(p1.length!=4||p2.length!=4)return false;if(!overlap(new egret.Point(p1[0]+pos1.x,p1[2]+pos1.x),new egret.Point(p2[0]+pos2.x,p2[2]+pos2.x)))return false;if(!overlap(new egret.Point(p1[1]+pos1.y,p1[3]+pos1.y),new egret.Point(p2[1]+pos2.y,p2[3]+pos2.y)))return false;return true}SAT.boundHit=boundHit;function dot(v1,v2){return v1.x*v2.x+v1.y*v2.y}SAT.dot=dot;function normalize(vf){var v=new egret.Point(vf.x,vf.y);var n=Math.sqrt(v.x*v.x+v.y*v.y);if(!n)return v;v.x=Math.round(v.x*100/n)/100;v.y=Math.round(v.y*100/n)/100;return v}SAT.normalize=normalize;function perp(vf){var v=new egret.Point(vf.x,vf.y);var t=v.x;v.x=v.y;v.y=-t;return v}SAT.perp=perp;function getUniqueAxis(p,curaxis){if(curaxis===void 0){curaxis=[]}var i,j=0;var b=false;var nor=new egret.Point;var segment=new egret.Point;for(i=0;i<p.length;i++){if(i>=p.length-1){segment.x=p[0].x-p[i].x;segment.y=p[0].y-p[i].y}else{segment.x=p[i+1].x-p[i].x;segment.y=p[i+1].y-p[i].y}nor=perp(normalize(segment));if(nor.x<=0){if(nor.x==0){if(nor.y<0)nor.y*=-1}else{nor.x*=-1;nor.y*=-1}}b=true;for(j=0;j<curaxis.length;j++){if(curaxis[j].x!=nor.x)continue;if(curaxis[j].y!=nor.y)continue;b=false;break}if(!b)continue;curaxis.push(nor)}return curaxis}function overlap(s1,s2){if(s1.x>s2.y)return 0;if(s1.y<s2.x)return 0;if((s1.x-s2.x)*(s2.x-s2.y)<0)return 1;return 1}function getProjection(pos,p,axis){var ret=new egret.Point;var n,min,max=0;min=dot(new egret.Point(p[0].x+pos.x,p[0].y+pos.y),axis);max=min;for(var i=1;i<p.length;i++){n=dot(new egret.Point(p[i].x+pos.x,p[i].y+pos.y),axis);if(n<min)min=n;if(n>max)max=n}ret.x=min;ret.y=max;return ret}function getCircleProjection(pos,p,axis){var ret=new egret.Point;ret.x=dot(new egret.Point(p[0].x+pos.x,p[0].y+pos.y),axis)-p[1].x;ret.y=ret.x+2*p[1].x;return ret}})(SAT||(SAT={}));var lz;(function(lz){var AlertType;(function(AlertType){AlertType[AlertType["YesNo"]=0]="YesNo";AlertType[AlertType["Ok"]=1]="Ok"})(AlertType=lz.AlertType||(lz.AlertType={}));var Alert=function(_super){__extends(Alert,_super);function Alert(){return _super.call(this)||this}Object.defineProperty(Alert.prototype,"moduleName",{get:function(){return Alert._skin},enumerable:true,configurable:true});Object.defineProperty(Alert.prototype,"resource",{get:function(){return Alert._group},enumerable:true,configurable:true});Alert.setSkin=function(skin,group){if(skin===void 0){skin=""}if(group===void 0){group=""}this._skin=skin;this._group=group};Alert.prototype.onAdded=function(event){_super.prototype.onAdded.call(this,event)};Alert.prototype.loadComplete=function(){_super.prototype.loadComplete.call(this);lz.DisplayUtils.center(this);this.btn_Ok.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchOk,this);this.btn_btnConfirm.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchOk,this);this.btn_Cancel.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchCancel,this);if(this.box_tips){this.box_tips.selected=false}if(this.grp_tips){this.grp_tips.visible=false}this.lbl_Context.htmlText=this.context;this.lbl_Title.text=this.title;this.lbl_Context.size=this.size;this.lbl_Context.textAlign=egret.HorizontalAlign.CENTER;this.btn_btnConfirm.visible=this.btn_Ok.visible=this.btn_Cancel.visible=false;if(this.type==AlertType.YesNo){this.btn_Ok.visible=this.btn_Cancel.visible=true}else{this.btn_btnConfirm.visible=true}if(this.grp_tips){if(this.nextRemindId>0){this.grp_tips.visible=true}else{this.grp_tips.visible=false}}};Alert.cancelAuto=function(autoId){Alert._value[autoId]=null};Alert.show=function(context,title,okFun,type,cancelFun,nextId,size){if(title===void 0){title=""}if(okFun===void 0){okFun=null}if(type===void 0){type=0}if(cancelFun===void 0){cancelFun=null}if(nextId===void 0){nextId=0}if(size===void 0){size=30}if(Alert._skin.length==0){lz.MessageBox.show("Alert Skin No Setting！");return}var _instance=new Alert;_instance.type=type;_instance.okFunc=okFun;_instance.cancelFun=cancelFun;_instance.title=title;_instance.context=context;_instance.nextRemindId=nextId;_instance.size=size;lz.PopupManager.addAlert(_instance)};Alert.prototype.onTouchOk=function(event){lz.PopupManager.delAlert(this);if(this.okFunc)this.okFunc();if(this.box_tips&&this.nextRemindId>0){if(this.box_tips.selected==true){Alert._value[this.nextRemindId]=true}}};Alert.getStatus=function(nextId){if(Alert._value[nextId]!=null){return true}return false};Alert.prototype.onTouchCancel=function(event){lz.PopupManager.delAlert(this);if(this.box_tips&&this.nextRemindId>0){if(this.box_tips.selected==true){Alert._value[this.nextRemindId]=true}}if(this.cancelFun)this.cancelFun()};Alert.prototype.onRemoved=function(event){this.btn_Ok.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchOk,this);this.btn_btnConfirm.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchOk,this);this.btn_Cancel.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchCancel,this);_super.prototype.onRemoved.call(this,event)};Alert._value=[];Alert._skin="";Alert._group="";return Alert}(lz.BaseView);lz.Alert=Alert;__reflect(Alert.prototype,"lz.Alert")})(lz||(lz={}));var lz;(function(lz){var MessageItem=function(_super){__extends(MessageItem,_super);function MessageItem(){var _this=_super.call(this)||this;_this._rect=null;_this._textColor=16777215;_this._rect=lz.DisplayUtils.createRect(0,0,20,20,0,.7);_this._lbl=new lz.UILabel;_this._lbl.fontFamily="Arial";_this._lbl.size=28;_this._lbl.stroke=1.5;_this._lbl.touchEnabled=false;_this._lbl.horizontalCenter="0";_this._lbl.touchEnabled=false;_this._lbl.wordWrap=false;_this._lbl.alpha=1;_this.addChild(_this._rect);_this.addChild(_this._lbl);_this.addEventListener(egret.Event.REMOVED_FROM_STAGE,_this.onRemoved,_this);return _this}MessageItem.prototype.onRemoved=function(event){lz.PoolGlobal.getInstance().msgPool.Free(this)};Object.defineProperty(MessageItem.prototype,"msg",{get:function(){return this._msg},set:function(v){this._msg=v;this._lbl.htmlText="[font color='"+this._textColor+"']"+v+"[/font]";this._lbl.y=20;this._lbl.x=30;this._rect.width=this._lbl.width+60;this._rect.height=this._lbl.height+40},enumerable:true,configurable:true});Object.defineProperty(MessageItem.prototype,"textColor",{set:function(textColor){this._textColor=textColor},enumerable:true,configurable:true});Object.defineProperty(MessageItem.prototype,"width",{get:function(){return this._rect.width},enumerable:true,configurable:true});return MessageItem}(egret.DisplayObjectContainer);lz.MessageItem=MessageItem;__reflect(MessageItem.prototype,"lz.MessageItem");var MessageBox=function(_super){__extends(MessageBox,_super);function MessageBox(){return _super.call(this)||this}MessageBox.show=function(str,textColor,delay,alpha){if(textColor===void 0){textColor=16777215}if(delay===void 0){delay=3e3}if(alpha===void 0){alpha=0}if(!this._msgPool){this._msgPool=lz.PoolGlobal.getInstance().msgPool}if(!this._messageContainer){this._messageContainer=new egret.Sprite;this._messageBox=new eui.Component;this._messageBox.horizontalCenter=0;this._messageBox.verticalCenter=0;this._messageBox.addChild(this._messageContainer);lz.GameGlobal.tipsLayer.addChild(this._messageBox);this._messageBox.touchEnabled=false;this._messageBox.touchChildren=false}var msg=this.getMessge(str);msg.alpha=1;this.addMsg(msg);egret.Tween.get(msg).to({alpha:alpha},delay).call(function(){if(msg.parent){msg.parent.removeChild(msg)}})};MessageBox.getMessge=function(str,textColor){if(textColor===void 0){textColor=16777215}var msg=this._msgPool.AllcoObj(MessageItem);msg.textColor=textColor;msg.msg=str;return msg};MessageBox.addMsg=function(msg){if(this._messageContainer.numChildren==0){this._messageContainer.y=0}var r=this._messageContainer.getTransformedBounds(this._messageContainer);msg.y=r.bottom+5;this._messageContainer.addChild(msg);msg.x=-msg.width>>1;if(this._messageContainer.numChildren>5){var mi=this._messageContainer.getChildAt(0);if(lz.ClassUtil.is(mi,"lz.MessageItem")){egret.Tween.removeTweens(mi)}this._messageContainer.removeChildAt(0)}this._messageContainer.addEventListener(egret.Event.ENTER_FRAME,this.efHandle,this)};MessageBox.efHandle=function(e){var r=this._messageContainer.getTransformedBounds(this._messageContainer);if(this._messageContainer.numChildren>=1&&this._messageContainer.y+r.bottom>this._messageContainer.getChildAt(0).height){this._messageContainer.y=this._messageContainer.getChildAt(0).height-r.bottom}else if(this._messageContainer.y+r.bottom>0){this._messageContainer.y-=3}else{this._messageContainer.removeEventListener(egret.Event.ENTER_FRAME,this.efHandle,this)}};return MessageBox}(egret.DisplayObjectContainer);lz.MessageBox=MessageBox;__reflect(MessageBox.prototype,"lz.MessageBox")})(lz||(lz={}));var lz;(function(lz){var BUTTON_STATE;(function(BUTTON_STATE){BUTTON_STATE[BUTTON_STATE["UP"]=0]="UP";BUTTON_STATE[BUTTON_STATE["DOWN"]=1]="DOWN";BUTTON_STATE[BUTTON_STATE["DISABLED"]=2]="DISABLED"})(BUTTON_STATE=lz.BUTTON_STATE||(lz.BUTTON_STATE={}));var UIButton=function(_super){__extends(UIButton,_super);function UIButton(){var _this=_super.call(this)||this;_this._state=BUTTON_STATE.UP;return _this}UIButton.prototype.setBtnRes=function(up,down,disabled){if(down===void 0){down=""}if(disabled===void 0){disabled=""}if(!this.icon){this.iconDisplay=new eui.Image;this.addChild(this.iconDisplay)}this._upRes=up;this._downRes=down.length>0?down:up;this._disabled=disabled.length>0?disabled:up;this.refreshIcon();this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouchHandler,this)};UIButton.prototype.onTouchHandler=function(e){};UIButton.prototype.setButtonState=function(state){this._state=state;this.refreshIcon()};UIButton.prototype.refreshIcon=function(){var res;switch(this._state){case BUTTON_STATE.UP:res=this._upRes;break;case BUTTON_STATE.DOWN:res=this._downRes;break;case BUTTON_STATE.DISABLED:res=this._disabled;break}this.iconDisplay.texture=RES.getRes(res)};Object.defineProperty(UIButton.prototype,"enabled",{get:function(){return this._enabled},set:function(enabled){this._enabled=enabled;if(enabled){this.touchEnabled=this.touchChildren=true;this.setButtonState(BUTTON_STATE.UP)}else{this.touchEnabled=this.touchChildren=false;this.setButtonState(BUTTON_STATE.DISABLED)}},enumerable:true,configurable:true});Object.defineProperty(UIButton.prototype,"label",{get:function(){return this._text},set:function(text){this._text=text;if(this._uiLabel){this._uiLabel=new lz.UILabel;this.addChild(this._uiLabel)}this.labelDisplay.text=text},enumerable:true,configurable:true});return UIButton}(eui.Button);lz.UIButton=UIButton;__reflect(UIButton.prototype,"lz.UIButton")})(lz||(lz={}));var lz;(function(lz){var UIEffectEvent=function(_super){__extends(UIEffectEvent,_super);function UIEffectEvent(type,effect,param){if(param===void 0){param=null}var _this=_super.call(this,type)||this;_this.effect=effect;_this.param=param;return _this}UIEffectEvent.COMPLETE="UIEffectEvent_Complete";UIEffectEvent.LOAD_COMPLETE="UIEffectEvent_Load_Complete";return UIEffectEvent}(egret.Event);lz.UIEffectEvent=UIEffectEvent;__reflect(UIEffectEvent.prototype,"lz.UIEffectEvent");var UIEffect=function(_super){__extends(UIEffect,_super);function UIEffect(){var _this=_super.call(this)||this;_this._id="";_this._timeScale=1;_this._playTimes=0;_this._autoRemove=false;_this.autoHide=true;_this._autoPlay=true;_this._default="newAnimation";_this._loadComplete=false;_this._resArray=[];_this.addEventListener(egret.Event.ADDED_TO_STAGE,_this.onAdded,_this);_this.addEventListener(egret.Event.REMOVED_FROM_STAGE,_this.onRemoved,_this);_this._event=new UIEffectEvent(UIEffectEvent.COMPLETE,"");_this._eventLoad=new UIEffectEvent(UIEffectEvent.LOAD_COMPLETE,"");return _this}UIEffect.prototype.onAdded=function(event){if(this._id!=""){this.startLoad()}this.removeEventListener(egret.Event.ADDED_TO_STAGE,this.onRemoved,this)};UIEffect.prototype.onRemoved=function(event){if(this._armature)this._armature.dispose();if(this._armature&&this._armature.parent){this._armature.parent.removeChild(this._armature)}this._armature=null;RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this);this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemoved,this)};UIEffect.prototype.setNewSlot=function(slotName,textureName){if(this.armature){var slot=this.armature.getSlot(slotName);if(slot){var b=new egret.Bitmap;b.texture=RES.getRes(textureName);b.x=slot.display.x;b.y=slot.display.y;b.anchorOffsetX=b.width/2;b.anchorOffsetY=b.height/2;slot.setDisplay(b)}}};UIEffect.prototype.setEffectInfo=function(aniName,playName,playTimes,isAutoPlay,isAutoRemove,isAutoHide){if(playName===void 0){playName=""}if(playTimes===void 0){playTimes=-1}if(isAutoPlay===void 0){isAutoPlay=true}if(isAutoRemove===void 0){isAutoRemove=false}if(isAutoHide===void 0){isAutoHide=false}this._playTimes=playTimes;this._autoPlay=isAutoPlay;this._autoRemove=isAutoRemove;this._default=playName.length==0?"newAnimation":playName;this.effect=aniName;this.autoHide=isAutoHide};Object.defineProperty(UIEffect.prototype,"animation",{get:function(){if(this._armature){return this._armature.animation}return null},enumerable:true,configurable:true});Object.defineProperty(UIEffect.prototype,"armature",{get:function(){if(this._armature){return this._armature.armature}return null},enumerable:true,configurable:true});Object.defineProperty(UIEffect.prototype,"autoPlay",{get:function(){return this._autoPlay},set:function(value){this._autoPlay=value},enumerable:true,configurable:true});Object.defineProperty(UIEffect.prototype,"autoRemove",{get:function(){return this._autoRemove},set:function(value){this._autoRemove=value},enumerable:true,configurable:true});Object.defineProperty(UIEffect.prototype,"defaultName",{get:function(){return this._default},set:function(value){this._default=value},enumerable:true,configurable:true});Object.defineProperty(UIEffect.prototype,"playTimes",{get:function(){return this._playTimes},set:function(value){this._playTimes=value},enumerable:true,configurable:true});Object.defineProperty(UIEffect.prototype,"replaceTexture",{get:function(){return this._replaceTexture},set:function(t){this._replaceTexture=t;if(this._loadComplete&&this.armature){this.armature.replaceTexture(RES.getRes(t))}},enumerable:true,configurable:true});UIEffect.prototype.startLoad=function(){this.removeChildren();this._resArray=[];this.replaceTexture=this.replaceTexture?this.replaceTexture:this._id+"_tex_png";var groupName="d_"+this._id+"_"+this.replaceTexture;if(!RES.hasRes(groupName)){this._loadComplete=false;RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this);RES.createGroup(groupName,[this._id+"_ske_dbbin",this._id+"_tex_json",this.replaceTexture]);RES.loadGroup(groupName)}};Object.defineProperty(UIEffect.prototype,"timeScale",{set:function(value){this._timeScale=value},enumerable:true,configurable:true});Object.defineProperty(UIEffect.prototype,"effect",{get:function(){return this._id},set:function(value){if(value==""){return}if(this._id!=value){this._id=value;if(this.stage){this.startLoad()}}},enumerable:true,configurable:true});UIEffect.prototype.onResourceLoadError=function(event){console.log("error:"+event.resItem.name)};UIEffect.prototype.onComplete=function(event){if(this.autoHide){this.visible=false}if(this.animation&&this.playTimes>=1){this._event.effect=this._id;this.dispatchEvent(this._event)}if(this.autoRemove){if(this.parent){this.parent.removeChild(this)}}};UIEffect.prototype.onResourceLoadComplete=function(event){if(event.groupName=="d_"+this._id+"_"+this.replaceTexture){this.dispose();this._armature=lz.DragonBonesFactory.instance.getArmatureByRes(this._id,this.replaceTexture);this.animation.timeScale=this._timeScale;this.armature.replaceTexture(RES.getRes(this.replaceTexture));this._armature.addEventListener(dragonBones.MovieEvent.COMPLETE,this.onComplete,this);this._loadComplete=true;this.addChild(this._armature);if(this._autoPlay){this.gotoAndPlay(this._default)}else{this.gotoAndStop(this._default)}this._eventLoad.effect=this._id;this.dispatchEvent(this._eventLoad)}};UIEffect.prototype.gotoAndPlay=function(key){if(this._loadComplete){if(this.animation){if(this.animation.hasAnimation(key)){this.animation.play(key,this.playTimes)}else{this.animation.play()}this.visible=true}else{lz.Log.out(this,this._id)}}else{this._autoPlay=true;this._default=key}};UIEffect.prototype.gotoAndStop=function(key,time){if(time===void 0){time=0}if(this._loadComplete){if(this.animation&&this.animation.hasAnimation(key)){this.animation.gotoAndStopByTime(key,time)}else{this.stop()}}else{this._autoPlay=false;this._default=key}};UIEffect.prototype.stop=function(){if(this.animation){this.animation.stop()}};UIEffect.prototype.show=function(value){if(value===void 0){value="newAnimation"}this.gotoAndPlay(value)};UIEffect.prototype.dispose=function(){RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this);this.removeChildren();if(this._armature){this._armature.dispose();this._armature.removeEventListener(dragonBones.MovieEvent.COMPLETE,this.onComplete,this)}};return UIEffect}(eui.Component);lz.UIEffect=UIEffect;__reflect(UIEffect.prototype,"lz.UIEffect")})(lz||(lz={}));var lz;(function(lz){var UIGridType;(function(UIGridType){UIGridType[UIGridType["Horizontal"]=0]="Horizontal";UIGridType[UIGridType["Vertical"]=1]="Vertical"})(UIGridType=lz.UIGridType||(lz.UIGridType={}));var UIGridEvent=function(_super){__extends(UIGridEvent,_super);function UIGridEvent(type,index,param){if(param===void 0){param=null}var _this=_super.call(this,type)||this;_this.index=index;_this.param=param;return _this}UIGridEvent.ITEM_CLICK="UIGrid_Item_Click";return UIGridEvent}(egret.Event);lz.UIGridEvent=UIGridEvent;__reflect(UIGridEvent.prototype,"lz.UIGridEvent");var UIGrid=function(_super){__extends(UIGrid,_super);function UIGrid(){var _this=_super.call(this)||this;_this._count=5;_this._selectedIndex=-1;_this._widthGap=0;_this._heightGap=0;_this._isForce=false;_this._container=new eui.Group;_this.addChild(_this._container);_this._scroll=new eui.Scroller;_this.type=UIGridType.Vertical;_this.addChild(_this._scroll);_this._scroll.viewport=_this._container;_this.addEventListener(egret.Event.ADDED_TO_STAGE,_this.onAdded,_this);_this.addEventListener(egret.Event.REMOVED_FROM_STAGE,_this.onRemoved,_this);_this._event=new UIGridEvent(UIGridEvent.ITEM_CLICK,0);_this._customPoint=null;return _this}Object.defineProperty(UIGrid.prototype,"scroll",{get:function(){return this._scroll},enumerable:true,configurable:true});Object.defineProperty(UIGrid.prototype,"customArray",{get:function(){return this._customPoint},set:function(a){this._customPoint=a},enumerable:true,configurable:true});UIGrid.prototype.onAdded=function(event){this.removeEventListener(egret.Event.ADDED_TO_STAGE,this.onAdded,this);this._container.width=this.width;this._container.height=this.height;this._scroll.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onItemTouch,this,false,99);this._scroll.width=this.width;this._scroll.height=this.height;this._scroll.bounces=false};UIGrid.prototype.onItemTouch=function(event,item){if(item===void 0){item=null}var target;if(event){event.stopImmediatePropagation();target=event.target}else{target=item}if(egret.is(target,"eui.ItemRenderer")){var r=target;this._event.index=r.itemIndex;this._event.param=r.data;if(this._selectedIndex!=r.itemIndex||this._isForce){this._selectedIndex=r.itemIndex;this.dispatchEvent(this._event)}}if(this._selectedItem&&this._selectedItem["setCurrentState"]){this._selectedItem["setCurrentState"]("normal")}if(target["setCurrentState"]){target["setCurrentState"]("selected")}this._selectedItem=target};UIGrid.prototype.onRemoved=function(event){this._scroll.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onItemTouch,this);this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemoved,this)};Object.defineProperty(UIGrid.prototype,"touchThroughA",{set:function(b){this.touchThrough=b;this._container.touchThrough=b},enumerable:true,configurable:true});Object.defineProperty(UIGrid.prototype,"selectedIndex",{get:function(){return this._selectedIndex},set:function(index){if(this._children&&index!=this.selectedIndex){var l=this._children.length;if(index==-1){this._selectedIndex=-1;if(this._selectedItem&&this._selectedItem["setCurrentState"]){this._selectedItem["setCurrentState"]("normal")}this._selectedItem=null}else if(index>-1&&index<l){var target=this._children[index];this.onItemTouch(null,target)}}},enumerable:true,configurable:true});Object.defineProperty(UIGrid.prototype,"type",{set:function(value){this._type=value;this.reorder()},enumerable:true,configurable:true});Object.defineProperty(UIGrid.prototype,"isForce",{set:function(value){this._isForce=value},enumerable:true,configurable:true});Object.defineProperty(UIGrid.prototype,"heightGap",{get:function(){return this._heightGap},set:function(value){this._heightGap=value;this.reorder()},enumerable:true,configurable:true});Object.defineProperty(UIGrid.prototype,"widthGap",{get:function(){return this._widthGap},set:function(value){this._widthGap=value;this.reorder()},enumerable:true,configurable:true});UIGrid.prototype.getSubChildAt=function(index){return this._children[index]};Object.defineProperty(UIGrid.prototype,"container",{get:function(){return this._container},enumerable:true,configurable:true});Object.defineProperty(UIGrid.prototype,"childrenCount",{get:function(){return this._container.numChildren},enumerable:true,configurable:true});Object.defineProperty(UIGrid.prototype,"lineCount",{set:function(value){this._count=value;this.reorder()},enumerable:true,configurable:true});Object.defineProperty(UIGrid.prototype,"itemRenderer",{set:function(cls){var ins=new cls;if(egret.is(ins,"eui.IItemRenderer")&&ins instanceof egret.DisplayObject){this._itemRenderer=cls}this.bind()},enumerable:true,configurable:true});Object.defineProperty(UIGrid.prototype,"dataProvider",{get:function(){return this._dataProvider},set:function(value){this._dataProvider=value;this.bind()},enumerable:true,configurable:true});Object.defineProperty(UIGrid.prototype,"UIbottom",{get:function(){return this._UIbottom},set:function(r){this._UIbottom=r;this._UIbottom.touchChildren=false;this._UIbottom.touchEnabled=false;this._UIbottom.alpha=0;this.bind()},enumerable:true,configurable:true});UIGrid.prototype.movetoTop=function(){this._scroll.viewport.scrollV=0;this._scroll.viewport.scrollH=0};UIGrid.prototype.reorder=function(){if(this.parent&&this._children){var pos=0,len=this._children.length;for(var i=0;i<len;i++){var c=this._children[i];if(c.visible){this.calcPosition(c,pos);pos++}else{c.x=c.y=0}}}};UIGrid.prototype.bind=function(){if(this.parent){this._container.removeChildren();this._children=[];var y=0;if(this._itemRenderer&&this._dataProvider){var len=this._dataProvider.length;for(var i=0;i<len;i++){var c=new this._itemRenderer;c.itemIndex=i;c.data=this._dataProvider[i];this.calcPosition(c,i);this._container.addChild(c);this._children.push(c);y=c.y+c.height}if(this.UIbottom){this.UIbottom.y=y;this._container.addChild(this.UIbottom)}}}};UIGrid.prototype.calcPosition=function(c,pos){if(this._customPoint==null){if(this._type==UIGridType.Horizontal){c.y=pos%this._count*(c.height+this._heightGap);c.x=Math.floor(pos/this._count)*(c.width+this._widthGap)}else if(this._type==UIGridType.Vertical){c.x=pos%this._count*(c.width+this._widthGap);c.y=Math.floor(pos/this._count)*(c.height+this._heightGap)}}else{c.y=this._customPoint[c.itemIndex][1];c.x=this._customPoint[c.itemIndex][0]}};return UIGrid}(eui.Group);lz.UIGrid=UIGrid;__reflect(UIGrid.prototype,"lz.UIGrid")})(lz||(lz={}));var lz;(function(lz){var UILabelSub=function(){function UILabelSub(){this.color=0;this.size=0;this.context="";this.bold=false;this.href=""}return UILabelSub}();lz.UILabelSub=UILabelSub;__reflect(UILabelSub.prototype,"lz.UILabelSub");var UILabelEvent=function(_super){__extends(UILabelEvent,_super);function UILabelEvent(type,text){var _this=_super.call(this,type)||this;_this.text=text;return _this}UILabelEvent.LINK="UILabel_Link";return UILabelEvent}(egret.Event);lz.UILabelEvent=UILabelEvent;__reflect(UILabelEvent.prototype,"lz.UILabelEvent");var UILabel=function(_super){__extends(UILabel,_super);function UILabel(){var _this=_super.call(this)||this;_this.addEventListener(egret.TextEvent.LINK,_this.onLink,_this);return _this}UILabel.prototype.onLink=function(event){this.dispatchEvent(new UILabelEvent(UILabelEvent.LINK,event.text))};UILabel.prototype.typeText=function(delta){this._tempText=this.text;this.text="";this._pos=0;egret.clearInterval(this._clock);this._clock=egret.setInterval(this.typeMe,this,delta)};UILabel.prototype.typeMe=function(){this._pos++;if(this._pos<=this._tempText.length){this.text=this._tempText.substring(0,this._pos)}else{egret.clearInterval(this._clock)}};Object.defineProperty(UILabel.prototype,"htmlText",{get:function(){return this._htmlText},set:function(value){this._htmlText=value;var defaultColor=this.textColor;var defaultSize=this.size;var defaultBold=this.bold;var currentColor=[defaultColor];var currentSize=[defaultSize];var currentBold=[defaultBold];var currentUrl=[];var temp="";var i=0;var a=[];while(i<value.length){var c=value.substr(i,1);if(c=="["){if(temp.length>0){var sub=new UILabelSub;sub.color=currentColor[currentColor.length-1];sub.size=currentSize[currentSize.length-1];sub.bold=currentBold[currentBold.length-1];sub.context=temp;sub.href=currentUrl[currentUrl.length-1];temp="";a.push(sub)}var end=value.indexOf("]",i);if(end==-1)return;var s=value.substring(i+1,end);s=s.replace(/\s{1,}/g," ");s=s.replace(/ = /g,"=");s=s.replace(/= /g,"=");s=s.replace(/ =/g,"=");i=end+1;var as=s.split(" ");if(as.length>0){if(as[0].length>0){if(as[0].substr(0,1)=="/"){if(currentColor.length>1){currentColor.pop()}if(currentSize.length>1){currentSize.pop()}if(currentBold.length>1){currentBold.pop()}}else{for(var j=1;j<as.length;j++){var ass=as[j].split("=");if(ass.length==2){if(ass[0].toLowerCase()=="size"){currentSize.push(parseInt(ass[1].replace(/"/g,"").replace(/'/g,"")))}else if(ass[0].toLowerCase()=="color"){currentColor.push(parseInt(ass[1].replace(/"/g,"").replace(/'/g,"")))}else if(ass[0].toLowerCase()=="bold"){currentBold.push(ass[1].replace(/"/g,"").replace(/'/g,"")=="true")}else if(ass[0].toLowerCase()=="href"){currentUrl.push(ass[1].replace(/"/g,"").replace(/'/g,""))}}}}}}else{return}}else{temp+=value.substr(i,1);i++}}if(temp.length>0){var sub=new UILabelSub;sub.color=currentColor[currentColor.length-1];sub.size=currentSize[currentSize.length-1];sub.bold=currentBold[currentBold.length-1];sub.context=temp;sub.href=currentUrl[currentUrl.length-1];temp="";a.push(sub)}this.text="";this._textArray=[];for(var k=0;k<a.length;k++){var so={textColor:a[k].color,size:a[k].size,bold:a[k].bold};if(a[k].href!=""){so.href=a[k].href}var o={text:a[k].context,style:so};this._textArray.push(o)}this.textFlow=this._textArray},enumerable:true,configurable:true});UILabel.prototype.addRichText=function(conent,color,size,bold){if(color===void 0){color=0}if(size===void 0){size=20}if(bold===void 0){bold=false}this._textArray.push({text:conent,style:{textColor:color,size:size,bold:bold}});this.textFlow=this._textArray};UILabel.prototype.clearRichText=function(){this._textArray=[];this.textFlow=this._textArray};return UILabel}(eui.Label);lz.UILabel=UILabel;__reflect(UILabel.prototype,"lz.UILabel")})(lz||(lz={}));var lz;(function(lz){var UIListEvent=function(_super){__extends(UIListEvent,_super);function UIListEvent(type,index,param){if(param===void 0){param=null}var _this=_super.call(this,type)||this;_this.index=index;_this.param=param;return _this}UIListEvent.ITEM_SELECTED="UIList_Item_Selected";return UIListEvent}(egret.Event);lz.UIListEvent=UIListEvent;__reflect(UIListEvent.prototype,"lz.UIListEvent");var UIListDirection;(function(UIListDirection){UIListDirection[UIListDirection["Horizontal"]=0]="Horizontal";UIListDirection[UIListDirection["Vertical"]=1]="Vertical"})(UIListDirection=lz.UIListDirection||(lz.UIListDirection={}));var UIList=function(_super){__extends(UIList,_super);function UIList(){var _this=_super.call(this)||this;_this._widthGap=0;_this._heightGap=0;_this._container=new eui.Group;_this._container.name="container";_this._event=new UIListEvent(UIListEvent.ITEM_SELECTED,0);_this._scroll=new eui.Scroller;_this._scroll.scrollPolicyH=eui.ScrollPolicy.OFF;_this.addChild(_this._scroll);_this.addEventListener(egret.Event.ADDED_TO_STAGE,_this.onAdded,_this);_this.addEventListener(egret.Event.REMOVED_FROM_STAGE,_this.onRemoved,_this);_this.direction=UIListDirection.Vertical;return _this}Object.defineProperty(UIList.prototype,"scroll",{get:function(){return this._scroll},enumerable:true,configurable:true});Object.defineProperty(UIList.prototype,"children",{get:function(){return this._children},enumerable:true,configurable:true});Object.defineProperty(UIList.prototype,"direction",{get:function(){return this._direction},set:function(value){this._direction=value;if(this._direction==UIListDirection.Vertical){this._scroll.scrollPolicyH=eui.ScrollPolicy.OFF;this._scroll.scrollPolicyV=eui.ScrollPolicy.AUTO}else if(this._direction==UIListDirection.Horizontal){this._scroll.scrollPolicyH=eui.ScrollPolicy.AUTO;this._scroll.scrollPolicyV=eui.ScrollPolicy.OFF}},enumerable:true,configurable:true});Object.defineProperty(UIList.prototype,"heightGap",{get:function(){return this._heightGap},set:function(value){this._heightGap=value;this.bind()},enumerable:true,configurable:true});Object.defineProperty(UIList.prototype,"widthGap",{get:function(){return this._widthGap},set:function(value){this._widthGap=value;this.bind()},enumerable:true,configurable:true});UIList.prototype.onAdded=function(event){this.removeEventListener(egret.Event.ADDED_TO_STAGE,this.onAdded,this);this._scroll.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onItemTouch,this);this._scroll.width=this.width;this._scroll.height=this.height;this._scroll.viewport=this._container};Object.defineProperty(UIList.prototype,"UIbottom",{get:function(){return this._UIbottom},set:function(r){this._UIbottom=r;this._UIbottom.touchChildren=false;this._UIbottom.touchEnabled=false;this._UIbottom.alpha=0;this.bind()},enumerable:true,configurable:true});UIList.prototype.onItemTouch=function(event){if(egret.is(event.target,"eui.ItemRenderer")){var r=event.target;this._event.index=r.itemIndex;this._event.param=r.data;this.dispatchEvent(this._event)}if(egret.is(event.target,"BaseRenderView")){var len=this._children.length;for(var i=0;i<len;i++){var b=this._children[i];if(this._children[i]==event.target){if(b["setCurrentState"])b["setCurrentState"]("selected")}else{if(b["setCurrentState"])b["setCurrentState"]("normal")}}}};UIList.prototype.onRemoved=function(event){this._scroll.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onItemTouch,this);this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemoved,this)};Object.defineProperty(UIList.prototype,"itemRenderer",{set:function(cls){var ins=new cls;if(egret.is(ins,"eui.IItemRenderer")&&ins instanceof egret.DisplayObject){this._itemRenderer=cls}this.bind()},enumerable:true,configurable:true});Object.defineProperty(UIList.prototype,"dataProvider",{get:function(){return this._dataProvider},set:function(value){this._dataProvider=value;this.bind()},enumerable:true,configurable:true});UIList.prototype.movetoTop=function(){this._scroll.stopAnimation();this._scroll.viewport.scrollV=0;this._scroll.viewport.scrollH=0};UIList.prototype.moveto=function(v,h){if(v===void 0){v=0}if(h===void 0){h=0}this._scroll.stopAnimation();this._scroll.viewport.scrollV=v;this._scroll.viewport.scrollH=h};UIList.prototype.bind=function(){if(this.parent){this._container.removeChildren();this._children=[];var y=0;if(this._itemRenderer&&this._dataProvider){var len=this._dataProvider.length;for(var i=0;i<len;i++){var c=new this._itemRenderer;c.itemIndex=i;c.data=this._dataProvider[i];if(this.direction==UIListDirection.Vertical){c.x=0;c.y=i*(c.height+this._heightGap);y=c.y+c.height}else if(this.direction==UIListDirection.Horizontal){c.x=i*(c.width+this._widthGap);c.y=0}this._container.addChild(c);this._children.push(c)}if(this.UIbottom&&this.direction==UIListDirection.Vertical){this.UIbottom.y=y;this._container.addChild(this.UIbottom)}}}};return UIList}(eui.Group);lz.UIList=UIList;__reflect(UIList.prototype,"lz.UIList")})(lz||(lz={}));var lz;(function(lz){var UIParticle=function(_super){__extends(UIParticle,_super);function UIParticle(){var _this=_super.call(this)||this;_this.deleted=false;_this._textTure="";_this._delta=0;_this._stopBackFunc=null;_this.addEventListener(egret.Event.REMOVED_FROM_STAGE,_this.onRemoved,_this);return _this}Object.defineProperty(UIParticle.prototype,"textTure",{set:function(value){this._textTure=value+"_png";this.replaceTexture(value+"_png")},enumerable:true,configurable:true});Object.defineProperty(UIParticle.prototype,"particle",{get:function(){return this._id},set:function(value){this.play(value)},enumerable:true,configurable:true});UIParticle.prototype.onRemoved=function(event){if(this._sys)this._sys.stop();lz.UpdateManager.delUpdateable(this);this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemoved,this)};UIParticle.prototype.update=function(delta){if(this._delta>=this._duration&&this._duration>0){if(this._sys){this._sys.stop()}this._duration=0}else if(this._delta>=this._lifeSpan){lz.UpdateManager.delUpdateable(this);this._delta=0;if(this._stopBackFunc){this._stopBackFunc()}}this._delta+=delta};Object.defineProperty(UIParticle.prototype,"stopBackFunc",{set:function(value){this._stopBackFunc=value},enumerable:true,configurable:true});Object.defineProperty(UIParticle.prototype,"sys",{get:function(){return this._sys},enumerable:true,configurable:true});UIParticle.prototype.replaceTexture=function(replaceTexture){var _this=this;this._replaceTexture=replaceTexture;if(!this.sys){return}if(egret.is(replaceTexture,"egret.Texture")){this._sys.changeTexture(replaceTexture)}else if(replaceTexture&&typeof replaceTexture=="string"){RES.getResAsync(replaceTexture,function(data){if(!egret.is(data,"egret.Texture")){return}_this._sys.changeTexture(data)},this)}};UIParticle.prototype.play=function(id,replaceTexture){if((!id||!id.length)&&!this.sys){lz.Log.out(this,id+" is undefind ");return}if(replaceTexture){this.replaceTexture(replaceTexture)}if(this.sys){this.showParticle()}else{this.removeChildren();this._id=id;if(this._replaceTexture&&egret.is(this._replaceTexture,"egret.Texture")){var groupName="p_Config"+id;RES.createGroup(groupName,[id+"_json"]);RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this);RES.loadGroup(groupName)}else{this._replaceTexture=this._replaceTexture?this._replaceTexture:id+"_png";var groupName="p"+id+this._replaceTexture;RES.createGroup(groupName,[this._replaceTexture,id+"_json"]);RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this);RES.loadGroup(groupName)}}};UIParticle.prototype.onResourceLoadComplete=function(event){if(event.groupName=="p"+this._id+this._replaceTexture||event.groupName=="p_Config"+this._id){RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this);this.removeChildren();if(this._replaceTexture&&typeof this._replaceTexture=="string"){this._replaceTexture=RES.getRes(this._replaceTexture)}this._config=RES.getRes(this._id+"_json");this._sys=new particle.GravityParticleSystem(this._replaceTexture,this._config);this.showParticle()}};UIParticle.prototype.showParticle=function(){if(this.sys&&this._config){if(this._config.duration>0&&this._config.duration+this._config.lifespan>0){this._duration=this._config.duration;this._lifeSpan=this._config.duration+this._config.lifespan;lz.UpdateManager.addUpdateable(this)}this.addChild(this._sys);this._sys.start()}else{lz.Log.out(this,"error-----\x3e sys config")}};return UIParticle}(eui.Component);lz.UIParticle=UIParticle;__reflect(UIParticle.prototype,"lz.UIParticle",["lz.IUpdateable"])})(lz||(lz={}));var lz;(function(lz){var UIProgressBar=function(_super){__extends(UIProgressBar,_super);function UIProgressBar(barBg,barThumb){var _this=_super.call(this)||this;_this._value=0;_this._minimum=0;_this._maxmum=100;_this._bgGrid=new egret.Rectangle(16,13,8,4);_this._thumbGrid=new egret.Rectangle(18,13,5,3);_this._bgImg=new eui.Image;_this._bgImg.source=barBg;lz.DisplayUtils.doFullScreen(_this._bgImg);_this._bgImg.scale9Grid=_this._bgGrid;_this._thumb=new eui.Image;_this._thumb.scale9Grid=_this._thumbGrid;_this._thumb.source=barThumb;_this._thumb.top=0;_this._thumb.bottom=0;_this._thumb.left=0;_this.addChild(_this._bgImg);_this.addChild(_this._thumb);return _this}UIProgressBar.prototype.showLable=function(){this._label=new eui.Label;this._label.textAlign=egret.HorizontalAlign.CENTER;this._label.verticalAlign=egret.VerticalAlign.MIDDLE;this._label.size=15;this._label.fontFamily=lz.GameGlobal.fontFamily;this._label.verticalAlign="0";this._label.horizontalCenter="0";this._label.visible=true;this.addChild(this._label)};Object.defineProperty(UIProgressBar.prototype,"value",{get:function(){return this._value},set:function(v){if(this._value>this.maxmum){this._value=this.maxmum}else if(this._value<this.minimum){this._value=this.minimum}else{this._value=v}if(this._label){this._label.text=this._value+""}this.thumb.width=this.value/100*this.width},enumerable:true,configurable:true});Object.defineProperty(UIProgressBar.prototype,"bgGrid",{get:function(){return this._bgGrid},set:function(v){this._bgGrid=v;this._bgImg.scale9Grid=v},enumerable:true,configurable:true});Object.defineProperty(UIProgressBar.prototype,"thumbGrid",{get:function(){return this._thumbGrid},set:function(v){this._thumbGrid=v;this._thumb.scale9Grid=v},enumerable:true,configurable:true});Object.defineProperty(UIProgressBar.prototype,"maxmum",{get:function(){return this._maxmum},set:function(v){this._maxmum=v},enumerable:true,configurable:true});Object.defineProperty(UIProgressBar.prototype,"minimum",{get:function(){return this._minimum},set:function(v){this._minimum=v},enumerable:true,configurable:true});Object.defineProperty(UIProgressBar.prototype,"bgImg",{get:function(){return this._bgImg},set:function(v){this._bgImg=v},enumerable:true,configurable:true});Object.defineProperty(UIProgressBar.prototype,"thumb",{get:function(){return this._thumb},set:function(v){this._thumb=v},enumerable:true,configurable:true});Object.defineProperty(UIProgressBar.prototype,"label",{get:function(){return this._label},set:function(v){this._label=v},enumerable:true,configurable:true});return UIProgressBar}(eui.Group);lz.UIProgressBar=UIProgressBar;__reflect(UIProgressBar.prototype,"lz.UIProgressBar")})(lz||(lz={}));var lz;(function(lz){var UIRocker=function(_super){__extends(UIRocker,_super);function UIRocker(range,bg,ball,rangeAlpha){if(rangeAlpha===void 0){rangeAlpha=0}var _this=_super.call(this)||this;_this._isFollow=true;_this._isAlwayShow=false;_this._bgImg=new eui.Image;_this._ball=new eui.Image;_this._sp=new egret.Sprite;_this._radius=110;_this._ballRadius=30;_this._centerP=new egret.Point;_this._movePoint=new egret.Point;_this._range=range;_this.initUI(bg,ball,rangeAlpha);return _this}UIRocker.prototype.initUI=function(bg,ball,rangeAlpha){if(rangeAlpha===void 0){rangeAlpha=0}return __awaiter(this,void 0,void 0,function(){var _a,shape,rt,_b,shape1,rt1;return __generator(this,function(_c){switch(_c.label){case 0:this._rect=new eui.Rect(this._range.width,this._range.height);this._rect.alpha=rangeAlpha;this._rect.x=this._range.x;this._rect.y=this._range.y;this.addChild(this._rect);if(!bg)return[3,2];_a=this._bgImg;return[4,RES.getResAsync(bg)];case 1:_a.texture=_c.sent();return[3,3];case 2:shape=new egret.Shape;shape.graphics.clear();shape.graphics.beginFill(16777215,.5);shape.graphics.drawCircle(0,0,this._radius);shape.graphics.endFill();rt=new egret.RenderTexture;rt.drawToTexture(shape,new egret.Rectangle(-this._radius,-this._radius,2*this._radius,2*this._radius));this._bgImg.texture=rt;_c.label=3;case 3:this._radius=this._bgImg.width>>1;this._bgImg.anchorOffsetX=this._radius;this._bgImg.anchorOffsetY=this._radius;if(!ball)return[3,5];_b=this._ball;return[4,RES.getResAsync(ball)];case 4:_b.texture=_c.sent();return[3,6];case 5:shape1=new egret.Shape;shape1.graphics.clear();shape1.graphics.beginFill(0,.5);shape1.graphics.drawCircle(0,0,this._ballRadius);shape1.graphics.endFill();rt1=new egret.RenderTexture;rt1.drawToTexture(shape1,new egret.Rectangle(-this._ballRadius,-this._ballRadius,2*this._ballRadius,2*this._ballRadius));this._ball.texture=rt1;_c.label=6;case 6:this._ballRadius=this._ball.width>>1;this._ball.anchorOffsetX=this._ball.anchorOffsetY=this._ballRadius;this._sp.addChild(this._bgImg);this._sp.addChild(this._ball);if(!this._restPoint){this._restPoint=new egret.Point(this._range.x+this._range.width*.5,this._range.y+this._range.height*.5)}this._sp.touchEnabled=this._sp.touchChildren=false;return[2]}})})};UIRocker.prototype.touchBeginHandler=function(evt){if(UIRocker._touchId!=-1){return}this._sp.x=evt.stageX-lz.GameGlobal.offsetX;this._sp.y=evt.stageY-lz.GameGlobal.offsetY;this._centerP.x=this._sp.x;this._centerP.y=this._sp.y;this.show();UIRocker._touchId=evt.touchPointID;this._rect.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.touchBeginHandler,this);this.touchMoveHandler(evt);lz.GameGlobal.baseLayer.stage.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.touchMoveHandler,this);lz.GameGlobal.baseLayer.stage.addEventListener(egret.TouchEvent.TOUCH_CANCEL,this.cancelHandler,this);lz.GameGlobal.baseLayer.stage.addEventListener(egret.TouchEvent.TOUCH_END,this.cancelHandler,this)};UIRocker.prototype.touchMoveHandler=function(evt){if(UIRocker._touchId!=evt.touchPointID){return}var tx=evt.stageX-lz.GameGlobal.offsetX;var ty=evt.stageY-lz.GameGlobal.offsetY;var bx;var by;this._movePoint.x=tx;this._movePoint.y=ty;var dist=egret.Point.distance(this._centerP,this._movePoint);if(dist<UIRocker.tolerance){return}UIRocker.isCanMove=true;UIRocker.angle=Math.atan2(ty-this._centerP.y,tx-this._centerP.x);if(dist>=this._radius){var mx=Math.cos(UIRocker.angle)*this._radius;var my=Math.sin(UIRocker.angle)*this._radius;if(this.isFollow){this._centerP.x=this._sp.x=tx-mx;this._centerP.y=this._sp.y=ty-my}else{bx=mx;by=my}}this._ball.x=bx?bx:tx-this._centerP.x;this._ball.y=by?by:ty-this._centerP.y};UIRocker.prototype.cancelHandler=function(evt){if(UIRocker._touchId==evt.touchPointID){UIRocker.isCanMove=false;this.hide();this._rect.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.touchBeginHandler,this);lz.GameGlobal.baseLayer.stage.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.touchMoveHandler,this);lz.GameGlobal.baseLayer.stage.removeEventListener(egret.TouchEvent.TOUCH_CANCEL,this.cancelHandler,this);lz.GameGlobal.baseLayer.stage.removeEventListener(egret.TouchEvent.TOUCH_END,this.cancelHandler,this);UIRocker.angle=0}};UIRocker.prototype.show=function(){!this._sp.parent&&this.addChild(this._sp)};UIRocker.prototype.hide=function(){UIRocker._touchId=-1;this._ball.x=0;this._ball.y=0;if(!this.isAlwayShow){this._sp.parent&&this._sp.parent.removeChild(this._sp)}else{this._sp.x=this._restPoint.x;this._sp.y=this._restPoint.y}};UIRocker.prototype.start=function(){if(this.isAlwayShow){this.show()}this._rect.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.touchBeginHandler,this)};UIRocker.prototype.stop=function(){this._rect.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.touchBeginHandler,this);lz.GameGlobal.baseLayer.stage.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.touchMoveHandler,this);lz.GameGlobal.baseLayer.stage.removeEventListener(egret.TouchEvent.TOUCH_CANCEL,this.cancelHandler,this);lz.GameGlobal.baseLayer.stage.removeEventListener(egret.TouchEvent.TOUCH_END,this.cancelHandler,this)};UIRocker.prototype.onAdded=function(event){_super.prototype.onAdded.call(this,event);this.start()};UIRocker.prototype.onRemoved=function(event){_super.prototype.onRemoved.call(this,event);this.stop()};Object.defineProperty(UIRocker.prototype,"startPoint",{set:function(p){this._restPoint=p;this._sp.x=this._restPoint.x;this._sp.y=this._restPoint.y},enumerable:true,configurable:true});Object.defineProperty(UIRocker,"touchId",{get:function(){return this._touchId},enumerable:true,configurable:true});Object.defineProperty(UIRocker,"angle",{get:function(){return this._angle},set:function(v){this._angle=v},enumerable:true,configurable:true});Object.defineProperty(UIRocker.prototype,"isFollow",{get:function(){return this._isFollow},enumerable:true,configurable:true});Object.defineProperty(UIRocker.prototype,"isisFollowfllow",{set:function(v){this._isFollow=v},enumerable:true,configurable:true});Object.defineProperty(UIRocker.prototype,"isAlwayShow",{get:function(){return this._isAlwayShow},set:function(v){this._isAlwayShow=v},enumerable:true,configurable:true});UIRocker._touchId=-1;UIRocker._angle=0;UIRocker.isCanMove=false;UIRocker.tolerance=20;return UIRocker}(lz.BaseView);lz.UIRocker=UIRocker;__reflect(UIRocker.prototype,"lz.UIRocker")})(lz||(lz={}));var lz;(function(lz){var ArrayUtil=function(){function ArrayUtil(){}ArrayUtil.randomOne=function(arr){var r=Math.random();var index=Math.floor(r*arr.length);return arr[index]};ArrayUtil.randomCount=function(arr,count){if(count===void 0){count=1}var a=arr.concat();if(count<a.length){var b=[];for(var i=0;i<count;i++){var r=Math.random();var index=Math.floor(r*a.length);b.push(a[index]);a.splice(index,1)}return b}return a};ArrayUtil.sortOn=function(arr,keyList,sortarr){if(sortarr===void 0){sortarr=null}arr.sort(this.sortMoreFun(keyList,sortarr))};ArrayUtil.sortMoreFun=function(keyList,sortarr){if(sortarr===void 0){sortarr=null}return function(obj1,obj2){var valarr=[];var sorlen=0;if(sortarr)sorlen=sortarr.length;var chanum;for(var b in keyList){var c=parseInt(b);chanum=+obj1[keyList[b]]-+obj2[keyList[b]];if(chanum==0){continue}else{if(sorlen>c&&sortarr[b]==0){return chanum}else{return sortarr[b]*chanum}}}return 0}};return ArrayUtil}();lz.ArrayUtil=ArrayUtil;__reflect(ArrayUtil.prototype,"lz.ArrayUtil")})(lz||(lz={}));var lz;(function(lz){var BaseUnitTools=function(){function BaseUnitTools(){}BaseUnitTools.createLabel=function(pComp,txt,pX,pY,dW,dH,textAlign,size,textColor,font){if(pX===void 0){pX=0}if(pY===void 0){pY=0}if(dW===void 0){dW=0}if(dH===void 0){dH=0}if(textAlign===void 0){textAlign="left"}if(size===void 0){size=20}if(textColor===void 0){textColor=16777215}if(font===void 0){font="SimHei"}var lab=new eui.Label;lab.text=txt;lab.textAlign=textAlign;lab.fontFamily=font;lab.size=size;lab.textColor=textColor;if(dW>0){lab.width=dW}if(dH>0){lab.height=dH}lab.x=pX;lab.y=pY;if(pComp){pComp.addChild(lab)}return lab};BaseUnitTools.createButton=function(pComp,pX,pY,dW,dH){if(pX===void 0){pX=0}if(pY===void 0){pY=0}if(dW===void 0){dW=0}if(dH===void 0){dH=0}var uiButton=new lz.UIButton;if(dW>0){uiButton.width=dW}if(dH>0){uiButton.height=dH}uiButton.x=pX;uiButton.y=pY;if(pComp){pComp.addChild(uiButton)}return uiButton};BaseUnitTools.createImage=function(pComp,res,pX,pY,dW,dH,scale9Grid){if(pX===void 0){pX=0}if(pY===void 0){pY=0}if(dW===void 0){dW=0}if(dH===void 0){dH=0}if(scale9Grid===void 0){scale9Grid=null}var img=new eui.Image;img.x=pX;img.y=pY;if(pComp){pComp.addChild(img)}img.source=res;if(dW>0){img.width=dW}if(dH>0){img.height=dH}if(scale9Grid){img.scale9Grid=scale9Grid}return img};BaseUnitTools.crateUiGrid=function(pComp,pX,pY,dW,dH,wGap,hGap,lineCount,isForce){if(isForce===void 0){isForce=true}var uiGrid=new lz.UIGrid;uiGrid.x=pX;uiGrid.y=pY;uiGrid.width=dW;uiGrid.height=dH;uiGrid.widthGap=wGap;uiGrid.heightGap=hGap;uiGrid.lineCount=lineCount;uiGrid.isForce=isForce;if(pComp){pComp.addChild(uiGrid)}return uiGrid};return BaseUnitTools}();lz.BaseUnitTools=BaseUnitTools;__reflect(BaseUnitTools.prototype,"lz.BaseUnitTools")})(lz||(lz={}));var lz;(function(lz){var ClassUtil=function(){function ClassUtil(){}ClassUtil.is=function(myClass,baseClass){var s="";var t=myClass;var m=egret.getQualifiedClassName(t);if(m==baseClass){return true}while(t!=null){if(m==baseClass)return true;m=egret.getQualifiedSuperclassName(t);t=egret.getDefinitionByName(m)}return false};return ClassUtil}();lz.ClassUtil=ClassUtil;__reflect(ClassUtil.prototype,"lz.ClassUtil")})(lz||(lz={}));var lz;(function(lz){var CoinsEmitter=function(){function CoinsEmitter(){}CoinsEmitter.StartShoot=function(parent,num,start,end,postion){if(end===void 0){end=null}if(postion===void 0){postion=1}this.count=0;CoinsEmitter.startLocation=start;if(end!=null){CoinsEmitter.endLocation=end}else{CoinsEmitter.endLocation=new egret.Point(50,20)}var $maxX=0;var $maxY=0;var $minX=0;var $minY=0;if(start.x<CoinsEmitter.endLocation.x){$maxX=CoinsEmitter.endLocation.x;$minX=start.x}else{$minX=CoinsEmitter.endLocation.x;$maxX=start.x}if(start.y<CoinsEmitter.endLocation.y){$maxY=CoinsEmitter.endLocation.y;$minY=start.y}else{$minY=CoinsEmitter.endLocation.y;$maxY=start.y}for(var i=0;i<this.dirList[postion].length;i++){var $node=new egret.Point;switch(this.dirList[postion][i]){case 0:$node.x=$maxX;$node.y=$maxY-($maxX-$minX)/4;break;case 1:$node.x=$minX;$node.y=($maxX-$minX)/4+$minY;break;case 2:$node.x=$minX;$node.y=(15*$maxY+16*$minY)/16;break;case 3:$node.x=$maxX;$node.y=($maxY+15*$minY)/16;break;default:$node.x=$minX;$node.y=(15*$maxY+16*$minY)/16;break}this.posList.push($node)}CoinsEmitter.num=num;if(num<20){num=20}else if(num>50){num=50}for(var i=0;i<num;i+=1){egret.setTimeout(function(){var mDot=CoinsEmitter.getTexture();parent.addChild(mDot);CoinsEmitter._tweenDot(mDot,0)},this,CoinsEmitter._getRandom(0,1)*200)}};CoinsEmitter._tweenDot=function(dot,dt){var $note=this.getNote()};CoinsEmitter.getTexture=function(){var num=Math.round(CoinsEmitter._getRandom(1,4));var mCoin=new eui.Image("coin_png");var $scale=CoinsEmitter._getRandom(.2,.5);var $myMatrix=new egret.Matrix($scale,CoinsEmitter._getRandom(-Math.PI/9,Math.PI/9),CoinsEmitter._getRandom(-Math.PI/10,Math.PI/10),$scale,CoinsEmitter.startLocation.x+CoinsEmitter._getRandom(-50,50),CoinsEmitter.startLocation.y+CoinsEmitter._getRandom(-50,50));mCoin.matrix=$myMatrix;mCoin.alpha=CoinsEmitter._getRandom(5,10)/10;return mCoin};CoinsEmitter.getNote=function(){var p=new egret.Point;var index=Math.random()>.5?1:0;CoinsEmitter.nodeLocation=this.posList[index];p.x=CoinsEmitter.nodeLocation.x+CoinsEmitter._getRandom(-CoinsEmitter.num*2.5,CoinsEmitter.num*2.5);p.y=CoinsEmitter.nodeLocation.y+CoinsEmitter._getRandom(-CoinsEmitter.num*2.5,CoinsEmitter.num*2.5);return p};CoinsEmitter._getRandom=function(min,max){return min+Math.random()*(max-min)};CoinsEmitter.count=0;CoinsEmitter.postion=1;CoinsEmitter.posList=[];CoinsEmitter.dirList=[[0,1],[2,3]];return CoinsEmitter}();lz.CoinsEmitter=CoinsEmitter;__reflect(CoinsEmitter.prototype,"lz.CoinsEmitter")})(lz||(lz={}));var DateUtil=function(){function DateUtil(){}DateUtil.getTodayZero=function(t){var tt=t+this.timeZone*60*60;return t-tt%(60*60*24)};DateUtil.getTodayDate=function(t){var d=t?new Date(t*1e3):new Date;return d.getDate()};DateUtil.getTimeStamp=function(){return(new Date).getTime()};DateUtil.timeZone=+8;return DateUtil}();__reflect(DateUtil.prototype,"DateUtil");var lz;(function(lz){var DisplayUtils=function(){function DisplayUtils(){}DisplayUtils.setGray=function(display){display.filters=[new egret.ColorMatrixFilter([.3,.6,0,0,0,.3,.6,0,0,0,.3,.6,0,0,0,0,0,0,1,0])]};DisplayUtils.setContrast=function(display,n){if(n===void 0){n=1}display.filters=[this.createContrastFilter(n)]};DisplayUtils.createContrastFilter=function(n){return new egret.ColorMatrixFilter([n,0,0,0,128*(1-n),0,n,0,0,128*(1-n),0,0,n,0,128*(1-n),0,0,0,1,0])};DisplayUtils.center=function(display){display.x=(lz.GameGlobal.screenWidth-display.width)/2;display.y=(lz.GameGlobal.screenHeight-display.height)/2};DisplayUtils.createRect=function(x,y,size,radius,color,alpha,hSize){if(alpha===void 0){alpha=1}if(hSize===void 0){hSize=-1}if(hSize==-1){hSize=size}var rect=new eui.Rect(size,hSize,color);rect.x=x;rect.y=y;rect.alpha=alpha;rect.ellipseWidth=radius;rect.ellipseHeight=radius;return rect};DisplayUtils.setBitmapDataAsHeadCir=function(name,texture,isDestroy){if(isDestroy===void 0){isDestroy=true}if(this._bitDic[name]){return this._bitDic[name]}var _fogLayer=new egret.DisplayObjectContainer;var _fogLayerShape=new egret.Shape;var _con=new egret.DisplayObjectContainer;var bit=new egret.Bitmap(texture);_con.addChild(bit);_con.addChild(_fogLayerShape);var renderTexture=new egret.RenderTexture;_fogLayerShape.graphics.beginFill(0,1);_fogLayerShape.graphics.drawCircle(texture.bitmapData.width/2,texture.bitmapData.height/2,texture.bitmapData.width/2);_fogLayerShape.graphics.endFill();bit.mask=_fogLayerShape;renderTexture.drawToTexture(_con);if(isDestroy){texture.bitmapData.$dispose()}this._bitDic[name]=renderTexture;return renderTexture};DisplayUtils.setAnchorByType=function(display,anchorType,w,h){if(w===void 0){w=-1}if(h===void 0){h=-1}w=w>0?w:display.width;h=h>0?h:display.height;switch(anchorType){case 1:display.anchorOffsetX=0;display.anchorOffsetY=h;break;case 2:display.anchorOffsetX=w>>1;display.anchorOffsetY=h;break;case 3:display.anchorOffsetX=w;display.anchorOffsetY=h;break;case 4:display.anchorOffsetX=0;display.anchorOffsetY=h>>1;break;case 5:display.anchorOffsetX=w>>1;display.anchorOffsetY=h>>1;break;case 6:display.anchorOffsetX=w;display.anchorOffsetY=h>>1;break;case 7:display.anchorOffsetX=0;display.anchorOffsetY=0;break;case 8:display.anchorOffsetX=w>>1;display.anchorOffsetY=0;break;case 9:display.anchorOffsetX=w;display.anchorOffsetY=0;break}};DisplayUtils.getVertexList=function(vlist,rotation){var list=[];for(var i=0;i<vlist.length;i++){list.push(lz.MathUtil.getNewPoint(vlist[i],rotation))}return list};DisplayUtils.doFullScreen=function(display){if(display){display.top=0;display.left=0;display.right=0;display.bottom=0}};DisplayUtils._bitDic={};return DisplayUtils}();lz.DisplayUtils=DisplayUtils;__reflect(DisplayUtils.prototype,"lz.DisplayUtils")})(lz||(lz={}));var lz;(function(lz){var HitTestUtil=function(){function HitTestUtil(){}HitTestUtil.polygonTest=function(ploy1,ploy2){return SAT.sat(ploy1.getPos(),ploy2.getPos(),ploy1.getCollisionPoly(),ploy2.getCollisionPoly(),ploy1.isCircle(),ploy2.isCircle())};HitTestUtil.rectTest=function(obj1,obj2,isToGlobal,hitRect1,hitRect2,isShowRect){if(isToGlobal===void 0){isToGlobal=false}if(hitRect1===void 0){hitRect1=null}if(hitRect2===void 0){hitRect2=null}if(isShowRect===void 0){isShowRect=false}if(!obj1||!obj2||!obj2.parent||!obj1.parent){lz.Log.out(this,"error");return}if(hitRect1){this.aRect=hitRect1}else{this.aRect=obj1.getBounds(this.aRect);this.aRect.x=this.aRect.y=0}if(hitRect2){this.bRect=hitRect2}else{this.bRect=obj2.getBounds(this.bRect);this.bRect.x=this.bRect.y=0}if(isShowRect){if(!obj1["ove"]){obj1["ove"]=true;var p=new egret.Shape;p.graphics.beginFill(16711680);p.graphics.drawRect(this.aRect.x,this.aRect.y,this.aRect.width,this.aRect.height);p.graphics.endFill();p.alpha=.3;obj1.addChild(p)}if(!obj2["ove"]){obj2["ove"]=true;var p=new egret.Shape;p.graphics.beginFill(16711680);p.graphics.drawRect(this.bRect.x,this.bRect.y,this.bRect.width,this.bRect.height);p.graphics.endFill();p.alpha=.3;obj2.addChild(p)}}var p1;var p2;if(isToGlobal){p1=obj1.parent.localToGlobal(obj1.x,obj1.y);p2=obj2.parent.localToGlobal(obj2.x,obj2.y)}else{p1=new egret.Point(obj1.x,obj1.y);p2=new egret.Point(obj2.x,obj2.y)}this.aRect.x=p1.x-obj1.anchorOffsetX+this.aRect.x;this.aRect.y=p1.y-obj1.anchorOffsetY+this.aRect.y;this.bRect.x=p2.x-obj2.anchorOffsetX+this.bRect.x;this.bRect.y=p2.y-obj2.anchorOffsetY+this.bRect.y;var b=this.aRect.intersects(this.bRect);if(b){}return b};HitTestUtil.getPointByType=function(p1,r,type){var p=new egret.Point;switch(type){case 1:p.x=p1.x;p.y=p1.y-r.height;break;case 2:p.x=p1.x-r.width*.5;p.y=p1.y-r.height;break;case 7:p.x=p1.x;p.y=p1.y;break;case 5:p.x=p1.x-r.width*.5;p.y=p1.y-r.height*.5;break}return p};return HitTestUtil}();lz.HitTestUtil=HitTestUtil;__reflect(HitTestUtil.prototype,"lz.HitTestUtil")})(lz||(lz={}));var lz;(function(lz){var ImgLoaderUtil=function(){function ImgLoaderUtil(){}ImgLoaderUtil.getImgByUrl=function(imgUrl){var _this=this;return new Promise(function(resolve,reject){if(!imgUrl){resolve({isSucc:false,info:"load faild: "+imgUrl})}else{var imgLoader=new egret.ImageLoader;imgLoader.crossOrigin="anonymous";imgLoader.once(egret.Event.COMPLETE,function(evt){var loader=evt.currentTarget;var texture=new egret.Texture;texture._setBitmapData(loader.data);resolve({isSucc:true,texture:texture,url:imgUrl})},_this);imgLoader.once(egret.IOErrorEvent.IO_ERROR,function(evt){resolve({isSucc:false,info:"load faild: "+imgUrl})},_this);imgLoader.load(imgUrl)}})};ImgLoaderUtil.imgDic={};return ImgLoaderUtil}();lz.ImgLoaderUtil=ImgLoaderUtil;__reflect(ImgLoaderUtil.prototype,"lz.ImgLoaderUtil")})(lz||(lz={}));var lz;(function(lz){var MathUtil=function(){function MathUtil(){}MathUtil.getNewPoint=function(oldP,rotation){var p=new egret.Point;rotation=(360+rotation%360)%360;var sin=Math.sin(rotation*Math.PI/180);var cos=Math.cos(rotation*Math.PI/180);p.x=oldP.x*cos-oldP.y*sin;p.y=-(-oldP.x*sin-oldP.y*cos);return p};return MathUtil}();lz.MathUtil=MathUtil;__reflect(MathUtil.prototype,"lz.MathUtil")})(lz||(lz={}));var lz;(function(lz){var ObjectPool=function(){function ObjectPool(){this._pool={}}ObjectPool.getInstance=function(){if(ObjectPool._instance===null){ObjectPool._instance=new ObjectPool}return ObjectPool._instance};ObjectPool.prototype.getObject=function(clazz){var data=[];for(var _i=1;_i<arguments.length;_i++){data[_i-1]=arguments[_i]}var result;var key=egret.getQualifiedClassName(clazz);var arr=this._pool[key]?this._pool[key].objs:null;if(arr!=null&&arr.length){result=arr.shift();result.unfreeze()}else{var applyArgs=[{}].concat(data||[]);var f=Function.prototype.bind.apply(clazz,applyArgs);result=new f}return result};ObjectPool.prototype.putObject=function(obj){var key=egret.getQualifiedClassName(obj);var pool=this._pool[key];if(pool==null){pool={maxSize:-1,objs:[]};this._pool[key]=pool}if(pool.maxSize!==-1){while(pool.objs.length>=pool.maxSize){pool.objs.shift()}}pool.objs.push(obj);obj.freeze()};ObjectPool.prototype.clearPool=function(clazz){if(clazz){var key=egret.getQualifiedClassName(clazz);if(this._pool[key]){delete this._pool[key]}}else{this._pool={}}};ObjectPool.prototype.getSize=function(clazz){if(clazz){var key=egret.getQualifiedClassName(clazz);if(this._pool[key]){return this._pool[key].objs.length}else{return 0}}else{var count=0;for(var key in this._pool){count+=this._pool[key].objs.length}}};ObjectPool.prototype.setMaxSize=function(size,clazz){var key=egret.getQualifiedClassName(clazz);var pool=this._pool[key];if(pool==null){pool={maxSize:size,objs:[]};this._pool[key]=pool}else{pool.maxSize=size}if(size!==-1){while(pool.objs.length>pool.maxSize){pool.objs.shift()}}};ObjectPool.prototype.getMaxSize=function(clazz){var key=egret.getQualifiedClassName(clazz);if(this._pool[key]){return this._pool[key].maxSize}return-1};ObjectPool._instance=null;return ObjectPool}();lz.ObjectPool=ObjectPool;__reflect(ObjectPool.prototype,"lz.ObjectPool")})(lz||(lz={}));var lz;(function(lz){var ObjPool=function(){function ObjPool(){this.m_pool=new Array}ObjPool.prototype.AllcoObj=function(ctor){if(this.m_pool==null){var obj=new ctor;return obj}if(this.m_pool.length==0){var obj=new ctor;return obj}return this.m_pool.shift()};ObjPool.prototype.Free=function(obj){if(obj["anchorOffsetX"]){obj["anchorOffsetX"]=0}if(obj["anchorOffsetY"]){obj["anchorOffsetY"]=0}if(obj["alpha"]&&obj["alpha"]!=1){obj["alpha"]=1}this.m_pool.push(obj)};ObjPool.prototype.Clear=function(){this.m_pool.splice(0)};return ObjPool}();lz.ObjPool=ObjPool;__reflect(ObjPool.prototype,"lz.ObjPool")})(lz||(lz={}));var lz;(function(lz){var NativeData=function(){function NativeData(){}NativeData.prototype.init=function(data){if(data){this.adId=data.adId;this.title=data.title;this.desc=data.desc;this.icon=data.icon;this.imgUrlList=data.imgUrlList;this.logoUrl=data.logoUrl;this.clickBtnTxt=data.clickBtnTxt;this.creativeType=data.creativeType;this.interactionType=data.interactionType}};return NativeData}();lz.NativeData=NativeData;__reflect(NativeData.prototype,"lz.NativeData");var PLATFORM_TYPE;(function(PLATFORM_TYPE){PLATFORM_TYPE[PLATFORM_TYPE["H5"]=0]="H5";PLATFORM_TYPE[PLATFORM_TYPE["WX"]=1]="WX";PLATFORM_TYPE[PLATFORM_TYPE["TT"]=2]="TT";PLATFORM_TYPE[PLATFORM_TYPE["QQ"]=3]="QQ";PLATFORM_TYPE[PLATFORM_TYPE["VIVO"]=4]="VIVO";PLATFORM_TYPE[PLATFORM_TYPE["OPPO"]=5]="OPPO";PLATFORM_TYPE[PLATFORM_TYPE["APP"]=6]="APP";PLATFORM_TYPE[PLATFORM_TYPE["BD"]=7]="BD";PLATFORM_TYPE[PLATFORM_TYPE["IOS"]=8]="IOS";PLATFORM_TYPE[PLATFORM_TYPE["AN"]=9]="AN"})(PLATFORM_TYPE=lz.PLATFORM_TYPE||(lz.PLATFORM_TYPE={}));var PlatformUtil=function(){function PlatformUtil(){}PlatformUtil.init=function(){PlatformUtil.netType=platform.netType;PlatformUtil.commondia=platform.commondia;PlatformUtil.platformType=PlatformUtil.pid();PlatformUtil.onCloseFun=PlatformUtil.onVideoClose.bind(PlatformUtil);PlatformUtil.onErrorFun=PlatformUtil.onError.bind(PlatformUtil)};PlatformUtil.onShare=function(title,img,query){if(query===void 0){query=""}platform.showShareMenu();PlatformUtil.TITLE=title;PlatformUtil.IMG_URL=img,PlatformUtil.QUERY=query;platform.onShareAppMessage(PlatformUtil.TITLE,PlatformUtil.IMG_URL,PlatformUtil.QUERY)};PlatformUtil.onVideoClose=function(res){lz.GameGlobal.unLock();if(res&&res.isEnded||res===undefined){if(this.videoSucc){PlatformUtil.aldSendEvent(lz.AldEvent.ADV_PLAY_COMPLETE);this.videoSucc();this.videoSucc=null}}else{if(this.videoFail){this.videoFail(res);this.videoFail=null}}};PlatformUtil.onError=function(err){var _this=this;if(lz.GameConfig.debug){platform.showModal("系统提示","错误码："+err.errCode+"err-"+err.errMsg)}lz.GameGlobal.unLock();if(lz.PlatformUtil.isVIVO()){var message="";switch(err.errCode){case-3:lz.MessageBox.show("激励广告加载失败---调用太频繁"+JSON.stringify(err));break;case-4:message="激励广告加载失败--- 一分钟内不能重复加载"+JSON.stringify(err);break;case 30008:break;default:message="激励广告展示失败"+JSON.stringify(err);break}if(message.length){qg.showToast({message:message})}if(this.videoFail){this.videoFail();this.videoFail=null}}else{if(err.errCode==1e3&&PlatformUtil._errorLoadTimes<5&&this.rewardedVideoAd){PlatformUtil._errorLoadTimes++;this.rewardedVideoAd.load().then(function(){return _this.rewardedVideoAd.show().then(function(){_this.onVideoShowHandler()})})}else{PlatformUtil.onVideoErrorChangeShare();PlatformUtil._errorLoadTimes=0;try{if(this.rewardedVideoAd){this.rewardedVideoAd.offClose(PlatformUtil.onCloseFun);this.rewardedVideoAd.offError(PlatformUtil.onErrorFun)}}catch(e){this.aldSendEvent("wxError---\x3eoff",{msg:e})}this.rewardedVideoAd=null}}};PlatformUtil.pullVideo=function(videoid){return __awaiter(this,void 0,void 0,function(){var _this=this;var vid_1,e_1;return __generator(this,function(_a){switch(_a.label){case 0:_a.trys.push([0,6,,7]);vid_1=videoid?videoid:lz.GameConfig.videoid;if(!vid_1)return[3,4];lz.Log.out(this,"准备创建视频---1"+vid_1);if(!this.rewardedVideoAd)return[3,1];lz.Log.out(this,"视频存在不需要创建---"+vid_1);return[3,3];case 1:lz.Log.out(this,"准备创建视频---2"+vid_1);return[4,platform.createVideoAd(vid_1).then(function(res){if(res){_this.rewardedVideoAd=res;_this.rewardedVideoAd.onClose(PlatformUtil.onCloseFun);_this.rewardedVideoAd.onError(PlatformUtil.onErrorFun);lz.Log.out(_this,"创建视频---3"+vid_1)}},function(){})];case 2:_a.sent();_a.label=3;case 3:return[3,5];case 4:lz.Log.out(this,"videoid no find ---\x3e>>");_a.label=5;case 5:return[3,7];case 6:e_1=_a.sent();lz.Log.out(this,"视频拉取error---"+e_1);return[3,7];case 7:return[2]}})})};PlatformUtil.showVideoOrShare=function(callBackSuccess,callBackFail,callBackError,videoid,type){if(callBackError===void 0){callBackError=null}if(type===void 0){type=0}PlatformUtil._errorLoadTimes=0;if(!callBackError){this.videoError=callBackFail}else{this.videoError=callBackError}var vid=videoid?videoid:lz.GameConfig.videoid;var isAdv=false;if(lz.GameConfig.check==1){if(vid&&vid.length>0){isAdv=true}else{callBackSuccess();return}}else{if(type==0){var ranNumber=Math.random()*100;if(ranNumber>=lz.GameConfig.share){isAdv=true}}else if(type==1){isAdv=true}}if(isAdv){if(vid&&vid.length>0){this.onShowVideo(callBackSuccess,callBackFail,vid)}else{callBackSuccess()}}else{this.onShowShare(callBackSuccess,callBackFail)}};PlatformUtil.onShowVideo=function(callBackSuccess,callBackFail,videoid){return __awaiter(this,void 0,void 0,function(){var _this=this;var tt_1,error_1;return __generator(this,function(_a){switch(_a.label){case 0:_a.trys.push([0,2,,3]);if(lz.GameGlobal.isLock){return[2]}if(lz.PlatformUtil.isVIVO()){tt_1=lz.ServerTime.time-this._lastTimeVideo;if(tt_1<60){qg.showToast({message:"当前没有可播放的广告，稍后再试"});if(callBackFail){callBackFail("激励广告加载失败，稍后再试")}return[2]}}if(PlatformUtil.isAN()||PlatformUtil.isIOS()){lz.GameGlobal.isPauseGame=true;PlatformUtil._callBackDic[lz.BaseBridgeConfig.OPEN_ADV]=function(){console.log("执行回调函数---2 adv");lz.GameGlobal.isPauseGame=false;if(callBackSuccess){callBackSuccess()}};PlatformUtil.callNative(lz.BaseBridgeConfig.OPEN_ADV,{param:lz.GameConfig.gameName}).then(function(res){},function(err){lz.MessageBox.show(err);lz.GameGlobal.isPauseGame=false;if(callBackFail){callBackFail()}});return[2]}lz.GameGlobal.lock();return[4,this.pullVideo(videoid)];case 1:_a.sent();this._lastTimeVideo=lz.ServerTime.time;if(this.rewardedVideoAd){lz.Log.out(this,"视频创建完成 准备展示");this.videoSucc=callBackSuccess;this.videoFail=callBackFail;this.rewardedVideoAd.show().then(function(){_this.onVideoShowHandler()}).catch(function(err){lz.Log.out(_this,"video show fail reload ---\x3e");if(lz.PlatformUtil.isVIVO()){platform.showModal("温馨提示","激励广告加载频繁，稍后再试")}else{if(_this.rewardedVideoAd){_this.rewardedVideoAd.load().then(function(){_this.rewardedVideoAd.show().then(function(){_this.onVideoShowHandler()})}).catch(function(err){lz.Log.out(_this,"激励视频 广告显示失败");if(callBackFail){callBackFail("激励视频 广告显示失败")}})}}})}else{lz.GameGlobal.unLock();if(lz.GameConfig.check==1||lz.GameConfig.debug){callBackSuccess()}else{if(lz.PlatformUtil.isVIVO()){if(callBackFail){callBackFail()}}else{PlatformUtil.onVideoErrorChangeShare()}}}return[3,3];case 2:error_1=_a.sent();PlatformUtil.onVideoErrorChangeShare();return[3,3];case 3:return[2]}})})};PlatformUtil.onVideoErrorChangeShare=function(){var _this=this;if(lz.GameConfig.videoErrorToShare&&lz.GameConfig.check!=1){this.aldSendEvent(lz.AldEvent.VIDEO_FAIL_SHARE);PlatformUtil.onShowShare(function(){if(_this.videoSucc){_this.videoSucc();_this.videoSucc=null}_this.videoFail=null},function(errType){if(_this.videoFail){_this.videoFail();_this.videoFail=null}_this.videoSucc=null;lz.MessageBox.show(errType==1?"分享到不同群才能获得奖励":"分享失败")})}else{if(this.videoError){this.videoError();this.videoError=null}}if(this.videoError){this.videoError();this.videoError=null}else{}};PlatformUtil.onVideoShowHandler=function(){lz.Log.out(this,"video show success!");PlatformUtil.aldSendEvent(lz.AldEvent.ADV_PLAY_START)};PlatformUtil.onShowShare=function(callBack,callBackFail,title,img,query){if(title===void 0){title=null}if(img===void 0){img=null}if(query===void 0){query=null}if(this.isAN()||this.isIOS()){PlatformUtil._callBackDic["wxurl"]=function(){lz.GameGlobal.isPauseGame=false;if(callBack){callBack()}};PlatformUtil.callNative(lz.BaseBridgeConfig.SHARE,{param:lz.GameConfig.gameName}).then(function(res){},function(err){lz.MessageBox.show(err);lz.GameGlobal.isPauseGame=false;if(callBackFail){callBackFail()}})}else{this.hideTime=egret.getTimer();this.shareSucc=callBack;this.shareFail=callBackFail;egret.clearTimeout(this._timeOutId);if(title&&img){platform.shareAppMessage(title,img,query)}else{platform.shareAppMessage(this.TITLE,this.IMG_URL,this.QUERY)}if(PlatformUtil.isWX()){this.tempFuc=this.onShow.bind(this);platform.onShow(this.tempFuc)}}};PlatformUtil.onShow=function(){try{platform.offShow(this.tempFuc)}catch(e){}var t=egret.getTimer()-this.hideTime;if(t>=2500){lz.Log.out(this,"分享成功");if(this.shareSucc){this._timeOutId=egret.setTimeout(this.doSucc,this,3e3)}}else{lz.Log.out(this,"分享失败");if(this.shareFail){this.shareFail(1)}}};PlatformUtil.doSucc=function(){if(this.shareSucc){this.shareSucc();this.shareSucc=null}};PlatformUtil.showAppBox=function(boxId){var _this=this;var isRefresh=false;if(lz.ServerTime.time-this._lastTimeApp>this._interval){this._lastTimeApp=lz.ServerTime.time;isRefresh=true}var bid;if(boxId&&boxId.length){bid=boxId}else if(lz.GameConfig.boxid&&lz.GameConfig.boxid.length){bid=lz.GameConfig.boxid}else{bid=lz.GameConfig.interstitialid}if(!this.appBox){platform.createAppBox(bid).then(function(res){if(res){_this.appBox=res;_this.appBox.load().then(function(){_this.appBox.show()})}},function(){})}else{if(isRefresh){this.appBox.load().then(function(){_this.appBox.show()})}else{this.appBox.show()}}};PlatformUtil.closeAppBox=function(){if(this.appBox){this.appBox.hide()}};PlatformUtil.getPF=function(){if(!(typeof wx==="undefined")){return wx}else if(!(typeof qq==="undefined")){return qq}else if(!(typeof tt==="undefined")){return tt}else if(!(typeof qg==="undefined")){return qg}};PlatformUtil.isTT=function(){if(platform.name=="ttgame"){return true}return false};PlatformUtil.isVIVO=function(){if(platform.name=="vivogame"){return true}return false};PlatformUtil.isQQ=function(){if(platform.name=="qqgame"){return true}return false};PlatformUtil.isWX=function(){if(platform.name=="wxgame"){return true}return false};PlatformUtil.isH5=function(){if(platform.name=="h5game"){return true}return false};PlatformUtil.isOPPO=function(){if(platform.name=="oppogame"){return true}return false};PlatformUtil.isAPP=function(){if(platform.name=="appgame"){return true}return false};PlatformUtil.isBD=function(){if(platform.name=="bdgame"){return true}return false};PlatformUtil.isIOS=function(){if(platform.name=="iosgame"){return true}return false};PlatformUtil.isAN=function(){if(platform.name=="angame"){return true}return false};PlatformUtil.pid=function(){if(this.isH5()){return PLATFORM_TYPE.H5}else if(this.isWX()){return PLATFORM_TYPE.WX}else if(this.isTT()){return PLATFORM_TYPE.TT}else if(this.isQQ()){return PLATFORM_TYPE.QQ}else if(this.isVIVO()){return PLATFORM_TYPE.VIVO}else if(this.isOPPO()){return PLATFORM_TYPE.OPPO}else if(this.isAPP()){return PLATFORM_TYPE.APP}else if(this.isBD()){return PLATFORM_TYPE.BD}else if(this.isIOS()){return PLATFORM_TYPE.IOS}else if(this.isAN()){return PLATFORM_TYPE.AN}return-1};PlatformUtil.startRecorder=function(){var _this=this;if(!PlatformUtil.isTT()){return}if(!PlatformUtil.recorder){PlatformUtil.recorder=tt.getGameRecorderManager()}if(PlatformUtil.isRecorder){return}PlatformUtil.isRecorder=true;PlatformUtil.recorder.onStart(function(){lz.Log.out(_this,"开始录屏");PlatformUtil._startTime=lz.ServerTime.time});PlatformUtil.recorder.onError(function(errMsg){console.log("----------\x3e"+errMsg)});PlatformUtil.recorder.onStop(function(res){lz.Log.out(_this,"-------\x3estop");_this._isStop=true;_this._recorderPath=res.videoPath});PlatformUtil.recorder.start({duration:300})};PlatformUtil.pauseRecorder=function(){if(lz.PlatformUtil.recorder){lz.PlatformUtil.recorder.pause()}};PlatformUtil.resumeRecorder=function(){if(lz.PlatformUtil.recorder){lz.PlatformUtil.recorder.resume()}};PlatformUtil.stopRecorder=function(success){var _this=this;if(PlatformUtil.recorder){if(this._isStop){PlatformUtil.isRecorder=false;if(success){success()}return}PlatformUtil.recorder.onStop(function(res){lz.Log.out(_this,"------stop------");PlatformUtil.isRecorder=false;_this._recorderPath=res.videoPath;if(success){success()}});PlatformUtil.recorder.stop()}};PlatformUtil.shareRecorder=function(success,fail,title,desc,imageUrl,query,topics){if(imageUrl===void 0){imageUrl=""}if(query===void 0){query=""}if(topics===void 0){topics=[]}if(!lz.PlatformUtil.isTT()){return}var t=lz.ServerTime.time-PlatformUtil._startTime;if(t<6){lz.MessageBox.show("录制时间太短啦，要超过3秒哟");if(fail){fail()}return}if(!this._recorderPath){lz.MessageBox.show("录制异常，请重试");if(fail){fail()}return}if(topics.length<1){topics.push(title)}tt.shareAppMessage({channel:"video",title:title,desc:desc,imageUrl:imageUrl,templateId:"",query:query,extra:{videoPath:this._recorderPath,videoTopics:topics},success:function(){tt.showToast({title:"分享视频成功"});if(success){success()}},fail:function(e){tt.showToast({title:"分享视频失败",icon:"none"});if(fail){fail(e)}}})};PlatformUtil.callEgretFunc=function(msg){if(msg.msgid=="screen"){if(msg.data=="off"){egret.ticker.pause();lz.SoundManager.onDeActive()}else if(msg.data=="present"){egret.ticker.resume();lz.SoundManager.onActive()}}if(PlatformUtil._callBackDic[msg.msgid]){PlatformUtil._callBackDic[msg.msgid]()}};PlatformUtil.addCallBackFunc=function(id,callBack){PlatformUtil._callBackDic[id]=callBack};PlatformUtil.callNative=function(functionName,param){if(param===void 0){param=null}return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){return[2,platform.tsCallNative(functionName,param)]})})};PlatformUtil.showBannerAd=function(bannerId,isRefresh,fail,success){var _this=this;if(isRefresh===void 0){isRefresh=true}if(fail===void 0){fail=null}if(success===void 0){success=null}if(lz.GameGlobal.isGuide){return}var refresh=false;if(lz.ServerTime.time-this._lastTime>lz.GameConfig.refreshBannerTime||this._lastTime==0){this._lastTime=lz.ServerTime.time;refresh=isRefresh}if(refresh||this._isBannerFail){var bid=bannerId?bannerId:lz.GameConfig.bannerid;if(bid!=this.currentBid){this._isBannerFail=false;this.currentBid=bid;platform.createBannerAd(bid).then(function(res){lz.Log.out(_this,"B成功1");if(res==1&&success){lz.Log.out(_this,"B成功2");success()}},function(err){lz.Log.out(_this,"B失败！");_this._isBannerFail=true;if(fail){fail()}})}else{platform.showBannerAd()}}else{platform.showBannerAd()}};PlatformUtil.hideBannerAd=function(){platform.hideBannerAd();lz.Facade.sendNotification(lz.GameFrameEvent.HIDE_BANNER)};PlatformUtil.showInterstitialAd=function(success,fail,interstitialid){var _this=this;if(success===void 0){success=null}if(fail===void 0){fail=null}if(lz.GameGlobal.isGuide){return}var iid=interstitialid?interstitialid:lz.GameConfig.interstitialid;if(lz.PlatformUtil.isVIVO()){return}if(lz.GameConfig.interstitialid){if(this.currentIid!=iid){this.currentIid=iid;platform.createInterstitialAd(iid).then(function(res){lz.Log.out(_this,"Interstitial成功1");if(res==1&&success){lz.Log.out(_this,"Interstitial成功2");success()}},function(err){lz.Log.out(_this,"Interstitial失败！",err);if(fail){fail(err)}})}else{platform.showInterstitialAd();lz.Log.out(this,"Interstitial ---- 存在 直接显示")}}else{if(fail){fail()}}};PlatformUtil.delayShowInsertAd=function(addelay,interstitialid,callBack){if(interstitialid===void 0){interstitialid=null}if(callBack===void 0){callBack=null}return __awaiter(this,void 0,void 0,function(){var _this=this;return __generator(this,function(_a){if(lz.GameGlobal.isGuide){return[2]}egret.clearTimeout(this._timeOut);this._timeOut=egret.setTimeout(function(id){lz.Log.out(_this,"开始创建插屏广告-------\x3e ");_this.showInterstitialAd(function(){lz.Log.out(_this,"Interstitial成功1")},function(err){lz.Log.out(_this,"Interstitial失败！",err)},id)},this,addelay*1e3,interstitialid);return[2]})})};PlatformUtil.getNativeAdList=function(nativeId){return __awaiter(this,void 0,void 0,function(){var _this=this;return __generator(this,function(_a){return[2,new Promise(function(resolve,reject){if(PlatformUtil.isVIVO()||PlatformUtil.isOPPO()){var nativeAd_1;if(PlatformUtil.isVIVO()||PlatformUtil.isOPPO()&&_this.platformVersionCode<1051){nativeAd_1=PlatformUtil.getPF().createNativeAd({posId:nativeId})}else{nativeAd_1=PlatformUtil.getPF().createNativeAd({adUnitId:nativeId})}if(PlatformUtil.isADdestroy){PlatformUtil.isADdestroy=false}_this.nativeAd=nativeAd_1;lz.Log.out(_this,"获取原生广告数据----",nativeAd_1);if(nativeAd_1){nativeAd_1.onLoad(function(res){lz.Log.out(_this,"获取原生广告数据----123",res);if(res&&res.adList){var list=[];for(var i=0;i<res.adList.length;i++){var nd=new NativeData;nd.init(res.adList[i]);nd.nativeAd=nativeAd_1;_this._nData=nd;list.push(nd)}resolve(list)}});if(PlatformUtil.isOPPO()){lz.Log.out(_this,"nativeAd开始load");nativeAd_1.onError(function(err){reject(err);lz.Log.out(_this,"nativeAd加载失败");console.log(err)});nativeAd_1.load()}else{var adLoad=nativeAd_1.load();if(adLoad){adLoad.then(function(res){lz.Log.out(_this,"nativeAd加载成功")},function(err){lz.Log.out(_this,"nativeAd加载fail");reject(err)}).catch(function(err){reject(err);lz.Log.out(_this,"加载失败",JSON.stringify(err))})}else{reject("--")}}}}else{reject(-1)}})]})})};PlatformUtil.setShortCut=function(isRemind,callBack){if(isRemind===void 0){isRemind=true}if(callBack===void 0){callBack=null}qg.hasShortcutInstalled({success:function(status){if(status){lz.Log.out(this,"图标已创建");if(callBack){callBack(true)}}else{if(isRemind){qg.installShortcut({message:"添加到桌面下次更容易找到我哟！",success:function(){lz.Log.out(this,"创建成功")}})}if(callBack){callBack(false)}}}})};PlatformUtil.hideInterstitialAd=function(){platform.hideInterstitialAd()};PlatformUtil.destroyBannerAd=function(){platform.destroyBannerAd()};PlatformUtil.aldSendEvent=function(name,param){if(lz.GameConfig.check==1){return}platform.aldSendEvent(name,param)};PlatformUtil.aldStage=function(type,param){if(lz.GameConfig.check==1){return}platform.aldStage(type,param)};PlatformUtil.platformAppId="wx39222bbdd7053fa1";PlatformUtil.appsecret="ac15eb32ab6140204466c49876638225";PlatformUtil.TIPS="用户信息获取失败，您将无法获得收益";PlatformUtil.netType=0;PlatformUtil.commondia=0;PlatformUtil.avatarUrl="default_icon_png";PlatformUtil.envVersion="release";PlatformUtil.TITLE="儿时梦想，现已梦想成真。";PlatformUtil.IMG_URL="openDataContext/assets/share.jpg";PlatformUtil.QUERY="";PlatformUtil.isRecorder=false;PlatformUtil._errorLoadTimes=0;PlatformUtil.hideTime=0;PlatformUtil._isStop=false;PlatformUtil.isADdestroy=false;PlatformUtil._lastTimeVideo=0;PlatformUtil._startTime=0;PlatformUtil._lastTime=0;PlatformUtil._isBannerFail=false;PlatformUtil._interval=60;PlatformUtil._lastTimeApp=0;PlatformUtil._callBackDic={};return PlatformUtil}();lz.PlatformUtil=PlatformUtil;__reflect(PlatformUtil.prototype,"lz.PlatformUtil")})(lz||(lz={}));var lz;(function(lz){var ServerTime=function(){function ServerTime(){}Object.defineProperty(ServerTime,"time",{get:function(){if(!this._runStartTime){this._runStartTime=egret.getTimer()}return this._serverTime+Math.floor((egret.getTimer()-this._runStartTime)/1e3)},set:function(value){this._serverTime=value?value:0;this._runStartTime=egret.getTimer()},enumerable:true,configurable:true});ServerTime._serverTime=0;return ServerTime}();lz.ServerTime=ServerTime;__reflect(ServerTime.prototype,"lz.ServerTime")})(lz||(lz={}));var lz;(function(lz){var ShockUtils=function(){function ShockUtils(tagert,shockType){this.mapPoss=[new egret.Point(0,5),new egret.Point(5,2),new egret.Point(-5,-2)];this.spritePoss=[new egret.Point(5,0),new egret.Point(-5,0),new egret.Point(5,0)];this.upDownPoss=[new egret.Point(0,10),new egret.Point(0,-10),new egret.Point(0,10)];this._shockLength=0;this._shockCount=0;this._rx=0;this._ry=0;this._type=0;this._repeatCount=0;this._isShock=false;this._target=tagert;this.shock(shockType)}ShockUtils.prototype.destroy=function(){this.stop();this._target=null};ShockUtils.prototype.shock=function(type){if(type===void 0){type=0}this._type=type;if(this._type==ShockUtils.MAP){this._shockPoss=this.mapPoss.concat();this._shockLength=this._shockPoss.length}else if(this._type==ShockUtils.SPRITE){this._shockPoss=this.spritePoss.concat();this._shockLength=this._shockPoss.length}else if(this._type==ShockUtils.UP_DOWN){this._shockPoss=this.upDownPoss.concat();this._shockLength=this._shockPoss.length}};ShockUtils.prototype.start=function(num){if(num===void 0){num=1}if(this.isShock){this.stop();this._isShock=true}this.repeatCount=num;this._shockCount=0;if(this._target){this._rx=this._target.x;this._ry=this._target.y;egret.Ticker.getInstance().register(this.onShockEnter,this)}};ShockUtils.prototype.stop=function(){this._isShock=false;if(this._target){this._target.x=this._rx;this._target.y=this._ry;egret.Ticker.getInstance().unregister(this.onShockEnter,this)}};ShockUtils.prototype.onShockEnter=function(e){var maxCount=this._shockLength*this._repeatCount;if(this._shockCount>=maxCount){this.stop();return}var index=this._shockCount%this._shockLength;var pos=this._shockPoss[index];if(this._target){this._target.x=this._rx+pos.x;this._target.y=this._ry+pos.y}this._shockCount++};Object.defineProperty(ShockUtils.prototype,"repeatCount",{get:function(){return this._repeatCount},set:function(value){this._repeatCount=value},enumerable:true,configurable:true});Object.defineProperty(ShockUtils.prototype,"isShock",{get:function(){return this._isShock},enumerable:true,configurable:true});ShockUtils.MAP=0;ShockUtils.SPRITE=1;ShockUtils.UP_DOWN=2;return ShockUtils}();lz.ShockUtils=ShockUtils;__reflect(ShockUtils.prototype,"lz.ShockUtils")})(lz||(lz={}));var lz;(function(lz){var StringUtil=function(){function StringUtil(){}StringUtil.isUsage=function(value){if(value==undefined||value==null||value==""||value=="undefined"){return false}return true};StringUtil.getImgUrl=function(imgUrl){return imgUrl.replace(".jpg","_jpg").replace(".png","_png")};StringUtil.getChineseByNum=function(num){if(!this._chineseArr){this._chineseArr=["","一","二","三","四","五","六","七","八","九","十"]}if(this._chineseArr.length<num){return""}return this._chineseArr[num]};return StringUtil}();lz.StringUtil=StringUtil;__reflect(StringUtil.prototype,"lz.StringUtil")})(lz||(lz={}));var lz;(function(lz){var TimeUtil=function(){function TimeUtil(){}TimeUtil.getTimeString=function(second){var t=second;var s=second%60;t=(t-s)/60;var m=t%60;t=(t-m)/60;var h=t;return""+h+"小时"+m+"分钟"+s+"秒"};TimeUtil.getTimeStringSimple=function(second){var t=second;var s=second%60;var sStr="00"+s;t=(t-s)/60;var m=t%60;var mStr="00"+m;t=(t-m)/60;var h=t;var hStr="00"+h;return hStr.substring(hStr.length-2)+":"+mStr.substring(mStr.length-2)+":"+sStr.substring(sStr.length-2)};TimeUtil.format=function(d,fs){var o={"M+":d.getMonth()+1,"d+":d.getDate(),"h+":d.getHours(),"m+":d.getMinutes(),"s+":d.getSeconds(),"q+":Math.floor((d.getMonth()+3)/3),S:d.getMilliseconds()};if(/(y+)/.test(fs))fs=fs.replace(RegExp.$1,(d.getFullYear()+"").substr(4-RegExp.$1.length));for(var k in o)if(new RegExp("("+k+")").test(fs))fs=fs.replace(RegExp.$1,RegExp.$1.length==1?o[k]:("00"+o[k]).substr((""+o[k]).length));return fs};TimeUtil.getDateTimeString=function(second,type){if(type===void 0){type="yyyy-MM-dd hh:mm"}var d=new Date(second*1e3);return this.format(d,type)};TimeUtil.get_MM_dd_hh_mm_String=function(second,type){if(type===void 0){type="MM-dd hh:mm"}var d=new Date(second*1e3);return this.format(d,type)};TimeUtil.get_hh_mm_String=function(second,type){if(type===void 0){type="hh:mm"}var d=new Date(second*1e3);return this.format(d,type)};TimeUtil.get_ss_String=function(second,type){if(type===void 0){type="ss"}var d=new Date(second*1e3);return this.format(d,type)};TimeUtil.get_mm_ss_String=function(second,type){if(type===void 0){type="mm:ss"}var d=new Date(second*1e3);return this.format(d,type)};TimeUtil.getTimeStringType1=function(second){var day=0;var t;if(second>86400){day=Math.floor(second/86400);t=second%86400}else{t=second}if(day!=0){return day+"天"+this.getTimeStringSimple(t)}else{return this.getTimeStringSimple(t)}};TimeUtil.getTimeShortStringType=function(second){var str="";if(second<=0){str="1秒"}else if(second<60){str=Math.floor(second)+"秒"}else if(second/60<60){str=Math.floor(second/60)+"分钟"}else if(second/60/60<24){str=Math.floor(second/60/60)+"小时"}else{str=Math.floor(second/60/60/24)+"天"}return str};TimeUtil.getTimeStamp=function(){return(new Date).getTime()};return TimeUtil}();lz.TimeUtil=TimeUtil;__reflect(TimeUtil.prototype,"lz.TimeUtil")})(lz||(lz={}));var lz;(function(lz){var Utils=function(){function Utils(){}Utils.uuid=function(){var i,random;var uuid="";for(i=0;i<32;i++){random=Math.random()*16|0;if(i===8||i===12||i===16||i===20){uuid+="-"}uuid+=(i===12?4:i===16?random&3|8:random).toString(16)}return uuid};Utils.verPhoneNumber=function(phone){var myreg=/^[1][3,4,5,7,8][0-9]{9}$/;return myreg.test(phone)};Utils.getRotate=function(dir){switch(dir){case 1:return 225;case 2:return 180;case 3:return 135;case 4:return 270;case 6:return 90;case 7:return 315;case 8:return 0;case 9:return 45;default:return 0}};return Utils}();lz.Utils=Utils;__reflect(Utils.prototype,"lz.Utils")})(lz||(lz={}));var BaseVo=function(){function BaseVo(){}return BaseVo}();__reflect(BaseVo.prototype,"BaseVo");var EncryptAnalyzer={onLoadStart:function(host,resource){var _this=this;return new Promise(function(reslove,reject){var request=new egret.HttpRequest;request.responseType=egret.HttpResponseType.ARRAY_BUFFER;request.open(resource.root+resource.url,"get");request.send();var onSuccess=function(){var bufData=request["response"];var _xxtea=xxtea.getInstance();var bytes=_xxtea.decrypt(new Uint8Array(bufData),"lz");egret.BitmapData.create("arraybuffer",bytes,function(bmpData){var texture=new egret.Texture;texture._setBitmapData(bmpData);return reslove(texture)})};request.addEventListener(egret.Event.COMPLETE,onSuccess,_this)})},onRemoveStart:function(host,resource){var texture=host.get(resource);texture.dispose();return Promise.resolve()}};var SheetAnalyzer={onLoadStart:function(host,resource){return host.load(resource,"json").then(function(data){var name=data.file;console.log("name-------\x3e "+name);var r=host.resourceConfig.getResource(RES.nameSelector(name));if(!r){var imageName=RES.processor.getRelativePath(resource.url,name);console.log("--------------"+name.substr(name.lastIndexOf(".")));if(name.substr(name.lastIndexOf(".")+1)=="xx"){r={name:imageName,url:imageName,type:"xx",root:resource.root}}else{r={name:imageName,url:imageName,type:"image",root:resource.root}}}return host.load(r).then(function(bitmapData){var frames=data.frames;var spriteSheet=new egret.SpriteSheet(bitmapData);spriteSheet["$resourceInfo"]=r;for(var subkey in frames){var config=frames[subkey];var texture=spriteSheet.createTexture(subkey,config.x,config.y,config.w,config.h,config.offX,config.offY,config.sourceW,config.sourceH);if(config["scale9grid"]){var str=config["scale9grid"];var list=str.split(",");texture["scale9Grid"]=new egret.Rectangle(parseInt(list[0]),parseInt(list[1]),parseInt(list[2]),parseInt(list[3]))}}host.save(r,bitmapData);return spriteSheet},function(e){host.remove(r);throw e})})},getData:function(host,resource,key,subkey){var data=host.get(resource);if(data){return data.getTexture(subkey)}else{return null}},onRemoveStart:function(host,resource){var sheet=host.get(resource);var r=sheet["$resourceInfo"];sheet.dispose();host.unload(r)}};var xxtea=function(){function xxtea(){this.delta=2654435769}xxtea.getInstance=function(){if(!xxtea.instance){xxtea.instance=new xxtea;xxtea.instance.initInstance()}return this.instance};xxtea.prototype.initInstance=function(){};xxtea.prototype.toUint8Array=function(v,includeLength){var length=v.length;var n=length<<2;if(includeLength){var m=v[length-1];n-=4;if(m<n-3||m>n){return null}n=m}var bytes=new Uint8Array(n);for(var i=0;i<n;++i){bytes[i]=v[i>>2]>>((i&3)<<3)}return bytes};xxtea.prototype.toUint32Array=function(bytes,includeLength){var length=bytes.length;var n=length>>2;if((length&3)!==0){++n}var v;if(includeLength){v=new Uint32Array(n+1);v[n]=length}else{v=new Uint32Array(n)}for(var i=0;i<length;++i){v[i>>2]|=bytes[i]<<((i&3)<<3)}return v};xxtea.prototype.mx=function(sum,y,z,p,e,k){return(z>>>5^y<<2)+(y>>>3^z<<4)^(sum^y)+(k[p&3^e]^z)};xxtea.prototype.fixk=function(k){if(k.length<16){var key=new Uint8Array(16);key.set(k);k=key}return k};xxtea.prototype.encryptUint32Array=function(v,k){var length=v.length;var n=length-1;var y,z,sum,e,p,q;z=v[n];sum=0;for(q=Math.floor(6+52/length)|0;q>0;--q){sum+=this.delta;e=sum>>>2&3;for(p=0;p<n;++p){y=v[p+1];z=v[p]+=this.mx(sum,y,z,p,e,k)}y=v[0];z=v[n]+=this.mx(sum,y,z,p,e,k)}return v};xxtea.prototype.decryptUint32Array=function(v,k){var length=v.length;var n=length-1;var y,z,sum,e,p,q;y=v[0];q=Math.floor(6+52/length);for(sum=q*this.delta;sum!==0;sum-=this.delta){e=sum>>>2&3;for(p=n;p>0;--p){z=v[p-1];y=v[p]-=this.mx(sum,y,z,p,e,k)}z=v[n];y=v[0]-=this.mx(sum,y,z,p,e,k)}return v};xxtea.prototype.toBytes=function(str){var n=str.length;var bytes=new Uint8Array(n*3);var length=0;for(var i=0;i<n;i++){var codeUnit=str.charCodeAt(i);if(codeUnit<128){bytes[length++]=codeUnit}else if(codeUnit<2048){bytes[length++]=192|codeUnit>>6;bytes[length++]=128|codeUnit&63}else if(codeUnit<55296||codeUnit>57343){bytes[length++]=224|codeUnit>>12;bytes[length++]=128|codeUnit>>6&63;bytes[length++]=128|codeUnit&63}else{if(i+1<n){var nextCodeUnit=str.charCodeAt(i+1);if(codeUnit<56320&&56320<=nextCodeUnit&&nextCodeUnit<=57343){var rune=((codeUnit&1023)<<10|nextCodeUnit&1023)+65536;bytes[length++]=240|rune>>18;bytes[length++]=128|rune>>12&63;bytes[length++]=128|rune>>6&63;bytes[length++]=128|rune&63;i++;continue}}throw new Error("Malformed string")}}return bytes.subarray(0,length)};xxtea.prototype.toShortString=function(bytes,n){var charCodes=new Uint16Array(n);var i=0,off=0;for(var len=bytes.length;i<n&&off<len;i++){var unit=bytes[off++];switch(unit>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:charCodes[i]=unit;break;case 12:case 13:if(off<len){charCodes[i]=(unit&31)<<6|bytes[off++]&63}else{throw new Error("Unfinished UTF-8 octet sequence")}break;case 14:if(off+1<len){charCodes[i]=(unit&15)<<12|(bytes[off++]&63)<<6|bytes[off++]&63}else{throw new Error("Unfinished UTF-8 octet sequence")}break;case 15:if(off+2<len){var rune=((unit&7)<<18|(bytes[off++]&63)<<12|(bytes[off++]&63)<<6|bytes[off++]&63)-65536;if(0<=rune&&rune<=1048575){charCodes[i++]=rune>>10&1023|55296;charCodes[i]=rune&1023|56320}else{throw new Error("Character outside valid Unicode range: 0x"+rune.toString(16))}}else{throw new Error("Unfinished UTF-8 octet sequence")}break;default:throw new Error("Bad UTF-8 encoding 0x"+unit.toString(16))}}if(i<n){charCodes=charCodes.subarray(0,i)}return String.fromCharCode.apply(String,charCodes)};xxtea.prototype.toLongString=function(bytes,n){var buf=[];var charCodes=new Uint16Array(65535);var i=0,off=0;for(var len=bytes.length;i<n&&off<len;i++){var unit=bytes[off++];switch(unit>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:charCodes[i]=unit;break;case 12:case 13:if(off<len){charCodes[i]=(unit&31)<<6|bytes[off++]&63}else{throw new Error("Unfinished UTF-8 octet sequence")}break;case 14:if(off+1<len){charCodes[i]=(unit&15)<<12|(bytes[off++]&63)<<6|bytes[off++]&63}else{throw new Error("Unfinished UTF-8 octet sequence")}break;case 15:if(off+2<len){var rune=((unit&7)<<18|(bytes[off++]&63)<<12|(bytes[off++]&63)<<6|bytes[off++]&63)-65536;if(0<=rune&&rune<=1048575){charCodes[i++]=rune>>10&1023|55296;charCodes[i]=rune&1023|56320}else{throw new Error("Character outside valid Unicode range: 0x"+rune.toString(16))}}else{throw new Error("Unfinished UTF-8 octet sequence")}break;default:throw new Error("Bad UTF-8 encoding 0x"+unit.toString(16))}if(i>=65534){var size=i+1;buf.push(String.fromCharCode.apply(String,charCodes.subarray(0,size)));n-=size;i=-1}}if(i>0){buf.push(String.fromCharCode.apply(String,charCodes.subarray(0,i)))}return buf.join("")};xxtea.prototype.toString=function(bytes){var n=bytes.length;if(n===0)return"";return n<1e5?this.toShortString(bytes,n):this.toLongString(bytes,n)};xxtea.prototype.encrypt=function(data,key){if(typeof data==="string")data=this.toBytes(data);if(typeof key==="string")key=this.toBytes(key);if(data===undefined||data===null||data.length===0){return data}return this.toUint8Array(this.encryptUint32Array(this.toUint32Array(data,true),this.toUint32Array(this.fixk(key),false)),false)};xxtea.prototype.encryptToString=function(data,key){return this.encrypt(data,key).toString("base64")};xxtea.prototype.decrypt=function(data,key){if(typeof data==="string")data=data.toString();if(typeof key==="string")key=this.toBytes(key);if(data===undefined||data===null||data.length===0){return data}return this.toUint8Array(this.decryptUint32Array(this.toUint32Array(data,false),this.toUint32Array(this.fixk(key),false)),true)};xxtea.prototype.decryptToString=function(data,key){return this.toString(this.decrypt(data,key))};return xxtea}();__reflect(xxtea.prototype,"xxtea");var lz;(function(lz){var GameViewCE=function(_super){__extends(GameViewCE,_super);function GameViewCE(){var _this=_super.call(this)||this;_this.grp_container=new eui.Group;_this.grp_ForceView=new eui.Group;_this.width=lz.GameGlobal.screenWidth;_this.height=lz.GameGlobal.screenHeight;_this.grp_container.touchEnabled=true;_this.grp_container.touchThrough=true;_this.grp_container.width=_this.width;_this.grp_container.height=_this.height;_this.grp_ForceView.touchEnabled=true;_this.grp_ForceView.touchThrough=true;_this.grp_ForceView.width=_this.width;_this.grp_ForceView.height=_this.height;if(lz.GameGlobal.isFullScreen){_this.grp_container.top=_this.grp_ForceView.top=0;_this.grp_container.left=_this.grp_ForceView.left=0;_this.grp_container.bottom=_this.grp_ForceView.bottom=0;_this.grp_container.right=_this.grp_ForceView.right=0}_this.addChild(_this.grp_container);_this.addChild(_this.grp_ForceView);return _this}Object.defineProperty(GameViewCE.prototype,"moduleName",{get:function(){return""},enumerable:true,configurable:true});return GameViewCE}(lz.BaseView);lz.GameViewCE=GameViewCE;__reflect(GameViewCE.prototype,"lz.GameViewCE")})(lz||(lz={}));var lz;(function(lz){var LoadingView=function(_super){__extends(LoadingView,_super);function LoadingView(bg,logoRes,logoTop,barBg,barThumb){if(bg===void 0){bg="lz_logo_png"}if(logoTop===void 0){logoTop=180}if(barBg===void 0){barBg="loading_progress_bg_png"}if(barThumb===void 0){barThumb="loading_progress_line_png"}return _super.call(this,bg,logoRes,logoTop,barBg,barThumb)||this}Object.defineProperty(LoadingView.prototype,"resource",{get:function(){return""},enumerable:true,configurable:true});LoadingView.prototype.notificationListeners=function(){return[]};LoadingView.prototype.executeNotification=function(notificationName,obj,obj2){};LoadingView.prototype.onAdded=function(event){_super.prototype.onAdded.call(this,event)};LoadingView.prototype.loadComplete=function(){_super.prototype.loadComplete.call(this);lz.Log.out(this,"loadComplete")};LoadingView.prototype.onRemoved=function(event){_super.prototype.onRemoved.call(this,event)};LoadingView.prototype.onProgress=function(current,total){if(this.loadingBar){this.loadingBar.value=current/total*100}};return LoadingView}(lz.LoadingViewCE);lz.LoadingView=LoadingView;__reflect(LoadingView.prototype,"lz.LoadingView",["RES.PromiseTaskReporter"])})(lz||(lz={}));var lz;(function(lz){var HttpPackage=function(){function HttpPackage(){this.isPost=true}return HttpPackage}();lz.HttpPackage=HttpPackage;__reflect(HttpPackage.prototype,"lz.HttpPackage")})(lz||(lz={}));